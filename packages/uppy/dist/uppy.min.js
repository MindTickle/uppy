!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).Uppy=t()}}(function(){var t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e="function"==typeof Symbol&&"symbol"===t(Symbol.iterator)?function(e){return void 0===e?"undefined":t(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":t(e)},n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},o=1048576,r={limit:1,onStart:function(){},onProgress:function(){},onPartComplete:function(){},onSuccess:function(){},onError:function(t){throw t}};function i(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}var s=function(){function t(e,i){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.options=n({},r,i),this.file=e,this.key=this.options.key||null,this.uploadId=this.options.uploadId||null,this.parts=this.options.parts||[],this.isPaused=!1,this.chunks=null,this.chunkState=null,this.uploading=[],this.chunkSize=this.options.chunkSize||5*o,this._initChunks()}return t.prototype._initChunks=function(){for(var t=[],e=Math.max(Math.ceil(this.file.size/1e4),this.chunkSize),n=0;n<this.file.size;n+=e){var o=Math.min(this.file.size,n+e);t.push(this.file.slice(n,o))}this.chunks=t,this.chunkState=t.map(function(){return{uploaded:0,busy:!1,done:!1}})},t.prototype._createUpload=function(){var t=this;return Promise.resolve().then(function(){return t.options.createMultipartUpload(t.chunks.length)}).then(function(t){if("object"!==(void 0===t?"undefined":e(t))||!t||"string"!=typeof t.uploadId||"string"!=typeof t.key)throw new TypeError("AwsS3/Multipart: Got incorrect result from 'createMultipartUpload()', expected an object '{ uploadId, key }'.");return t}).then(function(e){t.key=e.key,t.uploadId=e.uploadId,t.parts=e.parts,t.completeURI=e.complete,t.abortURI=e.abort,t.options.onStart(e)}).then(function(){t._uploadParts()}).catch(function(e){t._onError(e)})},t.prototype._resumeUpload=function(){this._uploadParts()},t.prototype._uploadParts=function(){var t=this;if(!this.isPaused){var e=this.options.limit-this.uploading.length;if(0!==e)if(this.chunkState.every(function(t){return t.done}))this._completeUpload();else{for(var n=[],o=0;o<this.chunkState.length;o++){var r=this.chunkState[o];if(!r.done&&!r.busy&&(n.push(o),n.length>=e))break}n.forEach(function(e){t._uploadPart(e)})}}},t.prototype._uploadPart=function(t){var e=this;return this.chunks[t],this.chunkState[t].busy=!0,Promise.resolve().then(function(){try{var n=e.parts[t].url;e._uploadPartBytes(t,n)}catch(t){e._onError(t)}})},t.prototype._onPartProgress=function(t,e,n){this.chunkState[t].uploaded=e;var o=this.chunkState.reduce(function(t,e){return t+e.uploaded},0);this.options.onProgress(o,this.file.size)},t.prototype._onPartComplete=function(t,e){this.chunkState[t].etag=e,this.chunkState[t].done=!0;var n={PartNumber:t+1,ETag:e};this.parts.push(n),this.options.onPartComplete(n),this._uploadParts()},t.prototype._uploadPartBytes=function(t,e){var n=this,o=this.chunks[t],r=new XMLHttpRequest;r.open("PUT",e,!0),r.responseType="text",this.uploading.push(r),r.upload.addEventListener("progress",function(e){e.lengthComputable&&n._onPartProgress(t,e.loaded,e.total)}),r.addEventListener("abort",function(e){i(n.uploading,e.target),n.chunkState[t].busy=!1}),r.addEventListener("load",function(e){if(i(n.uploading,e.target),n.chunkState[t].busy=!1,e.target.status<200||e.target.status>=300)n._onError(new Error("Non 2xx"));else{n._onPartProgress(t,o.size,o.size);var r=e.target.getResponseHeader("ETag");null!==r?n._onPartComplete(t,r):n._onError(new Error("AwsS3/Multipart: Could not read the ETag header. This likely means CORS is not configured correctly on the S3 Bucket. Seee https://uppy.io/docs/aws-s3-multipart#S3-Bucket-Configuration for instructions."))}}),r.addEventListener("error",function(e){i(n.uploading,e.target),n.chunkState[t].busy=!1;var o=new Error("Unknown error");o.source=e.target,n._onError(o)}),r.send(o)},t.prototype._completeUpload=function(){var t=this;return this.parts.sort(function(t,e){return t.PartNumber-e.PartNumber}),Promise.resolve().then(function(){return t.options.completeMultipartUpload({url:t.completeURI,key:t.key,uploadId:t.uploadId,parts:t.parts})}).then(function(e){t.options.onSuccess(e)},function(e){t._onError(e)})},t.prototype._abortUpload=function(){this.uploading.slice().forEach(function(t){t.abort()}),this.options.abortMultipartUpload({url:this.abortURI,key:this.key,uploadId:this.uploadId}),this.uploading=[]},t.prototype._onError=function(t){this.options.onError(t)},t.prototype.start=function(){this.isPaused=!1,this.uploadId?this._resumeUpload():this._createUpload()},t.prototype.pause=function(){this.uploading.slice().forEach(function(t){t.abort()}),this.isPaused=!0},t.prototype.abort=function(){if(!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).really)return this.pause();this._abortUpload()},t}(),a=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},l=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),u=function(){function t(e,n){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.uppy=e,this.opts=n,this.onReceiveResponse=this.onReceiveResponse.bind(this)}return t.prototype.onReceiveResponse=function(t){var e,n=this.uppy.getState().companion||{},o=this.opts.serverUrl,r=t.headers;return r.has("i-am")&&r.get("i-am")!==n[o]&&this.uppy.setState({companion:a({},n,(e={},e[o]=r.get("i-am"),e))}),t},t.prototype._getUrl=function(t){return/^(https?:|)\/\//.test(t)?t:this.hostname+"/"+t},t.prototype.get=function(t){var e=this;return fetch(this._getUrl(t),{method:"get",headers:this.headers,credentials:"same-origin"}).then(this.onReceiveResponse).then(function(t){return t.json()}).catch(function(n){throw new Error("Could not get "+e._getUrl(t)+". "+n)})},t.prototype.post=function(t,e){var n=this;return fetch(this._getUrl(t),{method:"post",headers:this.headers,credentials:"same-origin",body:JSON.stringify(e)}).then(this.onReceiveResponse).then(function(e){if(e.status<200||e.status>300)throw new Error("Could not post "+n._getUrl(t)+". "+e.statusText);return e.json()}).catch(function(e){throw new Error("Could not post "+n._getUrl(t)+". "+e)})},t.prototype.delete=function(t,e){var n=this;return fetch(this.hostname+"/"+t,{method:"delete",headers:this.headers,credentials:"same-origin",body:e?JSON.stringify(e):null}).then(this.onReceiveResponse).then(function(t){return t.json()}).catch(function(e){throw new Error("Could not delete "+n._getUrl(t)+". "+e)})},l(t,[{key:"hostname",get:function(){var t=this.uppy.getState().companion,e=this.opts.serverUrl;return(t&&t[e]?t[e]:e).replace(/\/$/,"")}},{key:"defaultHeaders",get:function(){return{Accept:"application/json","Content-Type":"application/json"}}},{key:"headers",get:function(){return a({},this.defaultHeaders,this.opts.serverHeaders||{})}}]),t}(),p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},f=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),d=function(t){return t.split("-").map(function(t){return t.charAt(0).toUpperCase()+t.slice(1)}).join(" ")},h=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":p(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));return r.provider=o.provider,r.id=r.provider,r.authProvider=o.authProvider||r.provider,r.name=r.opts.name||d(r.id),r.tokenKey="companion-"+r.id+"-auth-token",r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":p(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.setAuthToken=function(t){localStorage.setItem(this.tokenKey,t)},e.prototype.checkAuth=function(){return this.get(this.id+"/authorized").then(function(t){return t.authenticated})},e.prototype.authUrl=function(){return this.hostname+"/"+this.id+"/connect"},e.prototype.fileUrl=function(t){return this.hostname+"/"+this.id+"/get/"+t},e.prototype.list=function(t){return this.get(this.id+"/list/"+(t||""))},e.prototype.logout=function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:location.href;return this.get(this.id+"/logout?redirect="+e).then(function(e){return localStorage.removeItem(t.tokenKey),e})},e.initPlugin=function(t,e,n){if(t.type="acquirer",t.files=[],n&&(t.opts=c({},n,e)),e.serverPattern){var o=e.serverPattern;if(!("string"==typeof o||Array.isArray(o)||o instanceof RegExp))throw new TypeError(t.id+': the option "serverPattern" must be one of string, Array, RegExp');t.opts.serverPattern=o}else/^(?!https?:\/\/).*$/.test(e.serverUrl)?t.opts.serverPattern=location.protocol+"//"+e.serverUrl.replace(/^\/\//,""):t.opts.serverPattern=e.serverUrl},f(e,[{key:"defaultHeaders",get:function(){return c({},t.prototype.defaultHeaders,{"uppy-auth-token":localStorage.getItem(this.tokenKey)})}}]),e}(u),y=function(){var t={},e=t._fns={};return t.emit=function(t,n,o,r,i,s,a){var l=function(t){for(var n=e[t]?e[t]:[],o=t.indexOf(":"),r=-1===o?[t]:[t.substring(0,o),t.substring(o+1)],i=Object.keys(e),s=0,a=i.length;s<a;s++){var l=i[s];if("*"===l&&(n=n.concat(e[l])),2===r.length&&r[0]===l){n=n.concat(e[l]);break}}return n}(t);l.length&&function(t,e,n){for(var o=0,r=e.length;o<r&&e[o];o++)e[o].event=t,e[o].apply(e[o],n)}(t,l,[n,o,r,i,s,a])},t.on=function(t,n){e[t]||(e[t]=[]),e[t].push(n)},t.once=function(e,n){this.on(e,function o(){n.apply(this,arguments),t.off(e,o)})},t.off=function(t,e){var n=[];if(t&&e)for(var o=this._fns[t],r=0,i=o?o.length:0;r<i;r++)o[r]!==e&&n.push(o[r]);n.length?this._fns[t]=n:delete this._fns[t]},t},m={RequestClient:u,Provider:h,Socket:function(){function t(e){var n=this;!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.queued=[],this.isOpen=!1,this.socket=new WebSocket(e.target),this.emitter=y(),this.socket.onopen=function(t){for(n.isOpen=!0;n.queued.length>0&&n.isOpen;){var e=n.queued[0];n.send(e.action,e.payload),n.queued=n.queued.slice(1)}},this.socket.onclose=function(t){n.isOpen=!1},this._handleMessage=this._handleMessage.bind(this),this.socket.onmessage=this._handleMessage,this.close=this.close.bind(this),this.emit=this.emit.bind(this),this.on=this.on.bind(this),this.once=this.once.bind(this),this.send=this.send.bind(this)}return t.prototype.close=function(){return this.socket.close()},t.prototype.send=function(t,e){this.isOpen?this.socket.send(JSON.stringify({action:t,payload:e})):this.queued.push({action:t,payload:e})},t.prototype.on=function(t,e){this.emitter.on(t,e)},t.prototype.emit=function(t,e){this.emitter.emit(t,e)},t.prototype.once=function(t,e){this.emitter.once(t,e)},t.prototype._handleMessage=function(t){try{var e=JSON.parse(t.data);this.emit(e.action,e.payload)}catch(t){console.log(t)}},t}()},g=function(t,e){var n="000000000"+t;return n.substr(n.length-e)},v="object"==typeof window?window:self,b=Object.keys(v).length,w=g(((navigator.mimeTypes?navigator.mimeTypes.length:0)+navigator.userAgent.length).toString(36)+b.toString(36),4),S=function(){return w},_={},C=0,P=4,E=36,F=Math.pow(E,P);function k(){return g((Math.random()*F<<0).toString(E),P)}function O(){return C=C<F?C:0,++C-1}function T(){return"c"+(new Date).getTime().toString(E)+g(O().toString(E),P)+S()+(k()+k())}T.slug=function(){var t=(new Date).getTime().toString(36),e=O().toString(36).slice(-4),n=S().slice(0,1)+S().slice(-1),o=k().slice(-2);return t.slice(-2)+e+n+o},T.isCuid=function(t){return"string"==typeof t&&!!t.startsWith("c")},T.isSlug=function(t){if("string"!=typeof t)return!1;var e=t.length;return e>=7&&e<=10},T.fingerprint=S,_=T;var A={};function U(t,e){this.text=t=t||"",this.hasWild=~t.indexOf("*"),this.separator=e,this.parts=t.split(e)}U.prototype.match=function(t){var e,n,o=!0,r=this.parts,i=r.length;if("string"==typeof t||t instanceof String)if(this.hasWild||this.text==t){for(n=(t||"").split(this.separator),e=0;o&&e<i;e++)"*"!==r[e]&&(o=e<n.length&&r[e]===n[e]);o=o&&n}else o=!1;else if("function"==typeof t.splice)for(o=[],e=t.length;e--;)this.match(t[e])&&(o[o.length]=t[e]);else if("object"==typeof t)for(var s in o={},t)this.match(s)&&(o[s]=t[s]);return o},A=function(t,e,n){var o=new U(t,n||/[\/\.]/);return void 0!==e?o.match(e):o};var x=/[\/\+\.]/,R=function(t){if("number"!=typeof t||isNaN(t))throw new TypeError("Expected a number, got "+typeof t);var e=t<0,n=["B","KB","MB","GB","TB","PB","EB","ZB","YB"];if(e&&(t=-t),t<1)return(e?"-":"")+t+" B";var o=Math.min(Math.floor(Math.log(t)/Math.log(1e3)),n.length-1);t=Number(t/Math.pow(1e3,o));var r=n[o];return t>=10||t%1==0?(e?"-":"")+t.toFixed(0)+" "+r:(e?"-":"")+t.toFixed(1)+" "+r},D={exports:{}};!function(){"use strict";function t(t,e){var n,o,r,i,s=_;for(i=arguments.length;i-- >2;)S.push(arguments[i]);for(e&&null!=e.children&&(S.length||S.push(e.children),delete e.children);S.length;)if((o=S.pop())&&void 0!==o.pop)for(i=o.length;i--;)S.push(o[i]);else"boolean"==typeof o&&(o=null),(r="function"!=typeof t)&&(null==o?o="":"number"==typeof o?o=String(o):"string"!=typeof o&&(r=!1)),r&&n?s[s.length-1]+=o:s===_?s=[o]:s.push(o),n=r;var a=new b;return a.nodeName=t,a.children=s,a.attributes=null==e?void 0:e,a.key=null==e?void 0:e.key,void 0!==w.vnode&&w.vnode(a),a}function e(t,e){for(var n in e)t[n]=e[n];return t}function n(t){!t.__d&&(t.__d=!0)&&1==E.push(t)&&(w.debounceRendering||C)(o)}function o(){var t,e=E;for(E=[];t=e.pop();)t.__d&&m(t)}function r(t,e){return t.__n===e||t.nodeName.toLowerCase()===e.toLowerCase()}function i(t){var n=e({},t.attributes);n.children=t.children;var o=t.nodeName.defaultProps;if(void 0!==o)for(var r in o)void 0===n[r]&&(n[r]=o[r]);return n}function s(t){var e=t.parentNode;e&&e.removeChild(t)}function a(t,e,n,o,r){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)n&&n(null),o&&o(t);else if("class"!==e||r)if("style"===e){if(o&&"string"!=typeof o&&"string"!=typeof n||(t.style.cssText=o||""),o&&"object"==typeof o){if("string"!=typeof n)for(var i in n)i in o||(t.style[i]="");for(var i in o)t.style[i]="number"==typeof o[i]&&!1===P.test(i)?o[i]+"px":o[i]}}else if("dangerouslySetInnerHTML"===e)o&&(t.innerHTML=o.__html||"");else if("o"==e[0]&&"n"==e[1]){var s=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),o?n||t.addEventListener(e,l,s):t.removeEventListener(e,l,s),(t.__l||(t.__l={}))[e]=o}else if("list"!==e&&"type"!==e&&!r&&e in t){try{t[e]=null==o?"":o}catch(t){}null!=o&&!1!==o||"spellcheck"==e||t.removeAttribute(e)}else{var a=r&&e!==(e=e.replace(/^xlink:?/,""));null==o||!1===o?a?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof o&&(a?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),o):t.setAttribute(e,o))}else t.className=o||""}function l(t){return this.__l[t.type](w.event&&w.event(t)||t)}function u(){for(var t;t=F.pop();)w.afterMount&&w.afterMount(t),t.componentDidMount&&t.componentDidMount()}function p(t,e,n,o,l,p){k++||(O=null!=l&&void 0!==l.ownerSVGElement,T=null!=t&&!("__preactattr_"in t));var f=function t(e,n,o,l,u){var p=e,f=O;if(null!=n&&"boolean"!=typeof n||(n=""),"string"==typeof n||"number"==typeof n)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||u)?e.nodeValue!=n&&(e.nodeValue=n):(p=document.createTextNode(n),e&&(e.parentNode&&e.parentNode.replaceChild(p,e),c(e,!0))),p.__preactattr_=!0,p;var h,m,v=n.nodeName;if("function"==typeof v)return function(t,e,n,o){for(var r=t&&t._component,s=r,a=t,l=r&&t._componentConstructor===e.nodeName,u=l,p=i(e);r&&!u&&(r=r.__u);)u=r.constructor===e.nodeName;return r&&u&&(!o||r._component)?(y(r,p,3,n,o),t=r.base):(s&&!l&&(g(s),t=a=null),r=d(e.nodeName,p,n),t&&!r.__b&&(r.__b=t,a=null),y(r,p,1,n,o),t=r.base,a&&t!==a&&(a._component=null,c(a,!1))),t}(e,n,o,l);if(O="svg"===v||"foreignObject"!==v&&O,v=String(v),(!e||!r(e,v))&&(h=v,(m=O?document.createElementNS("http://www.w3.org/2000/svg",h):document.createElement(h)).__n=h,p=m,e)){for(;e.firstChild;)p.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild(p,e),c(e,!0)}var b=p.firstChild,w=p.__preactattr_,S=n.children;if(null==w){w=p.__preactattr_={};for(var _=p.attributes,C=_.length;C--;)w[_[C].name]=_[C].value}return!T&&S&&1===S.length&&"string"==typeof S[0]&&null!=b&&void 0!==b.splitText&&null==b.nextSibling?b.nodeValue!=S[0]&&(b.nodeValue=S[0]):(S&&S.length||null!=b)&&function(e,n,o,i,a){var l,u,p,f,d,h,y,m,g=e.childNodes,v=[],b={},w=0,S=0,_=g.length,C=0,P=n?n.length:0;if(0!==_)for(var E=0;E<_;E++){var F=g[E],k=F.__preactattr_,O=P&&k?F._component?F._component.__k:k.key:null;null!=O?(w++,b[O]=F):(k||(void 0!==F.splitText?!a||F.nodeValue.trim():a))&&(v[C++]=F)}if(0!==P)for(var E=0;E<P;E++){f=n[E],d=null;var O=f.key;if(null!=O)w&&void 0!==b[O]&&(d=b[O],b[O]=void 0,w--);else if(S<C)for(l=S;l<C;l++)if(void 0!==v[l]&&(h=u=v[l],m=a,"string"==typeof(y=f)||"number"==typeof y?void 0!==h.splitText:"string"==typeof y.nodeName?!h._componentConstructor&&r(h,y.nodeName):m||h._componentConstructor===y.nodeName)){d=u,v[l]=void 0,l===C-1&&C--,l===S&&S++;break}d=t(d,f,o,i),p=g[E],d&&d!==e&&d!==p&&(null==p?e.appendChild(d):d===p.nextSibling?s(p):e.insertBefore(d,p))}if(w)for(var E in b)void 0!==b[E]&&c(b[E],!1);for(;S<=C;)void 0!==(d=v[C--])&&c(d,!1)}(p,S,o,l,T||null!=w.dangerouslySetInnerHTML),function(t,e,n){var o;for(o in n)e&&null!=e[o]||null==n[o]||a(t,o,n[o],n[o]=void 0,O);for(o in e)"children"===o||"innerHTML"===o||o in n&&e[o]===("value"===o||"checked"===o?t[o]:n[o])||a(t,o,n[o],n[o]=e[o],O)}(p,n.attributes,w),O=f,p}(t,e,n,o,p);return l&&f.parentNode!==l&&l.appendChild(f),--k||(T=!1,p||u()),f}function c(t,e){var n=t._component;n?g(n):(null!=t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),!1!==e&&null!=t.__preactattr_||s(t),f(t))}function f(t){for(t=t.lastChild;t;){var e=t.previousSibling;c(t,!0),t=e}}function d(t,e,n){var o,r=A.length;for(t.prototype&&t.prototype.render?(o=new t(e,n),v.call(o,e,n)):((o=new v(e,n)).constructor=t,o.render=h);r--;)if(A[r].constructor===t)return o.__b=A[r].__b,A.splice(r,1),o;return o}function h(t,e,n){return this.constructor(t,n)}function y(t,e,o,r,i){t.__x||(t.__x=!0,t.__r=e.ref,t.__k=e.key,delete e.ref,delete e.key,void 0===t.constructor.getDerivedStateFromProps&&(!t.base||i?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,r)),r&&r!==t.context&&(t.__c||(t.__c=t.context),t.context=r),t.__p||(t.__p=t.props),t.props=e,t.__x=!1,0!==o&&(1!==o&&!1===w.syncComponentUpdates&&t.base?n(t):m(t,1,i)),t.__r&&t.__r(t))}function m(t,n,o,r){if(!t.__x){var s,a,l,f=t.props,h=t.state,v=t.context,b=t.__p||f,S=t.__s||h,_=t.__c||v,C=t.base,P=t.__b,E=C||P,O=t._component,T=!1,A=_;if(t.constructor.getDerivedStateFromProps&&(h=e(e({},h),t.constructor.getDerivedStateFromProps(f,h)),t.state=h),C&&(t.props=b,t.state=S,t.context=_,2!==n&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(f,h,v)?T=!0:t.componentWillUpdate&&t.componentWillUpdate(f,h,v),t.props=f,t.state=h,t.context=v),t.__p=t.__s=t.__c=t.__b=null,t.__d=!1,!T){s=t.render(f,h,v),t.getChildContext&&(v=e(e({},v),t.getChildContext())),C&&t.getSnapshotBeforeUpdate&&(A=t.getSnapshotBeforeUpdate(b,S));var U,x,R=s&&s.nodeName;if("function"==typeof R){var D=i(s);(a=O)&&a.constructor===R&&D.key==a.__k?y(a,D,1,v,!1):(U=a,t._component=a=d(R,D,v),a.__b=a.__b||P,a.__u=t,y(a,D,0,v,!1),m(a,1,o,!0)),x=a.base}else l=E,(U=O)&&(l=t._component=null),(E||1===n)&&(l&&(l._component=null),x=p(l,s,v,o||!C,E&&E.parentNode,!0));if(E&&x!==E&&a!==O){var j=E.parentNode;j&&x!==j&&(j.replaceChild(x,E),U||(E._component=null,c(E,!1)))}if(U&&g(U),t.base=x,x&&!r){for(var B=t,I=t;I=I.__u;)(B=I).base=x;x._component=B,x._componentConstructor=B.constructor}}for(!C||o?F.unshift(t):T||(t.componentDidUpdate&&t.componentDidUpdate(b,S,A),w.afterUpdate&&w.afterUpdate(t));t.__h.length;)t.__h.pop().call(t);k||r||u()}}function g(t){w.beforeUnmount&&w.beforeUnmount(t);var e=t.base;t.__x=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var n=t._component;n?g(n):e&&(e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),t.__b=e,s(e),A.push(t),f(e)),t.__r&&t.__r(null)}function v(t,e){this.__d=!0,this.context=e,this.props=t,this.state=this.state||{},this.__h=[]}var b=function(){},w={},S=[],_=[],C="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,P=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,E=[],F=[],k=0,O=!1,T=!1,A=[];e(v.prototype,{setState:function(t,o){this.__s||(this.__s=this.state),this.state=e(e({},this.state),"function"==typeof t?t(this.state,this.props):t),o&&this.__h.push(o),n(this)},forceUpdate:function(t){t&&this.__h.push(t),m(this,2)},render:function(){}});var U={h:t,createElement:t,cloneElement:function(n,o){return t(n.nodeName,e(e({},n.attributes),o),arguments.length>2?[].slice.call(arguments,2):n.children)},Component:v,render:function(t,e,n){return p(n,t,{},!1,e,!1)},rerender:o,options:w};D.exports=U}(),D=D.exports;var j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B=function(t){return t&&"object"===(void 0===t?"undefined":j(t))&&t.nodeType===Node.ELEMENT_NODE},I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M=function(t){return"string"==typeof t?document.querySelector(t):"object"===(void 0===t?"undefined":I(t))&&B(t)?t:void 0},L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},N="function"==typeof Symbol&&"symbol"===L(Symbol.iterator)?function(t){return void 0===t?"undefined":L(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":L(t)},z=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},q=function(){function t(e,n){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.uppy=e,this.opts=n||{},this.update=this.update.bind(this),this.mount=this.mount.bind(this),this.install=this.install.bind(this),this.uninstall=this.uninstall.bind(this)}return t.prototype.getPluginState=function(){return this.uppy.getState().plugins[this.id]||{}},t.prototype.setPluginState=function(t){var e,n=this.uppy.getState().plugins;this.uppy.setState({plugins:z({},n,(e={},e[this.id]=z({},n[this.id],t),e))})},t.prototype.update=function(t){void 0!==this.el&&this._updateUI&&this._updateUI(t)},t.prototype.onMount=function(){},t.prototype.mount=function(t,e){var n,o,r,i=this,s=e.id,a=M(t);if(a)return this.isTargetDOMEl=!0,this.rerender=function(t){i.uppy.getPlugin(i.id)&&(i.el=D.render(i.render(t),a,i.el))},this._updateUI=(n=this.rerender,o=null,r=null,function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];return r=e,o||(o=Promise.resolve().then(function(){return o=null,n.apply(void 0,r)})),o}),this.uppy.log("Installing "+s+" to a DOM element"),this.opts.replaceTargetContent&&(a.innerHTML=""),this.el=D.render(this.render(this.uppy.getState()),a),this.onMount(),this.el;var l=void 0;if("object"===(void 0===t?"undefined":N(t)))l=t;else if("function"==typeof t){var u=t;this.uppy.iteratePlugins(function(t){if(t instanceof u)return l=t,!1})}if(l)return this.uppy.log("Installing "+s+" to "+l.id),this.parent=l,this.el=l.addTarget(e),this.onMount(),this.el;throw this.uppy.log("Not installing "+s),new Error("Invalid target option given to "+s+". Please make sure that the element\n      exists on the page, or that the plugin you are targeting has been installed. Check that the <script> tag initializing Uppy\n      comes at the bottom of the page, before the closing </body> tag (see https://github.com/transloadit/uppy/issues/1042).")},t.prototype.render=function(t){throw new Error("Extend the render method to add your plugin to a DOM element")},t.prototype.addTarget=function(t){throw new Error("Extend the addTarget method to add your plugin to another plugin's target")},t.prototype.unmount=function(){this.isTargetDOMEl&&this.el&&this.el.parentNode&&this.el.parentNode.removeChild(this.el)},t.prototype.install=function(){},t.prototype.uninstall=function(){this.unmount()},t}(),H=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},W=function(){function t(){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.state={},this.callbacks=[]}return t.prototype.getState=function(){return this.state},t.prototype.setState=function(t){var e=H({},this.state),n=H({},this.state,t);this.state=n,this._publish(e,n,t)},t.prototype.subscribe=function(t){var e=this;return this.callbacks.push(t),function(){e.callbacks.splice(e.callbacks.indexOf(t),1)}},t.prototype._publish=function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];this.callbacks.forEach(function(t){t.apply(void 0,e)})},t}(),X=function(){return new W},V=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},G=function(){function t(e){var n=this;!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.locale={strings:{},pluralize:function(t){return 1===t?0:1}},Array.isArray(e)?e.forEach(function(t){return n._apply(t)}):this._apply(e)}return t.prototype._apply=function(t){if(t&&t.strings){var e=this.locale;this.locale=V({},e,{strings:V({},e.strings,t.strings)}),this.locale.pluralize=t.pluralize||e.pluralize}},t.prototype.interpolate=function(t,e){var n=String.prototype,o=n.split,r=n.replace,i=/\$/g,s=[t];for(var a in e)if("_"!==a&&e.hasOwnProperty(a)){var l=e[a];"string"==typeof l&&(l=r.call(e[a],i,"$$$$")),s=u(s,new RegExp("%\\{"+a+"\\}","g"),l)}return s;function u(t,e,n){var r=[];return t.forEach(function(t){o.call(t,e).forEach(function(t,e,o){""!==t&&r.push(t),e<o.length-1&&r.push(n)})}),r}},t.prototype.translate=function(t,e){return this.translateArray(t,e).join("")},t.prototype.translateArray=function(t,e){if(e&&void 0!==e.smart_count){var n=this.locale.pluralize(e.smart_count);return this.interpolate(this.locale.strings[t][n],e)}return this.interpolate(this.locale.strings[t],e)},t}(),$=function(t){return["uppy",t.name?t.name.toLowerCase().replace(/[^A-Z0-9]/gi,""):"",t.type,t.data.size,t.data.lastModified].filter(function(t){return t}).join("-")},K=function(t){var e=/(?:\.([^.]+))?$/.exec(t)[1];return{name:t.replace("."+e,""),extension:e}},Y={md:"text/markdown",markdown:"text/markdown",mp4:"video/mp4",mp3:"audio/mp3",svg:"image/svg+xml",jpg:"image/jpeg",png:"image/png",gif:"image/gif",yaml:"text/yaml",yml:"text/yaml",csv:"text/csv",avi:"video/x-msvideo",mks:"video/x-matroska",mkv:"video/x-matroska",mov:"video/quicktime",doc:"application/msword",docm:"application/vnd.ms-word.document.macroenabled.12",docx:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",dot:"application/msword",dotm:"application/vnd.ms-word.template.macroenabled.12",dotx:"application/vnd.openxmlformats-officedocument.wordprocessingml.template",xla:"application/vnd.ms-excel",xlam:"application/vnd.ms-excel.addin.macroenabled.12",xlc:"application/vnd.ms-excel",xlf:"application/x-xliff+xml",xlm:"application/vnd.ms-excel",xls:"application/vnd.ms-excel",xlsb:"application/vnd.ms-excel.sheet.binary.macroenabled.12",xlsm:"application/vnd.ms-excel.sheet.macroenabled.12",xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",xlt:"application/vnd.ms-excel",xltm:"application/vnd.ms-excel.template.macroenabled.12",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template",xlw:"application/vnd.ms-excel"},J=function(t){var e=t.name?K(t.name).extension:null;return e=e?e.toLowerCase():null,t.isRemote?t.type?t.type:Y[e]:t.type?t.type:e&&Y[e]?Y[e]:"application/octet-stream"};function Q(t){return 2!==t.length?0+t:t}var Z,tt=function(){var t=new Date;return Q(t.getHours().toString())+":"+Q(t.getMinutes().toString())+":"+Q(t.getSeconds().toString())},et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nt="function"==typeof Symbol&&"symbol"===et(Symbol.iterator)?function(t){return void 0===t?"undefined":et(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":et(t)},ot=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},rt=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),it=function(){function t(e){var n=this;!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this);var o={strings:{youCanOnlyUploadX:{0:"You can only upload %{smart_count} file",1:"You can only upload %{smart_count} files"},youHaveToAtLeastSelectX:{0:"You have to select at least %{smart_count} file",1:"You have to select at least %{smart_count} files"},exceedsSize:"This file exceeds maximum allowed size of",youCanOnlyUploadFileTypes:"You can only upload:",companionError:"Connection with Companion failed",failedToUpload:"Failed to upload %{file}",noInternetConnection:"No Internet connection",connectedToInternet:"Connected to the Internet",noFilesFound:"You have no files or folders here",selectXFiles:{0:"Select %{smart_count} file",1:"Select %{smart_count} files"},cancel:"Cancel",logOut:"Log out"}},r={id:"uppy",autoProceed:!1,allowMultipleUploads:!0,debug:!1,restrictions:{maxFileSize:null,maxNumberOfFiles:null,minNumberOfFiles:null,allowedFileTypes:null},meta:{},onBeforeFileAdded:function(t,e){return t},onBeforeUpload:function(t){return t},locale:o,store:X()};this.opts=ot({},r,e),this.opts.restrictions=ot({},r.restrictions,this.opts.restrictions),this.translator=new G([o,this.opts.locale]),this.locale=this.translator.locale,this.i18n=this.translator.translate.bind(this.translator),this.plugins={},this.getState=this.getState.bind(this),this.getPlugin=this.getPlugin.bind(this),this.setFileMeta=this.setFileMeta.bind(this),this.setFileState=this.setFileState.bind(this),this.log=this.log.bind(this),this.info=this.info.bind(this),this.hideInfo=this.hideInfo.bind(this),this.addFile=this.addFile.bind(this),this.removeFile=this.removeFile.bind(this),this.pauseResume=this.pauseResume.bind(this),this._calculateProgress=this._calculateProgress.bind(this),this.updateOnlineStatus=this.updateOnlineStatus.bind(this),this.resetProgress=this.resetProgress.bind(this),this.pauseAll=this.pauseAll.bind(this),this.resumeAll=this.resumeAll.bind(this),this.retryAll=this.retryAll.bind(this),this.cancelAll=this.cancelAll.bind(this),this.retryUpload=this.retryUpload.bind(this),this.upload=this.upload.bind(this),this.emitter=y(),this.on=this.on.bind(this),this.off=this.off.bind(this),this.once=this.emitter.once.bind(this.emitter),this.emit=this.emitter.emit.bind(this.emitter),this.preProcessors=[],this.uploaders=[],this.postProcessors=[],this.store=this.opts.store,this.setState({plugins:{},files:{},currentUploads:{},allowNewUpload:!0,capabilities:{resumableUploads:!1},totalProgress:0,meta:ot({},this.opts.meta),info:{isHidden:!0,type:"info",message:""}}),this._storeUnsubscribe=this.store.subscribe(function(t,e,o){n.emit("state-update",t,e,o),n.updateAll(e)}),this.opts.debug&&"undefined"!=typeof window&&(window.uppyLog="",window[this.opts.id]=this),this._addListeners()}return t.prototype.on=function(t,e){return this.emitter.on(t,e),this},t.prototype.off=function(t,e){return this.emitter.off(t,e),this},t.prototype.updateAll=function(t){this.iteratePlugins(function(e){e.update(t)})},t.prototype.setState=function(t){this.store.setState(t)},t.prototype.getState=function(){return this.store.getState()},t.prototype.setFileState=function(t,e){var n;if(!this.getState().files[t])throw new Error("Can\u2019t set state for "+t+" (the file could have been removed)");this.setState({files:ot({},this.getState().files,(n={},n[t]=ot({},this.getState().files[t],e),n))})},t.prototype.resetProgress=function(){var t={percentage:0,bytesUploaded:0,uploadComplete:!1,uploadStarted:!1},e=ot({},this.getState().files),n={};Object.keys(e).forEach(function(o){var r=ot({},e[o]);r.progress=ot({},r.progress,t),n[o]=r}),this.setState({files:n,totalProgress:0}),this.emit("reset-progress")},t.prototype.addPreProcessor=function(t){this.preProcessors.push(t)},t.prototype.removePreProcessor=function(t){var e=this.preProcessors.indexOf(t);-1!==e&&this.preProcessors.splice(e,1)},t.prototype.addPostProcessor=function(t){this.postProcessors.push(t)},t.prototype.removePostProcessor=function(t){var e=this.postProcessors.indexOf(t);-1!==e&&this.postProcessors.splice(e,1)},t.prototype.addUploader=function(t){this.uploaders.push(t)},t.prototype.removeUploader=function(t){var e=this.uploaders.indexOf(t);-1!==e&&this.uploaders.splice(e,1)},t.prototype.setMeta=function(t){var e=ot({},this.getState().meta,t),n=ot({},this.getState().files);Object.keys(n).forEach(function(e){n[e]=ot({},n[e],{meta:ot({},n[e].meta,t)})}),this.log("Adding metadata:"),this.log(t),this.setState({meta:e,files:n})},t.prototype.setFileMeta=function(t,e){var n=ot({},this.getState().files);if(n[t]){var o=ot({},n[t].meta,e);n[t]=ot({},n[t],{meta:o}),this.setState({files:n})}else this.log("Was trying to set metadata for a file that\u2019s not with us anymore: ",t)},t.prototype.getFile=function(t){return this.getState().files[t]},t.prototype.getFiles=function(){var t=this.getState().files;return Object.keys(t).map(function(e){return t[e]})},t.prototype._checkMinNumberOfFiles=function(t){var e=this.opts.restrictions.minNumberOfFiles;if(Object.keys(t).length<e)throw new Error(""+this.i18n("youHaveToAtLeastSelectX",{smart_count:e}))},t.prototype._checkRestrictions=function(t){var e=this.opts.restrictions,n=e.maxFileSize,o=e.maxNumberOfFiles,r=e.allowedFileTypes;if(o&&Object.keys(this.getState().files).length+1>o)throw new Error(""+this.i18n("youCanOnlyUploadX",{smart_count:o}));if(r&&!(r.filter(function(e){return e.indexOf("/")>-1?!!t.type&&function(t,e){function n(e){var n=A(e,t,x);return n&&n.length>=2}return e?n(e.split(";")[0]):n}(t.type,e):"."===e[0]&&t.extension===e.substr(1)?t.extension:void 0}).length>0)){var i=r.join(", ");throw new Error(this.i18n("youCanOnlyUploadFileTypes")+" "+i)}if(n&&t.data.size>n)throw new Error(this.i18n("exceedsSize")+" "+R(n))},t.prototype.addFile=function(t){var e,n=this,o=this.getState(),r=o.files,i=function(t){var e="object"===(void 0===t?"undefined":nt(t))?t:new Error(t);throw n.log(e.message),n.info(e.message,"error",5e3),e};!1===o.allowNewUpload&&i(new Error("Cannot add new files: already uploading."));var s=this.opts.onBeforeFileAdded(t,r);if(!1!==s){if("object"===(void 0===s?"undefined":nt(s))&&s){if(s.then)throw new TypeError("onBeforeFileAdded() returned a Promise, but this is no longer supported. It must be synchronous.");t=s}var a,l=J(t);a=t.name?t.name:"image"===l.split("/")[0]?l.split("/")[0]+"."+l.split("/")[1]:"noname";var u=K(a).extension,p=t.isRemote||!1,c=$(t),f=t.meta||{};f.name=a,f.type=l;var d={source:t.source||"",id:c,name:a,extension:u||"",meta:ot({},this.getState().meta,f),type:l,data:t.data,progress:{percentage:0,bytesUploaded:0,bytesTotal:t.data.size||0,uploadComplete:!1,uploadStarted:!1},size:t.data.size||0,isRemote:p,remote:t.remote||"",preview:t.preview};try{this._checkRestrictions(d)}catch(t){i(t)}this.setState({files:ot({},r,(e={},e[c]=d,e))}),this.emit("file-added",d),this.log("Added file: "+a+", "+c+", mime type: "+l),this.opts.autoProceed&&!this.scheduledAutoProceed&&(this.scheduledAutoProceed=setTimeout(function(){n.scheduledAutoProceed=null,n.upload().catch(function(t){console.error(t.stack||t.message||t)})},4))}else this.log("Not adding file because onBeforeFileAdded returned false")},t.prototype.removeFile=function(t){var e=this,n=this.getState(),o=n.files,r=n.currentUploads,i=ot({},o),s=i[t];delete i[t];var a=ot({},r),l=[];Object.keys(a).forEach(function(e){var n=r[e].fileIDs.filter(function(e){return e!==t});0!==n.length?a[e]=ot({},r[e],{fileIDs:n}):l.push(e)}),this.setState({currentUploads:a,files:i}),l.forEach(function(t){e._removeUpload(t)}),this._calculateTotalProgress(),this.emit("file-removed",s),this.log("File removed: "+s.id)},t.prototype.pauseResume=function(t){if(this.getState().capabilities.resumableUploads&&!this.getFile(t).uploadComplete){var e=!this.getFile(t).isPaused;return this.setFileState(t,{isPaused:e}),this.emit("upload-pause",t,e),e}},t.prototype.pauseAll=function(){var t=ot({},this.getState().files);Object.keys(t).filter(function(e){return!t[e].progress.uploadComplete&&t[e].progress.uploadStarted}).forEach(function(e){var n=ot({},t[e],{isPaused:!0});t[e]=n}),this.setState({files:t}),this.emit("pause-all")},t.prototype.resumeAll=function(){var t=ot({},this.getState().files);Object.keys(t).filter(function(e){return!t[e].progress.uploadComplete&&t[e].progress.uploadStarted}).forEach(function(e){var n=ot({},t[e],{isPaused:!1,error:null});t[e]=n}),this.setState({files:t}),this.emit("resume-all")},t.prototype.retryAll=function(){var t=ot({},this.getState().files),e=Object.keys(t).filter(function(e){return t[e].error});e.forEach(function(e){var n=ot({},t[e],{isPaused:!1,error:null});t[e]=n}),this.setState({files:t,error:null}),this.emit("retry-all",e);var n=this._createUpload(e);return this._runUpload(n)},t.prototype.cancelAll=function(){var t=this;this.emit("cancel-all"),Object.keys(this.getState().files).forEach(function(e){t.removeFile(e)}),this.setState({allowNewUpload:!0,totalProgress:0,error:null})},t.prototype.retryUpload=function(t){var e=ot({},this.getState().files),n=ot({},e[t],{error:null,isPaused:!1});e[t]=n,this.setState({files:e}),this.emit("upload-retry",t);var o=this._createUpload([t]);return this._runUpload(o)},t.prototype.reset=function(){this.cancelAll()},t.prototype._calculateProgress=function(t,e){this.getFile(t.id)?(this.setFileState(t.id,{progress:ot({},this.getFile(t.id).progress,{bytesUploaded:e.bytesUploaded,bytesTotal:e.bytesTotal,percentage:Math.floor((e.bytesUploaded/e.bytesTotal*100).toFixed(2))})}),this._calculateTotalProgress()):this.log("Not setting progress for a file that has been removed: "+t.id)},t.prototype._calculateTotalProgress=function(){var t=this.getFiles().filter(function(t){return t.progress.uploadStarted});if(0!==t.length){var e=t.filter(function(t){return null!=t.progress.bytesTotal}),n=t.filter(function(t){return null==t.progress.bytesTotal});if(0!==e.length){var o=e.reduce(function(t,e){return t+e.progress.bytesTotal},0),r=o/e.length;o+=r*n.length;var i=0;e.forEach(function(t){i+=t.progress.bytesUploaded}),n.forEach(function(t){i+=r*(t.progress.percentage||0)});var s=0===o?0:Math.round(i/o*100);this.setState({totalProgress:s})}else{var a=t.length,l=n.reduce(function(t,e){return t+e.progress.percentage},0),u=Math.round(l/a*100);this.setState({totalProgress:u})}}else this.setState({totalProgress:0})},t.prototype._addListeners=function(){var t=this;this.on("error",function(e){t.setState({error:e.message})}),this.on("upload-error",function(e,n){t.setFileState(e.id,{error:n.message}),t.setState({error:n.message});var o=t.i18n("failedToUpload",{file:e.name});"object"===(void 0===n?"undefined":nt(n))&&n.message&&(o={message:o,details:n.message}),t.info(o,"error",5e3)}),this.on("upload",function(){t.setState({error:null})}),this.on("upload-started",function(e,n){t.getFile(e.id)?t.setFileState(e.id,{progress:{uploadStarted:Date.now(),uploadComplete:!1,percentage:0,bytesUploaded:0,bytesTotal:e.size}}):t.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("upload-progress",this._calculateProgress),this.on("upload-success",function(e,n,o){var r=t.getFile(e.id).progress;t.setFileState(e.id,{progress:ot({},r,{uploadComplete:!0,percentage:100,bytesUploaded:r.bytesTotal}),uploadURL:o,isPaused:!1}),t._calculateTotalProgress()}),this.on("preprocess-progress",function(e,n){t.getFile(e.id)?t.setFileState(e.id,{progress:ot({},t.getFile(e.id).progress,{preprocess:n})}):t.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("preprocess-complete",function(e){if(t.getFile(e.id)){var n=ot({},t.getState().files);n[e.id]=ot({},n[e.id],{progress:ot({},n[e.id].progress)}),delete n[e.id].progress.preprocess,t.setState({files:n})}else t.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("postprocess-progress",function(e,n){t.getFile(e.id)?t.setFileState(e.id,{progress:ot({},t.getState().files[e.id].progress,{postprocess:n})}):t.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("postprocess-complete",function(e){if(t.getFile(e.id)){var n=ot({},t.getState().files);n[e.id]=ot({},n[e.id],{progress:ot({},n[e.id].progress)}),delete n[e.id].progress.postprocess,t.setState({files:n})}else t.log("Not setting progress for a file that has been removed: "+e.id)}),this.on("restored",function(){t._calculateTotalProgress()}),"undefined"!=typeof window&&window.addEventListener&&(window.addEventListener("online",function(){return t.updateOnlineStatus()}),window.addEventListener("offline",function(){return t.updateOnlineStatus()}),setTimeout(function(){return t.updateOnlineStatus()},3e3))},t.prototype.updateOnlineStatus=function(){void 0===window.navigator.onLine||window.navigator.onLine?(this.emit("is-online"),this.wasOffline&&(this.emit("back-online"),this.info(this.i18n("connectedToInternet"),"success",3e3),this.wasOffline=!1)):(this.emit("is-offline"),this.info(this.i18n("noInternetConnection"),"error",0),this.wasOffline=!0)},t.prototype.getID=function(){return this.opts.id},t.prototype.use=function(t,e){if("function"!=typeof t){var n="Expected a plugin class, but got "+(null===t?"null":void 0===t?"undefined":nt(t))+". Please verify that the plugin was imported and spelled correctly.";throw new TypeError(n)}var o=new t(this,e),r=o.id;if(this.plugins[o.type]=this.plugins[o.type]||[],!r)throw new Error("Your plugin must have an id");if(!o.type)throw new Error("Your plugin must have a type");var i=this.getPlugin(r);if(i){var s="Already found a plugin named '"+i.id+"'. Tried to use: '"+r+"'.\nUppy plugins must have unique 'id' options. See https://uppy.io/docs/plugins/#id.";throw new Error(s)}return this.plugins[o.type].push(o),o.install(),this},t.prototype.getPlugin=function(t){var e=null;return this.iteratePlugins(function(n){if(n.id===t)return e=n,!1}),e},t.prototype.iteratePlugins=function(t){var e=this;Object.keys(this.plugins).forEach(function(n){e.plugins[n].forEach(t)})},t.prototype.removePlugin=function(t){this.log("Removing plugin "+t.id),this.emit("plugin-remove",t),t.uninstall&&t.uninstall();var e=this.plugins[t.type].slice(),n=e.indexOf(t);-1!==n&&(e.splice(n,1),this.plugins[t.type]=e);var o=this.getState();delete o.plugins[t.id],this.setState(o)},t.prototype.close=function(){var t=this;this.log("Closing Uppy instance "+this.opts.id+": removing all files and uninstalling plugins"),this.reset(),this._storeUnsubscribe(),this.iteratePlugins(function(e){t.removePlugin(e)})},t.prototype.info=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e3,o="object"===(void 0===t?"undefined":nt(t));this.setState({info:{isHidden:!1,type:e,message:o?t.message:t,details:o?t.details:null}}),this.emit("info-visible"),clearTimeout(this.infoTimeoutID),this.infoTimeoutID=0!==n?setTimeout(this.hideInfo,n):void 0},t.prototype.hideInfo=function(){var t=ot({},this.getState().info,{isHidden:!0});this.setState({info:t}),this.emit("info-hidden")},t.prototype.log=function(t,e){if(this.opts.debug){var n="[Uppy] ["+tt()+"] "+t;window.uppyLog=window.uppyLog+"\nDEBUG LOG: "+t,"error"!==e?"warning"!==e?t===""+t?console.log(n):(n="[Uppy] ["+tt()+"]",console.log(n),console.dir(t)):console.warn(n):console.error(n)}},t.prototype.run=function(){return this.log("Calling run() is no longer necessary.","warning"),this},t.prototype.restore=function(t){return this.log('Core: attempting to restore upload "'+t+'"'),this.getState().currentUploads[t]?this._runUpload(t):(this._removeUpload(t),Promise.reject(new Error("Nonexistent upload")))},t.prototype._createUpload=function(t){var e,n=this.getState(),o=n.allowNewUpload,r=n.currentUploads;if(!o)throw new Error("Cannot create a new upload: already uploading.");var i=_();return this.emit("upload",{id:i,fileIDs:t}),this.setState({allowNewUpload:!1!==this.opts.allowMultipleUploads,currentUploads:ot({},r,(e={},e[i]={fileIDs:t,step:0,result:{}},e))}),i},t.prototype._getUpload=function(t){return this.getState().currentUploads[t]},t.prototype.addResultData=function(t,e){var n;if(this._getUpload(t)){var o=this.getState().currentUploads,r=ot({},o[t],{result:ot({},o[t].result,e)});this.setState({currentUploads:ot({},o,(n={},n[t]=r,n))})}else this.log("Not setting result for an upload that has been removed: "+t)},t.prototype._removeUpload=function(t){var e=ot({},this.getState().currentUploads);delete e[t],this.setState({currentUploads:e})},t.prototype._runUpload=function(t){var e=this,n=this.getState().currentUploads[t].step,o=[].concat(this.preProcessors,this.uploaders,this.postProcessors),r=Promise.resolve();return o.forEach(function(o,i){i<n||(r=r.then(function(){var n,r=e.getState().currentUploads,s=ot({},r[t],{step:i});return e.setState({currentUploads:ot({},r,(n={},n[t]=s,n))}),o(s.fileIDs,t)}).then(function(t){return null}))}),r.catch(function(n){e.emit("error",n,t),e._removeUpload(t)}),r.then(function(){var n=e.getState().currentUploads[t];if(n){var o=n.fileIDs.map(function(t){return e.getFile(t)}),r=o.filter(function(t){return!t.error}),i=o.filter(function(t){return t.error});e.addResultData(t,{successful:r,failed:i,uploadID:t})}else e.log("Not setting result for an upload that has been removed: "+t)}).then(function(){var n=e.getState().currentUploads[t].result;return e.emit("complete",n),e._removeUpload(t),n})},t.prototype.upload=function(){var t=this;this.plugins.uploader||this.log("No uploader type plugins are used","warning");var e=this.getState().files,n=this.opts.onBeforeUpload(e);if(!1===n)return Promise.reject(new Error("Not starting the upload because onBeforeUpload returned false"));if(n&&"object"===(void 0===n?"undefined":nt(n))){if(n.then)throw new TypeError("onBeforeUpload() returned a Promise, but this is no longer supported. It must be synchronous.");e=n}return Promise.resolve().then(function(){return t._checkMinNumberOfFiles(e)}).then(function(){var n=t.getState().currentUploads,o=Object.keys(n).reduce(function(t,e){return t.concat(n[e].fileIDs)},[]),r=[];Object.keys(e).forEach(function(e){var n=t.getFile(e);n.progress.uploadStarted||-1!==o.indexOf(e)||r.push(n.id)});var i=t._createUpload(r);return t._runUpload(i)}).catch(function(e){var n="object"===(void 0===e?"undefined":nt(e))?e.message:e,o="object"===(void 0===e?"undefined":nt(e))?e.details:null;return t.log(n+" "+o),t.info({message:n,details:o},"error",4e3),Promise.reject("object"===(void 0===e?"undefined":nt(e))?e:new Error(e))})},rt(t,[{key:"state",get:function(){return this.getState()}}]),t}();(Z=function(t){return new it(t)}).Uppy=it,Z.Plugin=q;var st={};(function(t){var e="Expected a function",n=NaN,o="[object Symbol]",r=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,a=/^0o[0-7]+$/i,l=parseInt,u="object"==typeof t&&t&&t.Object===Object&&t,p="object"==typeof self&&self&&self.Object===Object&&self,c=u||p||Function("return this")(),f=Object.prototype.toString,d=Math.max,h=Math.min,y=function(){return c.Date.now()};function m(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&f.call(t)==o}(t))return n;if(m(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=m(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(r,"");var u=s.test(t);return u||a.test(t)?l(t.slice(2),u?2:8):i.test(t)?n:+t}st=function(t,n,o){var r=!0,i=!0;if("function"!=typeof t)throw new TypeError(e);return m(o)&&(r="leading"in o?!!o.leading:r,i="trailing"in o?!!o.trailing:i),function(t,n,o){var r,i,s,a,l,u,p=0,c=!1,f=!1,v=!0;if("function"!=typeof t)throw new TypeError(e);function b(e){var n=r,o=i;return r=i=void 0,p=e,a=t.apply(o,n)}function w(t){var e=t-u;return void 0===u||e>=n||e<0||f&&t-p>=s}function S(){var t=y();if(w(t))return _(t);l=setTimeout(S,function(t){var e=n-(t-u);return f?h(e,s-(t-p)):e}(t))}function _(t){return l=void 0,v&&r?b(t):(r=i=void 0,a)}function C(){var t=y(),e=w(t);if(r=arguments,i=this,u=t,e){if(void 0===l)return function(t){return p=t,l=setTimeout(S,n),c?b(t):a}(u);if(f)return l=setTimeout(S,n),b(u)}return void 0===l&&(l=setTimeout(S,n)),a}return n=g(n)||0,m(o)&&(c=!!o.leading,s=(f="maxWait"in o)?d(g(o.maxWait)||0,n):s,v="trailing"in o?!!o.trailing:v),C.cancel=function(){void 0!==l&&clearTimeout(l),p=0,r=u=i=l=void 0},C.flush=function(){return void 0===l?a:_(y())},C}(t,n,{leading:r,maxWait:n,trailing:i})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var at=st(function(t,e,n){var o=e.progress,r=e.bytesUploaded,i=e.bytesTotal;o&&(t.uppy.log("Upload progress: "+o),t.uppy.emit("upload-progress",n,{uploader:t,bytesUploaded:r,bytesTotal:i}))},300,{leading:!0,trailing:!0}),lt=function(t){var e=/^(?:https?:\/\/|\/\/)?(?:[^@\n]+@)?(?:www\.)?([^\n]+)/.exec(t)[1];return("https:"===location.protocol?"wss":"ws")+"://"+e},ut=function(t){var e=0,n=[];return function(r){return function(){for(var i=arguments.length,s=Array(i),a=0;a<i;a++)s[a]=arguments[a];var l=function(){e++;var t=r.apply(void 0,s);return t.then(o,o),t};return e>=t?new Promise(function(t,e){n.push(function(){l().then(t,e)})}):l()}};function o(){e--;var t=n.shift();t&&t()}},pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ct=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},ft=m.Socket,dt=m.RequestClient;function ht(t){var e=[];return{on:function(n,o){return e.push([n,o]),t.on(n,o)},remove:function(){e.forEach(function(e){var n=e[0],o=e[1];t.off(n,o)})}}}function yt(t){if(t&&t.error){var e=new Error(t.message);throw ct(e,t.error),e}return t}var mt,gt=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":pt(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));r.type="uploader",r.id="AwsS3Multipart",r.title="AWS S3 Multipart",r.client=new dt(n,o);var i={timeout:3e4,limit:0,createMultipartUpload:r.createMultipartUpload.bind(r),listParts:r.listParts.bind(r),prepareUploadPart:r.prepareUploadPart.bind(r),abortMultipartUpload:r.abortMultipartUpload.bind(r),completeMultipartUpload:r.completeMultipartUpload.bind(r)};return r.opts=ct({},i,o),r.upload=r.upload.bind(r),"number"==typeof r.opts.limit&&0!==r.opts.limit?r.limitRequests=ut(r.opts.limit):r.limitRequests=function(t){return t},r.uploaders=Object.create(null),r.uploaderEvents=Object.create(null),r.uploaderSockets=Object.create(null),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":pt(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.resetUploaderReferences=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.uploaders[t]&&(this.uploaders[t].abort({really:e.abort||!1}),this.uploaders[t]=null),this.uploaderEvents[t]&&(this.uploaderEvents[t].remove(),this.uploaderEvents[t]=null),this.uploaderSockets[t]&&(this.uploaderSockets[t].close(),this.uploaderSockets[t]=null)},e.prototype.assertHost=function(){if(!this.opts.serverUrl)throw new Error("Expected a `serverUrl` option containing a Companion address.")},e.prototype.createMultipartUpload=function(t){return this.assertHost(),this.client.post("s3/multipart",{filename:t.name,type:t.type}).then(yt)},e.prototype.listParts=function(t,e){var n=e.key,o=e.uploadId;this.assertHost();var r=encodeURIComponent(n);return this.client.get("s3/multipart/"+o+"?key="+r).then(yt)},e.prototype.prepareUploadPart=function(t,e){var n=e.key,o=e.uploadId,r=e.number;this.assertHost();var i=encodeURIComponent(n);return this.client.get("s3/multipart/"+o+"/"+r+"?key="+i).then(yt)},e.prototype.completeMultipartUpload=function(t,e){var n=e.key,o=e.uploadId,r=e.parts;this.assertHost();var i=encodeURIComponent(n),s=encodeURIComponent(o);return this.client.post("s3/multipart/"+s+"/complete?key="+i,{parts:r}).then(yt)},e.prototype.abortMultipartUpload=function(t,e){var n=e.key,o=e.uploadId;this.assertHost();var r=encodeURIComponent(n),i=encodeURIComponent(o);return this.client.delete("s3/multipart/"+i+"?key="+r).then(yt)},e.prototype.uploadFile=function(t){var e=this;return new Promise(function(n,o){var r=new s(t.data,ct({createMultipartUpload:e.limitRequests(e.opts.createMultipartUpload.bind(e,t)),listParts:e.limitRequests(e.opts.listParts.bind(e,t)),prepareUploadPart:e.opts.prepareUploadPart.bind(e,t),completeMultipartUpload:e.limitRequests(e.opts.completeMultipartUpload.bind(e,t)),abortMultipartUpload:e.limitRequests(e.opts.abortMultipartUpload.bind(e,t)),limit:e.opts.limit||5,onStart:function(n){var o=e.uppy.getFile(t.id);e.uppy.setFileState(t.id,{s3Multipart:ct({},o.s3Multipart,{key:n.key,uploadId:n.uploadId,parts:[]})})},onProgress:function(n,o){e.uppy.emit("upload-progress",t,{uploader:e,bytesUploaded:n,bytesTotal:o})},onError:function(n){e.uppy.log(n),e.uppy.emit("upload-error",t,n),n.message="Failed because: "+n.message,e.resetUploaderReferences(t.id),o(n)},onSuccess:function(o){e.uppy.emit("upload-success",t,r,o.location),o.location&&e.uppy.log("Download "+r.file.name+" from "+o.location),e.resetUploaderReferences(t.id),n(r)},onPartComplete:function(n){var o=e.uppy.getFile(t.id);o&&(e.uppy.setFileState(t.id,{s3Multipart:ct({},o.s3Multipart,{parts:[].concat(o.s3Multipart.parts,[n])})}),e.uppy.emit("s3-multipart:part-uploaded",o,n))}},t.s3Multipart));e.uploaders[t.id]=r,e.uploaderEvents[t.id]=ht(e.uppy),e.onFileRemove(t.id,function(o){e.resetUploaderReferences(t.id,{abort:!0}),n("upload "+o.id+" was removed")}),e.onFilePause(t.id,function(t){t?r.pause():r.start()}),e.onPauseAll(t.id,function(){r.pause()}),e.onResumeAll(t.id,function(){r.start()}),t.isPaused||r.start(),t.isRestored||e.uppy.emit("upload-started",t,r)})},e.prototype.uploadRemote=function(t){var e=this;return this.resetUploaderReferences(t.id),new Promise(function(n,o){if(t.serverToken)return e.connectToServerSocket(t).then(function(){return n()}).catch(o);e.uppy.emit("upload-started",t),fetch(t.remote.url,{method:"post",credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(ct({},t.remote.body,{protocol:"s3-multipart",size:t.data.size,metadata:t.meta}))}).then(function(n){return n.status<200||n.status>300?o(n.statusText):n.json().then(function(n){return e.uppy.setFileState(t.id,{serverToken:n.token}),e.uppy.getFile(t.id)})}).then(function(t){return e.connectToServerSocket(t)}).then(function(){n()}).catch(function(t){o(new Error(t))})})},e.prototype.connectToServerSocket=function(t){var e=this;return new Promise(function(n,o){var r=t.serverToken,i=lt(t.remote.serverUrl),s=new ft({target:i+"/api/"+r});e.uploaderSockets[s]=s,e.uploaderEvents[t.id]=ht(e.uppy),e.onFileRemove(t.id,function(o){e.resetUploaderReferences(t.id,{abort:!0}),n("upload "+t.id+" was removed")}),e.onFilePause(t.id,function(t){s.send(t?"pause":"resume",{})}),e.onPauseAll(t.id,function(){return s.send("pause",{})}),e.onResumeAll(t.id,function(){t.error&&s.send("pause",{}),s.send("resume",{})}),e.onRetry(t.id,function(){s.send("pause",{}),s.send("resume",{})}),e.onRetryAll(t.id,function(){s.send("pause",{}),s.send("resume",{})}),t.isPaused&&s.send("pause",{}),s.on("progress",function(n){return at(e,n,t)}),s.on("error",function(n){e.uppy.emit("upload-error",t,new Error(n.error)),o(new Error(n.error))}),s.on("success",function(o){e.uppy.emit("upload-success",t,o,o.url),n()})})},e.prototype.upload=function(t){var e=this;if(0===t.length)return Promise.resolve();var n=t.map(function(t){var n=e.uppy.getFile(t);return n.isRemote?e.uploadRemote(n):e.uploadFile(n)});return Promise.all(n)},e.prototype.onFileRemove=function(t,e){this.uploaderEvents[t].on("file-removed",function(n){t===n.id&&e(n.id)})},e.prototype.onFilePause=function(t,e){this.uploaderEvents[t].on("upload-pause",function(n,o){t===n&&e(o)})},e.prototype.onRetry=function(t,e){this.uploaderEvents[t].on("upload-retry",function(n){t===n&&e()})},e.prototype.onRetryAll=function(t,e){var n=this;this.uploaderEvents[t].on("retry-all",function(o){n.uppy.getFile(t)&&e()})},e.prototype.onPauseAll=function(t,e){var n=this;this.uploaderEvents[t].on("pause-all",function(){n.uppy.getFile(t)&&e()})},e.prototype.onResumeAll=function(t,e){var n=this;this.uploaderEvents[t].on("resume-all",function(){n.uppy.getFile(t)&&e()})},e.prototype.install=function(){var t=this,e=this.uppy.getState().capabilities;this.uppy.setState({capabilities:ct({},e,{resumableUploads:!0})}),this.uppy.addUploader(this.upload),this.uppy.on("cancel-all",function(){t.uppy.getFiles().forEach(function(e){t.resetUploaderReferences(e.id,{abort:!0})})})},e.prototype.uninstall=function(){this.uppy.setState({capabilities:ct({},this.uppy.getState().capabilities,{resumableUploads:!1})}),this.uppy.removeUploader(this.upload)},e}(Z.Plugin),vt={};mt=function(){return function(){var t=arguments.length;if(0===t)throw new Error("resolveUrl requires at least one argument; got none.");var e=document.createElement("base");if(e.href=arguments[0],1===t)return e.href;var n=document.getElementsByTagName("head")[0];n.insertBefore(e,n.firstChild);for(var o,r=document.createElement("a"),i=1;i<t;i++)r.href=arguments[i],o=r.href,e.href=o;return n.removeChild(e),o}},"object"==typeof vt?vt=mt():this.resolveUrl=mt();var bt=function(t){var e=[],n=[];function o(t){e.push(t)}function r(t){n.push(t)}return Promise.all(t.map(function(t){return t.then(o,r)})).then(function(){return{successful:e,failed:n}})},wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},St=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},_t=m.Provider,Ct=m.Socket;function Pt(t,e){return e||(e=new Error("Upload error")),"string"==typeof e&&(e=new Error(e)),e instanceof Error||(e=St(new Error("Upload error"),{data:e})),e.request=t,e}var Et=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":wt(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));r.type="uploader",r.id="XHRUpload",r.title="XHRUpload";var i={strings:{timedOut:"Upload stalled for %{seconds} seconds, aborting."}},s={formData:!0,fieldName:"files[]",method:"post",metaFields:null,responseUrlFieldName:"url",bundle:!1,headers:{},locale:i,timeout:3e4,limit:0,withCredentials:!1,responseType:"",getResponseData:function(t,e){var n={};try{n=JSON.parse(t)}catch(t){console.log(t)}return n},getResponseError:function(t,e){return new Error("Upload error")}};if(r.opts=St({},s,o),r.translator=new G([i,r.uppy.locale,r.opts.locale]),r.i18n=r.translator.translate.bind(r.translator),r.i18nArray=r.translator.translateArray.bind(r.translator),r.handleUpload=r.handleUpload.bind(r),"number"==typeof r.opts.limit&&0!==r.opts.limit?r.limitUploads=ut(r.opts.limit):r.limitUploads=function(t){return t},r.opts.bundle&&!r.opts.formData)throw new Error("`opts.formData` must be true when `opts.bundle` is enabled.");return r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":wt(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getOptions=function(t){var e=this.uppy.getState().xhrUpload,n=St({},this.opts,e||{},t.xhrUpload||{});return n.headers={},St(n.headers,this.opts.headers),e&&St(n.headers,e.headers),t.xhrUpload&&St(n.headers,t.xhrUpload.headers),n},e.prototype.createProgressTimeout=function(t,e){var n=this.uppy,o=this,r=!1;function i(){n.log("[XHRUpload] timed out");var r=new Error(o.i18n("timedOut",{seconds:Math.ceil(t/1e3)}));e(r)}var s=null;return{progress:function(){r||t>0&&(s&&clearTimeout(s),s=setTimeout(i,t))},done:function(){n.log("[XHRUpload] timer done"),s&&(clearTimeout(s),s=null),r=!0}}},e.prototype.createFormDataUpload=function(t,e){var n=new FormData;return(Array.isArray(e.metaFields)?e.metaFields:Object.keys(t.meta)).forEach(function(e){n.append(e,t.meta[e])}),t.name?n.append(e.fieldName,t.data,t.name):n.append(e.fieldName,t.data),n},e.prototype.createBareUpload=function(t,e){return t.data},e.prototype.upload=function(t,e,n){var o=this,r=this.getOptions(t);return this.uppy.log("uploading "+e+" of "+n),new Promise(function(e,n){var i=r.formData?o.createFormDataUpload(t,r):o.createBareUpload(t,r),s=o.createProgressTimeout(r.timeout,function(e){a.abort(),o.uppy.emit("upload-error",t,e),n(e)}),a=new XMLHttpRequest;""!==r.responseType&&(a.responseType=r.responseType);var l=_();a.upload.addEventListener("loadstart",function(t){o.uppy.log("[XHRUpload] "+l+" started"),s.progress()}),a.upload.addEventListener("progress",function(e){o.uppy.log("[XHRUpload] "+l+" progress: "+e.loaded+" / "+e.total),s.progress(),e.lengthComputable&&o.uppy.emit("upload-progress",t,{uploader:o,bytesUploaded:e.loaded,bytesTotal:e.total})}),a.addEventListener("load",function(i){if(o.uppy.log("[XHRUpload] "+l+" finished"),s.done(),i.target.status>=200&&i.target.status<300){var u=r.getResponseData(a.responseText,a),p=u[r.responseUrlFieldName],c={status:i.target.status,body:u,uploadURL:p};return o.uppy.setFileState(t.id,{response:c}),o.uppy.emit("upload-success",t,u,p),p&&o.uppy.log("Download "+t.name+" from "+t.uploadURL),e(t)}var f=r.getResponseData(a.responseText,a),d=Pt(a,r.getResponseError(a.responseText,a)),h={status:i.target.status,body:f};return o.uppy.setFileState(t.id,{response:h}),o.uppy.emit("upload-error",t,d),n(d)}),a.addEventListener("error",function(e){o.uppy.log("[XHRUpload] "+l+" errored"),s.done();var i=Pt(a,r.getResponseError(a.responseText,a));return o.uppy.emit("upload-error",t,i),n(i)}),a.open(r.method.toUpperCase(),r.endpoint,!0),a.withCredentials=r.withCredentials,Object.keys(r.headers).forEach(function(t){a.setRequestHeader(t,r.headers[t])}),a.send(i),o.uppy.on("file-removed",function(e){e.id===t.id&&(s.done(),a.abort())}),o.uppy.on("cancel-all",function(){s.done(),a.abort()})})},e.prototype.uploadRemote=function(t,e,n){var o=this,r=this.getOptions(t);return new Promise(function(e,n){var i={};(Array.isArray(r.metaFields)?r.metaFields:Object.keys(t.meta)).forEach(function(e){i[e]=t.meta[e]}),new _t(o.uppy,t.remote.providerOptions).post(t.remote.url,St({},t.remote.body,{endpoint:r.endpoint,size:t.data.size,fieldname:r.fieldName,metadata:i,headers:r.headers})).then(function(i){var s=i.token,a=lt(t.remote.serverUrl),l=new Ct({target:a+"/api/"+s});l.on("progress",function(e){return at(o,e,t)}),l.on("success",function(n){var i=r.getResponseData(n.response.responseText,n.response),s=i[r.responseUrlFieldName];return o.uppy.emit("upload-success",t,i,s),l.close(),e()}),l.on("error",function(e){var i=e.response,s=i?r.getResponseError(i.responseText,i):St(new Error(e.error.message),{cause:e.error});o.uppy.emit("upload-error",t,s),n(s)})})})},e.prototype.uploadBundle=function(t){var e=this;return new Promise(function(n,o){var r=e.opts.endpoint,i=e.opts.method,s=new FormData;t.forEach(function(t,n){var o=e.getOptions(t);s.append(o.fieldName,t.data)});var a=new XMLHttpRequest;""!==e.opts.responseType&&(a.responseType=e.opts.responseType);var l=e.createProgressTimeout(e.opts.timeout,function(t){a.abort(),u(t),o(t)}),u=function(n){t.forEach(function(t){e.uppy.emit("upload-error",t,n)})};a.upload.addEventListener("loadstart",function(t){e.uppy.log("[XHRUpload] started uploading bundle"),l.progress()}),a.upload.addEventListener("progress",function(n){l.progress(),n.lengthComputable&&t.forEach(function(t){e.uppy.emit("upload-progress",t,{uploader:e,bytesUploaded:n.loaded/n.total*t.size,bytesTotal:t.size})})}),a.addEventListener("load",function(r){if(l.done(),r.target.status>=200&&r.target.status<300){var i=e.opts.getResponseData(a.responseText,a);return t.forEach(function(t){e.uppy.emit("upload-success",t,i)}),n()}var s=e.opts.getResponseError(a.responseText,a)||new Error("Upload error");return s.request=a,u(s),o(s)}),a.addEventListener("error",function(t){l.done();var n=e.opts.getResponseError(a.responseText,a)||new Error("Upload error");return u(n),o(n)}),e.uppy.on("cancel-all",function(){l.done(),a.abort()}),a.open(i.toUpperCase(),r,!0),a.withCredentials=e.opts.withCredentials,Object.keys(e.opts.headers).forEach(function(t){a.setRequestHeader(t,e.opts.headers[t])}),a.send(s),t.forEach(function(t){e.uppy.emit("upload-started",t)})})},e.prototype.uploadFiles=function(t){var e=this,n=t.map(function(n,o){var r=parseInt(o,10)+1,i=t.length;return n.error?function(){return Promise.reject(new Error(n.error))}:n.isRemote?(e.uppy.emit("upload-started",n),e.uploadRemote.bind(e,n,r,i)):(e.uppy.emit("upload-started",n),e.upload.bind(e,n,r,i))}).map(function(t){return e.limitUploads(t)()});return bt(n)},e.prototype.handleUpload=function(t){var e=this;if(0===t.length)return this.uppy.log("[XHRUpload] No files to upload!"),Promise.resolve();this.uppy.log("[XHRUpload] Uploading...");var n=t.map(function(t){return e.uppy.getFile(t)});return this.opts.bundle?this.uploadBundle(n):this.uploadFiles(n).then(function(){return null})},e.prototype.install=function(){this.opts.bundle&&this.uppy.setState({capabilities:St({},this.uppy.getState().capabilities,{bundled:!0})}),this.uppy.addUploader(this.handleUpload)},e.prototype.uninstall=function(){this.opts.bundle&&this.uppy.setState({capabilities:St({},this.uppy.getState().capabilities,{bundled:!0})}),this.uppy.removeUploader(this.handleUpload)},e}(Z.Plugin),Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kt="function"==typeof Symbol&&"symbol"===Ft(Symbol.iterator)?function(t){return void 0===t?"undefined":Ft(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":Ft(t)},Ot=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Tt=m.RequestClient;function At(t){var e=t.headers?t.headers["content-type"]:t.getResponseHeader("Content-Type");return"string"==typeof e&&"application/xml"===e.toLowerCase()}function Ut(t,e){var n=t.indexOf("<"+e+">"),o=t.indexOf("</"+e+">",n);return-1!==n&&-1!==o?t.slice(n+e.length+2,o):""}function xt(t){if(t&&t.error){var e=new Error(t.message);throw Ot(e,t.error),e}return t}var Rt,Dt,jt,Bt=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Ft(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));r.type="uploader",r.id="AwsS3",r.title="AWS S3";var i={strings:{preparingUpload:"Preparing upload..."}},s={timeout:3e4,limit:0,getUploadParameters:r.getUploadParameters.bind(r),locale:i};return r.opts=Ot({},s,o),r.translator=new G([i,r.uppy.locale,r.opts.locale]),r.i18n=r.translator.translate.bind(r.translator),r.i18nArray=r.translator.translateArray.bind(r.translator),r.client=new Tt(n,o),r.prepareUpload=r.prepareUpload.bind(r),"number"==typeof r.opts.limit&&0!==r.opts.limit?r.limitRequests=ut(r.opts.limit):r.limitRequests=function(t){return t},r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Ft(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getUploadParameters=function(t){if(!this.opts.serverUrl)throw new Error("Expected a `serverUrl` option containing a Companion address.");var e=encodeURIComponent(t.name),n=encodeURIComponent(t.type);return this.client.get("s3/params?filename="+e+"&type="+n).then(xt)},e.prototype.validateParameters=function(t,e){if("object"!==(void 0===e?"undefined":kt(e))||!e||"string"!=typeof e.url||"object"!==kt(e.fields)&&null!=e.fields||null!=e.method&&!/^(put|post)$/i.test(e.method)){var n=new TypeError("AwsS3: got incorrect result from 'getUploadParameters()' for file '"+t.name+"', expected an object '{ url, method, fields, headers }'.\nSee https://uppy.io/docs/aws-s3/#getUploadParameters-file for more on the expected format.");throw console.error(n),n}return e},e.prototype.prepareUpload=function(t){var e=this;t.forEach(function(t){var n=e.uppy.getFile(t);e.uppy.emit("preprocess-progress",n,{mode:"determinate",message:e.i18n("preparingUpload"),value:0})});var n=this.limitRequests(this.opts.getUploadParameters);return Promise.all(t.map(function(t){var o=e.uppy.getFile(t);return Promise.resolve().then(function(){return n(o)}).then(function(t){return e.validateParameters(o,t)}).then(function(t){return e.uppy.emit("preprocess-progress",o,{mode:"determinate",message:e.i18n("preparingUpload"),value:1}),t}).catch(function(t){e.uppy.emit("upload-error",o,t)})})).then(function(n){var o={};t.forEach(function(t,r){var i=e.uppy.getFile(t);if(!i.error){var s=n[r],a=s.method,l=void 0===a?"post":a,u=s.url,p=s.fields,c=s.headers,f={method:l,formData:"post"===l.toLowerCase(),endpoint:u,metaFields:Object.keys(p)};c&&(f.headers=c);var d=Ot({},i,{meta:Ot({},i.meta,p),xhrUpload:f});o[t]=d}}),e.uppy.setState({files:Ot({},e.uppy.getState().files,o)}),t.forEach(function(t){var n=e.uppy.getFile(t);e.uppy.emit("preprocess-complete",n)})})},e.prototype.install=function(){var t=this.uppy.log;this.uppy.addPreProcessor(this.prepareUpload);var e=!1;this.uppy.use(Et,{fieldName:"file",responseUrlFieldName:"location",timeout:this.opts.timeout,limit:this.opts.limit,responseType:"text",getResponseData:function(n,o){return At(o)?{location:vt(o.responseURL,Ut(n,"Location")),bucket:Ut(n,"Bucket"),key:Ut(n,"Key"),etag:Ut(n,"ETag")}:"POST"===this.method.toUpperCase()?(e||(t("[AwsS3] No response data found, make sure to set the success_action_status AWS SDK option to 201. See https://uppy.io/docs/aws-s3/#POST-Uploads","warning"),e=!0),{location:null}):o.responseURL?{location:o.responseURL.replace(/\?.*$/,"")}:{location:null}},getResponseError:function(t,e){if(At(e)){var n=Ut(t,"Message");return new Error(n)}}})},e.prototype.uninstall=function(){var t=this.uppy.getPlugin("XHRUpload");this.uppy.removePlugin(t),this.uppy.removePreProcessor(this.prepareUpload)},e}(Z.Plugin),It=function(t,e){return(e="number"==typeof e?e:1/0)?function t(n,o){return n.reduce(function(n,r){return Array.isArray(r)&&o<e?n.concat(t(r,o+1)):n.concat(r)},[])}(t,1):Array.isArray(t)?t.map(function(t){return t}):t},Mt=Rt={};function Lt(){throw new Error("setTimeout has not been defined")}function Nt(){throw new Error("clearTimeout has not been defined")}function zt(t){if(Dt===setTimeout)return setTimeout(t,0);if((Dt===Lt||!Dt)&&setTimeout)return Dt=setTimeout,setTimeout(t,0);try{return Dt(t,0)}catch(e){try{return Dt.call(null,t,0)}catch(e){return Dt.call(this,t,0)}}}!function(){try{Dt="function"==typeof setTimeout?setTimeout:Lt}catch(t){Dt=Lt}try{jt="function"==typeof clearTimeout?clearTimeout:Nt}catch(t){jt=Nt}}();var qt,Ht=[],Wt=!1,Xt=-1;function Vt(){Wt&&qt&&(Wt=!1,qt.length?Ht=qt.concat(Ht):Xt=-1,Ht.length&&Gt())}function Gt(){if(!Wt){var t=zt(Vt);Wt=!0;for(var e=Ht.length;e;){for(qt=Ht,Ht=[];++Xt<e;)qt&&qt[Xt].run();Xt=-1,e=Ht.length}qt=null,Wt=!1,function(t){if(jt===clearTimeout)return clearTimeout(t);if((jt===Nt||!jt)&&clearTimeout)return jt=clearTimeout,clearTimeout(t);try{jt(t)}catch(e){try{return jt.call(null,t)}catch(e){return jt.call(this,t)}}}(t)}}function $t(t,e){this.fun=t,this.array=e}function Kt(){}Mt.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];Ht.push(new $t(t,e)),1!==Ht.length||Wt||zt(Gt)},$t.prototype.run=function(){this.fun.apply(null,this.array)},Mt.title="browser",Mt.browser=!0,Mt.env={},Mt.argv=[],Mt.version="",Mt.versions={},Mt.on=Kt,Mt.addListener=Kt,Mt.once=Kt,Mt.off=Kt,Mt.removeListener=Kt,Mt.removeAllListeners=Kt,Mt.emit=Kt,Mt.prependListener=Kt,Mt.prependOnceListener=Kt,Mt.listeners=function(t){return[]},Mt.binding=function(t){throw new Error("process.binding is not supported")},Mt.cwd=function(){return"/"},Mt.chdir=function(t){throw new Error("process.chdir is not supported")},Mt.umask=function(){return 0};var Yt={};(function(t){Yt=function(e,n){var o,r,i,s=!0;function a(e){function r(){n&&n(e,o),n=null}s?t.nextTick(r):r()}function l(t,e,n){o[t]=n,(0==--r||e)&&a(e)}Array.isArray(e)?(o=[],r=e.length):(i=Object.keys(e),o={},r=i.length),r?i?i.forEach(function(t){e[t](function(e,n){l(t,e,n)})}):e.forEach(function(t,e){t(function(t,n){l(e,t,n)})}):a(null),s=!1}}).call(this,Rt);var Jt=function(t,e){if("string"==typeof t){var n=t;if(!(t=window.document.querySelector(t)))throw new Error('"'+n+'" does not match any HTML elements')}if(!t)throw new Error('"'+t+'" is not a valid HTML element');var o;return"function"==typeof e&&(e={onDrop:e}),t.addEventListener("dragenter",r,!1),t.addEventListener("dragover",i,!1),t.addEventListener("dragleave",s,!1),t.addEventListener("drop",a,!1),function(){l(),t.removeEventListener("dragenter",r,!1),t.removeEventListener("dragover",i,!1),t.removeEventListener("dragleave",s,!1),t.removeEventListener("drop",a,!1)};function r(t){return e.onDragEnter&&e.onDragEnter(t),t.stopPropagation(),t.preventDefault(),!1}function i(n){if(n.stopPropagation(),n.preventDefault(),n.dataTransfer.items){var r=Zt(n.dataTransfer.items),i=r.filter(function(t){return"file"===t.kind}),s=r.filter(function(t){return"string"===t.kind});if(0===i.length&&!e.onDropText)return;if(0===s.length&&!e.onDrop)return;if(0===i.length&&0===s.length)return}return t.classList.add("drag"),clearTimeout(o),e.onDragOver&&e.onDragOver(n),n.dataTransfer.dropEffect="copy",!1}function s(t){return t.stopPropagation(),t.preventDefault(),e.onDragLeave&&e.onDragLeave(t),clearTimeout(o),o=setTimeout(l,50),!1}function a(t){t.stopPropagation(),t.preventDefault(),e.onDragLeave&&e.onDragLeave(t),clearTimeout(o),l();var n={x:t.clientX,y:t.clientY},r=t.dataTransfer.getData("text");if(r&&e.onDropText&&e.onDropText(r,n),t.dataTransfer.items){var i=Zt(t.dataTransfer.items).filter(function(t){return"file"===t.kind});if(0===i.length)return;Yt(i.map(function(t){return function(e){!function(t,e){var n=[];if(t.isFile)t.file(function(n){n.fullPath=t.fullPath,e(null,n)},function(t){e(t)});else if(t.isDirectory){var o=t.createReader();!function t(){o.readEntries(function(o){o.length>0?(n=n.concat(Zt(o)),t()):Yt(n.map(function(t){return function(e){!function(t,e){var n=[];if(t.isFile)t.file(function(n){n.fullPath=t.fullPath,e(null,n)},function(t){e(t)});else if(t.isDirectory){var o=t.createReader();!function t(){o.readEntries(function(o){o.length>0?(n=n.concat(Zt(o)),t()):Yt(n.map(function(t){return function(e){Qt(t,e)}}),e)})}()}}(t,e)}}),e)})}()}}(t.webkitGetAsEntry(),e)}}),function(t,o){if(t)throw t;e.onDrop&&e.onDrop(It(o),n)})}else{var s=Zt(t.dataTransfer.files);if(0===s.length)return;s.forEach(function(t){t.fullPath="/"+t.name}),e.onDrop&&e.onDrop(s,n)}return!1}function l(){t.classList.remove("drag")}};function Qt(t,e){var n=[];if(t.isFile){t.file(function(n){n.fullPath=t.fullPath;e(null,n)},function(t){e(t)})}else if(t.isDirectory){var o=t.createReader();r()}function r(){o.readEntries(function(t){if(t.length>0){n=n.concat(Zt(t));r()}else{i()}})}function i(){Yt(n.map(function(t){return function(e){Qt(t,e)}}),e)}}function Zt(t){return Array.prototype.slice.call(t||[],0)}var te={exports:{}};(function(t){!function(t,e){"object"==typeof te.exports?te.exports=e():t.ResizeObserver=e()}(this,function(){"use strict";var e=function(){if("undefined"!=typeof Map)return Map;function t(t,e){var n=-1;return t.some(function(t,o){return t[0]===e&&(n=o,!0)}),n}return function(){function e(){this.__entries__=[]}var n={size:{configurable:!0}};return n.size.get=function(){return this.__entries__.length},e.prototype.get=function(e){var n=t(this.__entries__,e),o=this.__entries__[n];return o&&o[1]},e.prototype.set=function(e,n){var o=t(this.__entries__,e);~o?this.__entries__[o][1]=n:this.__entries__.push([e,n])},e.prototype.delete=function(e){var n=this.__entries__,o=t(n,e);~o&&n.splice(o,1)},e.prototype.has=function(e){return!!~t(this.__entries__,e)},e.prototype.clear=function(){this.__entries__.splice(0)},e.prototype.forEach=function(t,e){void 0===e&&(e=null);for(var n=0,o=this.__entries__;n<o.length;n+=1){var r=o[n];t.call(e,r[1],r[0])}},Object.defineProperties(e.prototype,n),e}()}(),n="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,o=void 0!==t&&t.Math===Math?t:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),r="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(o):function(t){return setTimeout(function(){return t(Date.now())},1e3/60)},i=2,s=["top","right","bottom","left","width","height","size","weight"],a="undefined"!=typeof MutationObserver,l=function(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(t,e){var n=!1,o=!1,s=0;function a(){n&&(n=!1,t()),o&&u()}function l(){r(a)}function u(){var t=Date.now();if(n){if(t-s<i)return;o=!0}else n=!0,o=!1,setTimeout(l,e);s=t}return u}(this.refresh.bind(this),20)};l.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},l.prototype.removeObserver=function(t){var e=this.observers_,n=e.indexOf(t);~n&&e.splice(n,1),!e.length&&this.connected_&&this.disconnect_()},l.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},l.prototype.updateObservers_=function(){var t=this.observers_.filter(function(t){return t.gatherActive(),t.hasActive()});return t.forEach(function(t){return t.broadcastActive()}),t.length>0},l.prototype.connect_=function(){n&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),a?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},l.prototype.disconnect_=function(){n&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},l.prototype.onTransitionEnd_=function(t){var e=t.propertyName;void 0===e&&(e=""),s.some(function(t){return!!~e.indexOf(t)})&&this.refresh()},l.getInstance=function(){return this.instance_||(this.instance_=new l),this.instance_},l.instance_=null;var u=function(t,e){for(var n=0,o=Object.keys(e);n<o.length;n+=1){var r=o[n];Object.defineProperty(t,r,{value:e[r],enumerable:!1,writable:!1,configurable:!0})}return t},p=function(t){return t&&t.ownerDocument&&t.ownerDocument.defaultView||o},c=m(0,0,0,0);function f(t){return parseFloat(t)||0}function d(t){for(var e=[],n=arguments.length-1;n-- >0;)e[n]=arguments[n+1];return e.reduce(function(e,n){return e+f(t["border-"+n+"-width"])},0)}var h="undefined"!=typeof SVGGraphicsElement?function(t){return t instanceof p(t).SVGGraphicsElement}:function(t){return t instanceof p(t).SVGElement&&"function"==typeof t.getBBox};function y(t){return n?h(t)?function(t){var e=t.getBBox();return m(0,0,e.width,e.height)}(t):function(t){var e=t.clientWidth,n=t.clientHeight;if(!e&&!n)return c;var o=p(t).getComputedStyle(t),r=function(t){for(var e={},n=0,o=["top","right","bottom","left"];n<o.length;n+=1){var r=o[n],i=t["padding-"+r];e[r]=f(i)}return e}(o),i=r.left+r.right,s=r.top+r.bottom,a=f(o.width),l=f(o.height);if("border-box"===o.boxSizing&&(Math.round(a+i)!==e&&(a-=d(o,"left","right")+i),Math.round(l+s)!==n&&(l-=d(o,"top","bottom")+s)),!function(t){return t===p(t).document.documentElement}(t)){var u=Math.round(a+i)-e,h=Math.round(l+s)-n;1!==Math.abs(u)&&(a-=u),1!==Math.abs(h)&&(l-=h)}return m(r.left,r.top,a,l)}(t):c}function m(t,e,n,o){return{x:t,y:e,width:n,height:o}}var g=function(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=m(0,0,0,0),this.target=t};g.prototype.isActive=function(){var t=y(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},g.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t};var v=function(t,e){var n,o,r,i,s,a,l,p=(o=(n=e).x,r=n.y,i=n.width,s=n.height,a="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,l=Object.create(a.prototype),u(l,{x:o,y:r,width:i,height:s,top:r,right:o+i,bottom:s+r,left:o}),l);u(this,{target:t,contentRect:p})},b=function(t,n,o){if(this.activeObservations_=[],this.observations_=new e,"function"!=typeof t)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=n,this.callbackCtx_=o};b.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof p(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)||(e.set(t,new g(t)),this.controller_.addObserver(this),this.controller_.refresh())}},b.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(t instanceof p(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var e=this.observations_;e.has(t)&&(e.delete(t),e.size||this.controller_.removeObserver(this))}},b.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},b.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(e){e.isActive()&&t.activeObservations_.push(e)})},b.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,e=this.activeObservations_.map(function(t){return new v(t.target,t.broadcastRect())});this.callback_.call(t,e,t),this.clearActive()}},b.prototype.clearActive=function(){this.activeObservations_.splice(0)},b.prototype.hasActive=function(){return this.activeObservations_.length>0};var w="undefined"!=typeof WeakMap?new WeakMap:new e,S=function(t){if(!(this instanceof S))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var e=l.getInstance(),n=new b(t,e,this);w.set(this,n)};return["observe","unobserve","disconnect"].forEach(function(t){S.prototype[t]=function(){return(e=w.get(this))[t].apply(e,arguments);var e}}),void 0!==o.ResizeObserver?o.ResizeObserver:S})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{}),te=te.exports;var ee={exports:{}};!function(){"use strict";var t={}.hasOwnProperty;function e(){for(var n=[],o=0;o<arguments.length;o++){var r=arguments[o];if(r){var i=typeof r;if("string"===i||"number"===i)n.push(r);else if(Array.isArray(r)&&r.length){var s=e.apply(null,r);s&&n.push(s)}else if("object"===i)for(var a in r)t.call(r,a)&&r[a]&&n.push(a)}}return n.join(" ")}ee.exports?(e.default=e,ee.exports=e):window.classNames=e}(),ee=ee.exports;var ne,oe={exports:{}};ne=function(t){"use strict";function e(t){return t.attributes&&t.attributes.key}function n(t){return t.base}function o(t){return t&&t.filter(function(t){return null!==t})}function r(t,e){for(var n=t.length;n--;)if(e(t[n]))return!0;return!1}function i(t,n){return r(t,function(t){return e(t)===n})}function s(t,n){return i(t,e(n))}function a(t,n,o){return r(t,function(t){return e(t)===n&&t.props[o]})}function l(t,n,o){return a(t,e(n),o)}var u=" ",p=/[\n\t\r]+/g,c=function(t){return(u+t+u).replace(p,u)};function f(t,e){var n;t.classList?(n=t.classList).add.apply(n,e.split(" ")):t.className+=" "+e}function d(t,e){if(e=e.trim(),t.classList){var n;(n=t.classList).remove.apply(n,e.split(" "))}else{var o=t.className.trim(),r=c(o);for(e=u+e+u;r.indexOf(e)>=0;)r=r.replace(e,u);t.className=r.trim()}}var h={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},y=[];"undefined"!=typeof window&&function(){var t=document.createElement("div").style;for(var e in"AnimationEvent"in window||delete h.animationend.animation,"TransitionEvent"in window||delete h.transitionend.transition,h){var n=h[e];for(var o in n)if(o in t){y.push(n[o]);break}}}();var m=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},g=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},v=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},b=function(t){function e(){var o,r;m(this,e);for(var i=arguments.length,s=Array(i),a=0;a<i;a++)s[a]=arguments[a];return o=r=v(this,t.call.apply(t,[this].concat(s))),r.flushClassNameQueue=function(){n(r)&&f(n(r),r.classNameQueue.join(" ")),r.classNameQueue.length=0,r.timeout=null},v(r,o)}return g(e,t),e.prototype.transition=function(t,e,o){var r=this,i=n(this),s=this.props.name[t]||this.props.name+"-"+t,a=this.props.name[t+"Active"]||s+"-active",l=null;this.endListener&&this.endListener(),this.endListener=function(t){t&&t.target!==i||(clearTimeout(l),d(i,s),d(i,a),function(t,e){y.length&&y.forEach(function(n){t.removeEventListener(n,e,!1)})}(i,r.endListener),r.endListener=null,e&&e())},o?(l=setTimeout(this.endListener,o),this.transitionTimeouts.push(l)):function(t,e){if(!y.length)return window.setTimeout(e,0);y.forEach(function(n){t.addEventListener(n,e,!1)})}(i,this.endListener),f(i,s),this.queueClass(a)},e.prototype.queueClass=function(t){this.classNameQueue.push(t),this.timeout||(this.timeout=setTimeout(this.flushClassNameQueue,17))},e.prototype.stop=function(){this.timeout&&(clearTimeout(this.timeout),this.classNameQueue.length=0,this.timeout=null),this.endListener&&this.endListener()},e.prototype.componentWillMount=function(){this.classNameQueue=[],this.transitionTimeouts=[]},e.prototype.componentWillUnmount=function(){this.timeout&&clearTimeout(this.timeout),this.transitionTimeouts.forEach(function(t){clearTimeout(t)})},e.prototype.componentWillEnter=function(t){this.props.enter?this.transition("enter",t,this.props.enterTimeout):t()},e.prototype.componentWillLeave=function(t){this.props.leave?this.transition("leave",t,this.props.leaveTimeout):t()},e.prototype.render=function(){return(t=this.props.children)&&t[0];var t},e}(t.Component),w=function(n){function r(o){m(this,r);var i=v(this,n.call(this));return i.renderChild=function(n){var o=i.props,r=o.transitionName,s=o.transitionEnter,a=o.transitionLeave,l=o.transitionEnterTimeout,u=o.transitionLeaveTimeout,p=e(n);return t.h(b,{key:p,ref:function(t){(i.refs[p]=t)||(n=null)},name:r,enter:s,leave:a,enterTimeout:l,leaveTimeout:u},n)},i.refs={},i.state={children:(o.children||[]).slice()},i}return g(r,n),r.prototype.shouldComponentUpdate=function(t,e){return e.children!==this.state.children},r.prototype.componentWillMount=function(){this.currentlyTransitioningKeys={},this.keysToEnter=[],this.keysToLeave=[]},r.prototype.componentWillReceiveProps=function(n){var r,a,u,p,c=this,f=n.children,d=n.exclusive,h=n.showProp,y=o(f||[]).slice(),m=o(d?this.props.children:this.state.children),g=(r=y,a=[],u={},p=[],m.forEach(function(t){var n=e(t);i(r,n)?p.length&&(u[n]=p,p=[]):p.push(t)}),r.forEach(function(t){var n=e(t);u.hasOwnProperty(n)&&(a=a.concat(u[n])),a.push(t)}),a.concat(p));h&&(g=g.map(function(e){var n;return!e.props[h]&&l(m,e,h)&&(e=t.cloneElement(e,((n={})[h]=!0,n))),e})),d&&g.forEach(function(t){return c.stop(e(t))}),this.setState({children:g}),this.forceUpdate(),y.forEach(function(t){var e=t.key,n=m&&s(m,t);if(h){if(n){var o=l(m,t,h),r=t.props[h];o||!r||c.currentlyTransitioningKeys[e]||c.keysToEnter.push(e)}}else n||c.currentlyTransitioningKeys[e]||c.keysToEnter.push(e)}),m.forEach(function(t){var e=t.key,n=y&&s(y,t);if(h){if(n){var o=l(y,t,h),r=t.props[h];o||!r||c.currentlyTransitioningKeys[e]||c.keysToLeave.push(e)}}else n||c.currentlyTransitioningKeys[e]||c.keysToLeave.push(e)})},r.prototype.performEnter=function(t){var e=this;this.currentlyTransitioningKeys[t]=!0;var n=this.refs[t];n.componentWillEnter?n.componentWillEnter(function(){return e._handleDoneEntering(t)}):this._handleDoneEntering(t)},r.prototype._handleDoneEntering=function(t){delete this.currentlyTransitioningKeys[t];var e=o(this.props.children),n=this.props.showProp;!e||!n&&!i(e,t)||n&&!a(e,t,n)?this.performLeave(t):this.setState({children:e})},r.prototype.stop=function(t){delete this.currentlyTransitioningKeys[t];var e=this.refs[t];e&&e.stop()},r.prototype.performLeave=function(t){var e=this;this.currentlyTransitioningKeys[t]=!0;var n=this.refs[t];n&&n.componentWillLeave?n.componentWillLeave(function(){return e._handleDoneLeaving(t)}):this._handleDoneLeaving(t)},r.prototype._handleDoneLeaving=function(t){delete this.currentlyTransitioningKeys[t];var e=this.props.showProp,n=o(this.props.children);e&&n&&a(n,t,e)?this.performEnter(t):!e&&n&&i(n,t)?this.performEnter(t):this.setState({children:n})},r.prototype.componentDidUpdate=function(){var t=this,e=this.keysToEnter,n=this.keysToLeave;this.keysToEnter=[],e.forEach(function(e){return t.performEnter(e)}),this.keysToLeave=[],n.forEach(function(e){return t.performLeave(e)})},r.prototype.render=function(e,n){var r=e.component,i=(e.transitionName,e.transitionEnter,e.transitionLeave,e.transitionEnterTimeout,e.transitionLeaveTimeout,e.children,function(t,e){var n={};for(var o in t)e.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(t,o)&&(n[o]=t[o]);return n}(e,["component","transitionName","transitionEnter","transitionLeave","transitionEnterTimeout","transitionLeaveTimeout","children"])),s=n.children;return t.h(r,i,o(s).map(this.renderChild))},r}(t.Component);return w.defaultProps={component:"span",transitionEnter:!0,transitionLeave:!0},w},"object"==typeof oe.exports?oe.exports=ne(D):this.PreactCSSTransitionGroup=ne(this.preact),oe=oe.exports;var re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ie=D.h,se=function(t){function e(n){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":re(e))&&"function"!=typeof e?t:e}(this,t.call(this,n));return o.handleClick=o.handleClick.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":re(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleClick=function(t){this.input.click()},e.prototype.render=function(){var t=this,e=ie("button",{type:"button",class:"uppy-Dashboard-browse",onclick:this.handleClick},this.props.i18n("browse"));return ie("div",{class:"uppy-Dashboard-dropFilesTitle"},0===this.props.acquirers.length?this.props.i18nArray("dropPaste",{browse:e}):this.props.i18nArray("dropPasteImport",{browse:e}),ie("input",{class:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabindex:-1,type:"file",name:"files[]",multiple:1!==this.props.maxNumberOfFiles,onchange:this.props.handleInputChange,accept:this.props.allowedFileTypes,value:"",ref:function(e){t.input=e}}))},e}(D.Component),ae=D.h,le=function(){return ae("svg",{"aria-hidden":"true",width:"30",height:"30",viewBox:"0 0 30 30"},ae("path",{d:"M15 30c8.284 0 15-6.716 15-15 0-8.284-6.716-15-15-15C6.716 0 0 6.716 0 15c0 8.284 6.716 15 15 15zm4.258-12.676v6.846h-8.426v-6.846H5.204l9.82-12.364 9.82 12.364H19.26z"}))},ue=function(){return ae("svg",{"aria-hidden":"true",class:"UppyIcon",width:"51",height:"51",viewBox:"0 0 51 51"},ae("path",{d:"M17.21 45.765a5.394 5.394 0 0 1-7.62 0l-4.12-4.122a5.393 5.393 0 0 1 0-7.618l6.774-6.775-2.404-2.404-6.775 6.776c-3.424 3.427-3.424 9 0 12.426l4.12 4.123a8.766 8.766 0 0 0 6.216 2.57c2.25 0 4.5-.858 6.214-2.57l13.55-13.552a8.72 8.72 0 0 0 2.575-6.213 8.73 8.73 0 0 0-2.575-6.213l-4.123-4.12-2.404 2.404 4.123 4.12a5.352 5.352 0 0 1 1.58 3.81c0 1.438-.562 2.79-1.58 3.808l-13.55 13.55z"}),ae("path",{d:"M44.256 2.858A8.728 8.728 0 0 0 38.043.283h-.002a8.73 8.73 0 0 0-6.212 2.574l-13.55 13.55a8.725 8.725 0 0 0-2.575 6.214 8.73 8.73 0 0 0 2.574 6.216l4.12 4.12 2.405-2.403-4.12-4.12a5.357 5.357 0 0 1-1.58-3.812c0-1.437.562-2.79 1.58-3.808l13.55-13.55a5.348 5.348 0 0 1 3.81-1.58c1.44 0 2.792.562 3.81 1.58l4.12 4.12c2.1 2.1 2.1 5.518 0 7.617L39.2 23.775l2.404 2.404 6.775-6.777c3.426-3.427 3.426-9 0-12.426l-4.12-4.12z"}))},pe=function(){return ae("svg",{"aria-hidden":"true",class:"UppyIcon retry",width:"28",height:"31",viewBox:"0 0 16 19",xmlns:"http://www.w3.org/2000/svg"},ae("path",{d:"M16 11a8 8 0 1 1-8-8v2a6 6 0 1 0 6 6h2z"}),ae("path",{d:"M7.9 3H10v2H7.9z"}),ae("path",{d:"M8.536.5l3.535 3.536-1.414 1.414L7.12 1.914z"}),ae("path",{d:"M10.657 2.621l1.414 1.415L8.536 7.57 7.12 6.157z"}))},ce=function(){return ae("svg",{"aria-hidden":"true",fill:"#607d8b",width:"27",height:"25",viewBox:"0 0 27 25"},ae("path",{d:"M5.586 9.288a.313.313 0 0 0 .282.176h4.84v3.922c0 1.514 1.25 2.24 2.792 2.24 1.54 0 2.79-.726 2.79-2.24V9.464h4.84c.122 0 .23-.068.284-.176a.304.304 0 0 0-.046-.324L13.735.106a.316.316 0 0 0-.472 0l-7.63 8.857a.302.302 0 0 0-.047.325z"}),ae("path",{d:"M24.3 5.093c-.218-.76-.54-1.187-1.208-1.187h-4.856l1.018 1.18h3.948l2.043 11.038h-7.193v2.728H9.114v-2.725h-7.36l2.66-11.04h3.33l1.018-1.18H3.907c-.668 0-1.06.46-1.21 1.186L0 16.456v7.062C0 24.338.676 25 1.51 25h23.98c.833 0 1.51-.663 1.51-1.482v-7.062L24.3 5.093z"}))},fe=function(){return ae("svg",{"aria-hidden":"true",class:"UppyIcon",width:"55",height:"55",viewBox:"0 0 55 55"},ae("path",{d:"M52.66.25c-.216-.19-.5-.276-.79-.242l-31 4.01a1 1 0 0 0-.87.992V40.622C18.174 38.428 15.273 37 12 37c-5.514 0-10 4.037-10 9s4.486 9 10 9 10-4.037 10-9c0-.232-.02-.46-.04-.687.014-.065.04-.124.04-.192V16.12l29-3.753v18.257C49.174 28.428 46.273 27 43 27c-5.514 0-10 4.037-10 9s4.486 9 10 9c5.464 0 9.913-3.966 9.993-8.867 0-.013.007-.024.007-.037V1a.998.998 0 0 0-.34-.75zM12 53c-4.41 0-8-3.14-8-7s3.59-7 8-7 8 3.14 8 7-3.59 7-8 7zm31-10c-4.41 0-8-3.14-8-7s3.59-7 8-7 8 3.14 8 7-3.59 7-8 7zM22 14.1V5.89l29-3.753v8.21l-29 3.754z"}))},de=function(){return ae("svg",{"aria-hidden":"true",class:"UppyIcon",viewBox:"0 0 58 58"},ae("path",{d:"M36.537 28.156l-11-7a1.005 1.005 0 0 0-1.02-.033C24.2 21.3 24 21.635 24 22v14a1 1 0 0 0 1.537.844l11-7a1.002 1.002 0 0 0 0-1.688zM26 34.18V23.82L34.137 29 26 34.18z"}),ae("path",{d:"M57 6H1a1 1 0 0 0-1 1v44a1 1 0 0 0 1 1h56a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1zM10 28H2v-9h8v9zm-8 2h8v9H2v-9zm10 10V8h34v42H12V40zm44-12h-8v-9h8v9zm-8 2h8v9h-8v-9zm8-22v9h-8V8h8zM2 8h8v9H2V8zm0 42v-9h8v9H2zm54 0h-8v-9h8v9z"}))},he=function(){return ae("svg",{"aria-hidden":"true",class:"UppyIcon",viewBox:"0 0 342 335"},ae("path",{d:"M329.337 227.84c-2.1 1.3-8.1 2.1-11.9 2.1-12.4 0-27.6-5.7-49.1-14.9 8.3-.6 15.8-.9 22.6-.9 12.4 0 16 0 28.2 3.1 12.1 3 12.2 9.3 10.2 10.6zm-215.1 1.9c4.8-8.4 9.7-17.3 14.7-26.8 12.2-23.1 20-41.3 25.7-56.2 11.5 20.9 25.8 38.6 42.5 52.8 2.1 1.8 4.3 3.5 6.7 5.3-34.1 6.8-63.6 15-89.6 24.9zm39.8-218.9c6.8 0 10.7 17.06 11 33.16.3 16-3.4 27.2-8.1 35.6-3.9-12.4-5.7-31.8-5.7-44.5 0 0-.3-24.26 2.8-24.26zm-133.4 307.2c3.9-10.5 19.1-31.3 41.6-49.8 1.4-1.1 4.9-4.4 8.1-7.4-23.5 37.6-39.3 52.5-49.7 57.2zm315.2-112.3c-6.8-6.7-22-10.2-45-10.5-15.6-.2-34.3 1.2-54.1 3.9-8.8-5.1-17.9-10.6-25.1-17.3-19.2-18-35.2-42.9-45.2-70.3.6-2.6 1.2-4.8 1.7-7.1 0 0 10.8-61.5 7.9-82.3-.4-2.9-.6-3.7-1.4-5.9l-.9-2.5c-2.9-6.76-8.7-13.96-17.8-13.57l-5.3-.17h-.1c-10.1 0-18.4 5.17-20.5 12.84-6.6 24.3.2 60.5 12.5 107.4l-3.2 7.7c-8.8 21.4-19.8 43-29.5 62l-1.3 2.5c-10.2 20-19.5 37-27.9 51.4l-8.7 4.6c-.6.4-15.5 8.2-19 10.3-29.6 17.7-49.28 37.8-52.54 53.8-1.04 5-.26 11.5 5.01 14.6l8.4 4.2c3.63 1.8 7.53 2.7 11.43 2.7 21.1 0 45.6-26.2 79.3-85.1 39-12.7 83.4-23.3 122.3-29.1 29.6 16.7 66 28.3 89 28.3 4.1 0 7.6-.4 10.5-1.2 4.4-1.1 8.1-3.6 10.4-7.1 4.4-6.7 5.4-15.9 4.1-25.4-.3-2.8-2.6-6.3-5-8.7z"}))},ye=function(){return ae("svg",{"aria-hidden":"true",class:"UppyIcon",width:"62",height:"62",viewBox:"0 0 62 62",xmlns:"http://www.w3.org/2000/svg"},ae("path",{d:"M4.309 4.309h24.912v53.382h-6.525v3.559h16.608v-3.559h-6.525V4.309h24.912v10.676h3.559V.75H.75v14.235h3.559z","fill-rule":"nonzero",fill:"#000"}))},me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge=ce,ve=D.h,be=D.Component,we=function(t){function e(n){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":me(e))&&"function"!=typeof e?t:e}(this,t.call(this,n));return o.handleClick=o.handleClick.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":me(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleClick=function(t){this.input.click()},e.prototype.render=function(){var t=this,e=0!==this.props.acquirers.length;return ve("div",{class:"uppy-DashboarAddFiles"},e?ve("div",{class:"uppy-DashboardTabs"},ve(se,{acquirers:this.props.acquirers,handleInputChange:this.props.handleInputChange,i18n:this.props.i18n,i18nArray:this.props.i18nArray,allowedFileTypes:this.props.allowedFileTypes,maxNumberOfFiles:this.props.maxNumberOfFiles}),ve("div",{class:"uppy-DashboardTabs-list",role:"tablist"},ve("div",{class:"uppy-DashboardTab",role:"presentation"},ve("button",{type:"button",class:"uppy-DashboardTab-btn",role:"tab",tabindex:0,onclick:this.handleClick},ge(),ve("div",{class:"uppy-DashboardTab-name"},this.props.i18n("myDevice"))),ve("input",{class:"uppy-Dashboard-input",hidden:!0,"aria-hidden":"true",tabindex:-1,type:"file",name:"files[]",multiple:1!==this.props.maxNumberOfFiles,accept:this.props.allowedFileTypes,onchange:this.props.handleInputChange,value:"",ref:function(e){t.input=e}})),this.props.acquirers.map(function(e){return ve("div",{class:"uppy-DashboardTab",role:"presentation"},ve("button",{class:"uppy-DashboardTab-btn",type:"button",role:"tab",tabindex:0,"aria-controls":"uppy-DashboardContent-panel--"+e.id,"aria-selected":t.props.activePanel.id===e.id,onclick:function(){return t.props.showPanel(e.id)}},e.icon(),ve("div",{class:"uppy-DashboardTab-name"},e.name)))}))):ve("div",{class:"uppy-DashboardTabs"},ve(se,{acquirers:this.props.acquirers,handleInputChange:this.props.handleInputChange,i18n:this.props.i18n,i18nArray:this.props.i18nArray,allowedFileTypes:this.props.allowedFileTypes,maxNumberOfFiles:this.props.maxNumberOfFiles})),ve("div",{class:"uppy-DashboarAddFiles-info"},this.props.note&&ve("div",{class:"uppy-Dashboard-note"},this.props.note),this.props.proudlyDisplayPoweredByUppy&&(this.props,ve("a",{tabindex:"-1",href:"https://uppy.io",rel:"noreferrer noopener",target:"_blank",class:"uppy-Dashboard-poweredBy"},"Powered by ",ve("svg",{"aria-hidden":"true",class:"UppyIcon uppy-Dashboard-poweredByIcon",width:"11",height:"11",viewBox:"0 0 11 11",xmlns:"http://www.w3.org/2000/svg"},ve("path",{d:"M7.365 10.5l-.01-4.045h2.612L5.5.806l-4.467 5.65h2.604l.01 4.044h3.718z","fill-rule":"evenodd"})),ve("span",{class:"uppy-Dashboard-poweredByUppy"},"Uppy")))))},e}(be),Se=D.h,_e=function(t){return Se("div",{class:"uppy-Dashboard-AddFilesPanel","aria-hidden":t.showAddFilesPanel},Se("div",{class:"uppy-DashboardContent-bar"},Se("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"h1"},t.i18n("addingMoreFiles")),Se("button",{class:"uppy-DashboardContent-back",type:"button",onclick:function(e){return t.toggleAddFilesPanel(!1)}},t.i18n("back"))),Se(we,t))},Ce=ye,Pe=fe,Ee=de,Fe=he,ke=function(t){var e={color:"#cbcbcb",icon:""};if(!t)return e;var n=t.split("/")[0],o=t.split("/")[1];return"text"===n?{color:"#cbcbcb",icon:Ce()}:"audio"===n?{color:"#1abc9c",icon:Pe()}:"video"===n?{color:"#2980b9",icon:Ee()}:"application"===n&&"pdf"===o?{color:"#e74c3c",icon:Fe()}:"image"===n?{color:"#f2f2f2",icon:""}:e},Oe=D.h,Te=function(t){var e=t.file;if(e.preview)return Oe("img",{class:"uppy-DashboardItem-previewImg",alt:e.name,src:e.preview});var n=ke(e.type),o=n.color,r=n.icon;return Oe("div",{class:"uppy-DashboardItem-previewIconWrap"},Oe("span",{class:"uppy-DashboardItem-previewIcon",style:{color:o}},r),Oe("svg",{class:"uppy-DashboardItem-previewIconBg",width:"72",height:"93",viewBox:"0 0 72 93"},Oe("g",null,Oe("path",{d:"M24.08 5h38.922A2.997 2.997 0 0 1 66 8.003v74.994A2.997 2.997 0 0 1 63.004 86H8.996A2.998 2.998 0 0 1 6 83.01V22.234L24.08 5z",fill:"#FFF"}),Oe("path",{d:"M24 5L6 22.248h15.007A2.995 2.995 0 0 0 24 19.244V5z",fill:"#E4E4E4"}))))},Ae=function(t){var e=t.target.tagName;"INPUT"!==e&&"TEXTAREA"!==e?(t.preventDefault(),t.stopPropagation()):t.stopPropagation()},Ue="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xe=D.h,Re=function(t){function e(n){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Ue(e))&&"function"!=typeof e?t:e}(this,t.call(this,n));return o.meta={},o.tempStoreMetaOrSubmit=o.tempStoreMetaOrSubmit.bind(o),o.renderMetaFields=o.renderMetaFields.bind(o),o.handleSave=o.handleSave.bind(o),o.handleCancel=o.handleCancel.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Ue(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentDidMount=function(){var t=this;setTimeout(function(){t.firstInput&&t.firstInput.focus({preventScroll:!0})},150)},e.prototype.tempStoreMetaOrSubmit=function(t){var e=this.props.files[this.props.fileCardFor];if(13===t.keyCode)return t.stopPropagation(),t.preventDefault(),void this.props.saveFileCard(this.meta,e.id);var n=t.target.value,o=t.target.dataset.name;this.meta[o]=n},e.prototype.renderMetaFields=function(t){var e=this;return(this.props.metaFields||[]).map(function(n,o){return xe("fieldset",{class:"uppy-DashboardFileCard-fieldset"},xe("label",{class:"uppy-DashboardFileCard-label"},n.name),xe("input",{class:"uppy-c-textInput uppy-DashboardFileCard-input",type:"text","data-name":n.id,value:t.meta[n.id],placeholder:n.placeholder,onkeyup:e.tempStoreMetaOrSubmit,onkeydown:e.tempStoreMetaOrSubmit,onkeypress:e.tempStoreMetaOrSubmit,ref:function(t){0===o&&(e.firstInput=t)}}))})},e.prototype.handleSave=function(t){var e=this.props.fileCardFor;this.props.saveFileCard(this.meta,e)},e.prototype.handleCancel=function(t){this.meta={},this.props.toggleFileCard()},e.prototype.render=function(){var t=this.props.files[this.props.fileCardFor];return xe("div",{class:"uppy-DashboardFileCard",onDragOver:Ae,onDragLeave:Ae,onDrop:Ae,onPaste:Ae},xe("div",{class:"uppy-DashboardContent-bar"},xe("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"h1"},this.props.i18nArray("editing",{file:xe("span",{class:"uppy-DashboardContent-titleFile"},t.meta?t.meta.name:t.name)})),xe("button",{class:"uppy-DashboardContent-back",type:"button",title:this.props.i18n("finishEditingFile"),onclick:this.handleSave},this.props.i18n("done"))),xe("div",{class:"uppy-DashboardFileCard-inner"},xe("div",{class:"uppy-DashboardFileCard-preview",style:{backgroundColor:ke(t.type).color}},xe(Te,{file:t})),xe("div",{class:"uppy-DashboardFileCard-info"},this.renderMetaFields(t)),xe("div",{class:"uppy-Dashboard-actions"},xe("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Dashboard-actionsBtn",type:"button",onclick:this.handleSave},this.props.i18n("saveChanges")),xe("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-link uppy-Dashboard-actionsBtn",type:"button",onclick:this.handleCancel},this.props.i18n("cancel")))))},e}(D.Component),De=D.h,je=2*Math.PI*15,Be=function(t){return De("svg",{width:"70",height:"70",viewBox:"0 0 36 36",class:"UppyIcon UppyIcon-progressCircle"},De("g",{class:"progress-group"},De("circle",{class:"bg",r:"15",cx:"18",cy:"18","stroke-width":"2",fill:"none"}),De("circle",{class:"progress",r:"15",cx:"18",cy:"18",transform:"rotate(-90, 18, 18)","stroke-width":"2",fill:"none","stroke-dasharray":je,"stroke-dashoffset":je-je/100*t.progress})),t.hidePauseResumeCancelButtons||t.bundled?null:De("g",null,De("polygon",{class:"play",transform:"translate(3, 3)",points:"12 20 12 10 20 15"}),De("g",{class:"pause",transform:"translate(14.5, 13)"},De("rect",{x:"0",y:"0",width:"2",height:"10",rx:"0"}),De("rect",{x:"5",y:"0",width:"2",height:"10",rx:"0"})),De("polygon",{class:"cancel",transform:"translate(2, 2)",points:"19.8856516 11.0625 16 14.9481516 12.1019737 11.0625 11.0625 12.1143484 14.9481516 16 11.0625 19.8980263 12.1019737 20.9375 16 17.0518484 19.8856516 20.9375 20.9375 19.8980263 17.0518484 16 20.9375 12"})),De("polygon",{class:"check",transform:"translate(2, 3)",points:"14 22.5 7 15.2457065 8.99985857 13.1732815 14 18.3547104 22.9729883 9 25 11.1005634"}))},Ie=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Me=ue,Le=pe,Ne=D.h;function ze(t){if(!t.hideRetryButton||!t.error)return t.isUploaded||t.bundled||t.hidePauseResumeCancelButtons&&!t.error?Ne("div",{class:"uppy-DashboardItem-progressIndicator"},Ne(Be,{progress:t.file.progress.percentage,fileID:t.file.id,hidePauseResumeCancelButtons:t.hidePauseResumeCancelButtons,bundled:t.bundled})):Ne("button",{class:"uppy-DashboardItem-progressIndicator",type:"button","aria-label":t.progressIndicatorTitle,title:t.progressIndicatorTitle,onclick:t.onPauseResumeCancelRetry},t.error?t.hideRetryButton?null:Le():Ne(Be,{progress:t.file.progress.percentage,fileID:t.file.id,hidePauseResumeCancelButtons:t.hidePauseResumeCancelButtons}))}var qe=function(t){var e,n,o=t.file,r=t.acquirers,i=o.progress.preprocess||o.progress.postprocess,s=o.progress.uploadComplete&&!i&&!o.error,a=o.progress.uploadStarted||i,l=o.progress.uploadStarted&&!o.progress.uploadComplete||i,u=o.isPaused||!1,p=o.error||!1,c=K(o.meta.name).name,f=t.isWide?(n=30,(e=c).length>n?e.substr(0,n/2)+"..."+e.substr(e.length-n/4,e.length):e):c,d=ee("uppy-DashboardItem",{"is-inprogress":l},{"is-processing":i},{"is-complete":s},{"is-paused":u},{"is-error":p},{"is-resumable":t.resumableUploads},{"is-bundled":t.bundledUpload});return Ne("li",{class:d,id:"uppy_"+o.id,title:o.meta.name},Ne("div",{class:"uppy-DashboardItem-preview"},Ne("div",{class:"uppy-DashboardItem-previewInnerWrap",style:{backgroundColor:ke(o.type).color}},t.showLinkToFileUploadResult&&o.uploadURL?Ne("a",{class:"uppy-DashboardItem-previewLink",href:o.uploadURL,rel:"noreferrer noopener",target:"_blank"}):null,Ne(Te,{file:o})),Ne("div",{class:"uppy-DashboardItem-progress"},Ne(ze,Ie({progressIndicatorTitle:function(t){return s?t.i18n("uploadComplete"):p?t.i18n("retryUpload"):t.resumableUploads?o.isPaused?t.i18n("resumeUpload"):t.i18n("pauseUpload"):t.i18n("cancelUpload")}(t),onPauseResumeCancelRetry:function(e){s||(!p||t.hideRetryButton?t.hidePauseResumeCancelButtons||(t.resumableUploads?t.pauseUpload(o.id):t.cancelUpload(o.id)):t.retryUpload(o.id))},file:o,error:p},t)))),Ne("div",{class:"uppy-DashboardItem-info"},Ne("div",{class:"uppy-DashboardItem-name",title:c},t.showLinkToFileUploadResult&&o.uploadURL?Ne("a",{href:o.uploadURL,rel:"noreferrer noopener",target:"_blank"},o.extension?f+"."+o.extension:f):o.extension?f+"."+o.extension:f),Ne("div",{class:"uppy-DashboardItem-status"},o.data.size?Ne("div",{class:"uppy-DashboardItem-statusSize"},R(o.data.size)):null,o.source&&o.source!==t.id&&Ne("div",{class:"uppy-DashboardItem-sourceIcon"},r.map(function(e){if(e.id===o.source)return Ne("span",{title:t.i18n("fileSource",{name:e.name})},e.icon())})),!a&&t.metaFields&&t.metaFields.length?Ne("button",{class:"uppy-DashboardItem-edit",type:"button","aria-label":t.i18n("editFile"),title:t.i18n("editFile"),onclick:function(e){return t.toggleFileCard(o.id)}},t.i18n("edit")):null,t.showLinkToFileUploadResult&&o.uploadURL?Ne("button",{class:"uppy-DashboardItem-copyLink",type:"button","aria-label":t.i18n("copyLink"),title:t.i18n("copyLink"),onclick:function(){var e,n;(e=o.uploadURL,n=t.i18n("copyLinkToClipboardFallback"),n=n||"Copy the URL below",new Promise(function(t){var o=document.createElement("textarea");o.setAttribute("style",{position:"fixed",top:0,left:0,width:"2em",height:"2em",padding:0,border:"none",outline:"none",boxShadow:"none",background:"transparent"}),o.value=e,document.body.appendChild(o),o.select();var r=function(){document.body.removeChild(o),window.prompt(n,e),t()};try{return document.execCommand("copy")?(document.body.removeChild(o),t()):r()}catch(t){return document.body.removeChild(o),r()}})).then(function(){t.log("Link copied to clipboard."),t.info(t.i18n("copyLinkToClipboardSuccess"),"info",3e3)}).catch(t.log)}},Me()):"")),Ne("div",{class:"uppy-DashboardItem-action"},!s&&Ne("button",{class:"uppy-DashboardItem-remove",type:"button","aria-label":t.i18n("removeFile"),title:t.i18n("removeFile"),onclick:function(){return t.removeFile(o.id)}},Ne("svg",{"aria-hidden":"true",class:"UppyIcon",width:"60",height:"60",viewBox:"0 0 60 60",xmlns:"http://www.w3.org/2000/svg"},Ne("path",{stroke:"#FFF","stroke-width":"1","fill-rule":"nonzero","vector-effect":"non-scaling-stroke",d:"M30 1C14 1 1 14 1 30s13 29 29 29 29-13 29-29S46 1 30 1z"}),Ne("path",{fill:"#FFF","vector-effect":"non-scaling-stroke",d:"M42 39.667L39.667 42 30 32.333 20.333 42 18 39.667 27.667 30 18 20.333 20.333 18 30 27.667 39.667 18 42 20.333 32.333 30z"})))))},He=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},We=D.h,Xe=function(t){var e=0===t.totalFileCount,n=ee("uppy-Dashboard-files",{"uppy-Dashboard-files--noFiles":e});return We("ul",{class:n},Object.keys(t.files).map(function(e){return We(qe,He({},t,{acquirers:t.acquirers,file:t.files[e]}))}))},Ve=D.h,Ge=function(t){return Ve("div",{class:"uppy-DashboardContent-panel",role:"tabpanel",id:t.activePanel&&"uppy-DashboardContent-panel--"+t.activePanel.id,onDragOver:Ae,onDragLeave:Ae,onDrop:Ae,onPaste:Ae},Ve("div",{class:"uppy-DashboardContent-bar"},Ve("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"h1"},t.i18n("importFrom",{name:t.activePanel.name})),Ve("button",{class:"uppy-DashboardContent-back",type:"button",onclick:t.hideAllPanels},t.i18n("done"))),Ve("div",{class:"uppy-DashboardContent-panelBody"},t.getPlugin(t.activePanel.id).render(t.state)))},$e=D.h,Ke={STATE_ERROR:"error",STATE_WAITING:"waiting",STATE_PREPROCESSING:"preprocessing",STATE_UPLOADING:"uploading",STATE_POSTPROCESSING:"postprocessing",STATE_COMPLETE:"complete",STATE_PAUSED:"paused"};function Ye(t){switch(function(t,e,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};if(t)return Ke.STATE_ERROR;if(e)return Ke.STATE_COMPLETE;if(n)return Ke.STATE_PAUSED;for(var r=Ke.STATE_WAITING,i=Object.keys(o),s=0;s<i.length;s++){var a=o[i[s]].progress;if(a.uploadStarted&&!a.uploadComplete)return Ke.STATE_UPLOADING;a.preprocess&&r!==Ke.STATE_UPLOADING&&(r=Ke.STATE_PREPROCESSING),a.postprocess&&r!==Ke.STATE_UPLOADING&&r!==Ke.STATE_PREPROCESSING&&(r=Ke.STATE_POSTPROCESSING)}return r}(t.isAllErrored,t.isAllComplete,t.isAllPaused,t.files)){case"uploading":return t.i18n("uploadingXFiles",{smart_count:t.inProgressNotPausedFiles.length});case"preprocessing":case"postprocessing":return t.i18n("processingXFiles",{smart_count:t.processingFiles.length});case"paused":return t.i18n("uploadPaused");case"waiting":return t.i18n("xFilesSelected",{smart_count:t.newFiles.length});case"complete":return t.i18n("uploadComplete")}}var Je=function(t){var e=t.allowNewUpload;return e&&t.maxNumberOfFiles&&(e=t.totalFileCount<t.maxNumberOfFiles),$e("div",{class:"uppy-DashboardContent-bar"},$e("div",null,t.isAllComplete?null:$e("button",{class:"uppy-DashboardContent-back",type:"button",onclick:t.cancelAll},t.i18n("cancel"))),$e("div",{class:"uppy-DashboardContent-title",role:"heading","aria-level":"h1"},$e(Ye,t)),e&&$e("button",{class:"uppy-DashboardContent-addMore",type:"button","aria-label":t.i18n("addMoreFiles"),title:t.i18n("addMoreFiles"),onclick:function(){return t.toggleAddFilesPanel(!0)}},$e("svg",{class:"UppyIcon",width:"15",height:"15",viewBox:"0 0 13 13",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},$e("path",{d:"M7,6 L13,6 L13,7 L7,7 L7,13 L6,13 L6,7 L0,7 L0,6 L6,6 L6,0 L7,0 L7,6 Z"}))))},Qe=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Ze=D.h,tn=function(t){var e=0===t.totalFileCount,n=ee({"uppy-Root":t.isTargetDOMEl},"uppy-Dashboard",{"Uppy--isTouchDevice":"ontouchstart"in window||navigator.maxTouchPoints},{"uppy-Dashboard--animateOpenClose":t.animateOpenClose},{"uppy-Dashboard--isClosing":t.isClosing},{"uppy-Dashboard--modal":!t.inline},{"uppy-size--md":t.containerWidth>576},{"uppy-size--lg":t.containerWidth>700},{"uppy-Dashboard--isAddFilesPanelVisible":t.showAddFilesPanel});return Ze("div",{class:n,"aria-hidden":t.inline?"false":t.modal.isHidden,"aria-label":t.inline?t.i18n("dashboardTitle"):t.i18n("dashboardWindowTitle"),onpaste:t.handlePaste},Ze("div",{class:"uppy-Dashboard-overlay",tabindex:-1,onclick:t.handleClickOutside}),Ze("div",{class:"uppy-Dashboard-inner","aria-modal":!t.inline&&"true",role:!t.inline&&"dialog",style:{width:t.inline&&t.width?t.width:"",height:t.inline&&t.height?t.height:""}},Ze("button",{class:"uppy-Dashboard-close",type:"button","aria-label":t.i18n("closeModal"),title:t.i18n("closeModal"),onclick:t.closeModal},Ze("span",{"aria-hidden":"true"},"\xd7")),Ze("div",{class:"uppy-Dashboard-innerWrap"},!e&&t.showSelectedFiles&&Ze(Je,t),t.showSelectedFiles?Ze(e?we:Xe,t):Ze(we,t),Ze(oe,{transitionName:"uppy-transition-slideDownUp",transitionEnterTimeout:250,transitionLeaveTimeout:250},t.showAddFilesPanel?Ze(_e,Qe({key:"AddFilesPanel"},t)):null),Ze(oe,{transitionName:"uppy-transition-slideDownUp",transitionEnterTimeout:250,transitionLeaveTimeout:250},t.fileCardFor?Ze(Re,Qe({key:"FileCard"},t)):null),Ze(oe,{transitionName:"uppy-transition-slideDownUp",transitionEnterTimeout:250,transitionLeaveTimeout:250},t.activePanel?Ze(Ge,Qe({key:"PanelContent"},t)):null),Ze("div",{class:"uppy-Dashboard-progressindicators"},t.progressindicators.map(function(e){return t.getPlugin(e.id).render(t.state)})))))},en="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},on=Z.Plugin,rn=D.h,sn=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":en(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));return r.type="progressindicator",r.id=r.opts.id||"Informer",r.title="Informer",r.opts=nn({},{typeColors:{info:{text:"#fff",bg:"#000"},warning:{text:"#fff",bg:"#F6A623"},error:{text:"#fff",bg:"#D32F2F"},success:{text:"#fff",bg:"#1BB240"}}},o),r.render=r.render.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":en(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.render=function(t){var e=t.info,n=e.isHidden,o=e.message,r=e.details;return rn("div",{class:"uppy uppy-Informer","aria-hidden":n},rn("p",{role:"alert"},o," ",r&&rn("span",{"aria-label":r,"data-microtip-position":"top","data-microtip-size":"large",role:"tooltip"},"?")))},e.prototype.install=function(){var t=this.opts.target;t&&this.mount(t,this)},e}(on),an="error",ln="waiting",un="preprocessing",pn="uploading",cn="postprocessing",fn="complete",dn=function(t){var e,n=(e=t,{hours:Math.floor(e/3600)%24,minutes:Math.floor(e/60)%60,seconds:Math.floor(e%60)}),o=n.hours?n.hours+"h ":"",r=n.hours?("0"+n.minutes).substr(-2):n.minutes;return o+(r?r+"m ":"")+(r?("0"+n.seconds).substr(-2):n.seconds)+"s"},hn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},yn=D.h,mn=function(t){var e=ee("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn","uppy-StatusBar-actionBtn--upload",{"uppy-c-btn-primary":t.uploadState===ln});return yn("button",{type:"button",class:e,"aria-label":t.i18n("uploadXFiles",{smart_count:t.newFiles}),onclick:t.startUpload},t.newFiles&&t.isUploadStarted?t.i18n("uploadXNewFiles",{smart_count:t.newFiles}):t.i18n("uploadXFiles",{smart_count:t.newFiles}))},gn=function(t){return yn("button",{type:"button",class:"uppy-u-reset uppy-c-btn uppy-StatusBar-actionBtn uppy-StatusBar-actionBtn--retry","aria-label":t.i18n("retryUpload"),onclick:t.retryAll},t.i18n("retry"))},vn=function(t){return yn("button",{type:"button",class:"uppy-u-reset uppy-StatusBar-actionCircleBtn",title:t.i18n("cancel"),"aria-label":t.i18n("cancel"),onclick:t.cancelAll},yn("svg",{"aria-hidden":"true",class:"UppyIcon",width:"8",height:"8",viewBox:"0 0 8 8",xmlns:"http://www.w3.org/2000/svg"},yn("path",{d:"M5.21 4.104l1.658 1.658-1.106 1.106-1.658-1.659-1.659 1.659L1.34 5.762l1.658-1.658L1.34 2.445 2.445 1.34l1.659 1.658L5.762 1.34l1.106 1.105-1.659 1.659z","fill-rule":"evenodd"})))},bn=function(t){var e=t.isAllPaused,n=(0,t.i18n)(e?"resume":"pause");return yn("button",{title:n,class:"uppy-u-reset uppy-StatusBar-actionCircleBtn",type:"button",onclick:function(){return function(t){if(!t.isAllComplete)return t.resumableUploads?t.isAllPaused?t.resumeAll():t.pauseAll():t.cancelAll()}(t)}},yn("svg",{"aria-hidden":"true",class:"UppyIcon",width:"8",height:"8",viewBox:"0 0 8 8",xmlns:"http://www.w3.org/2000/svg"},yn("path",e?{d:"M6.736 3.852l-4.472 2.84V1.075z","fill-rule":"evenodd"}:{d:"M1 1h2v6H1zM5 1h2v6H5z","fill-rule":"evenodd"})))},wn=function(t){return yn("svg",{class:"uppy-StatusBar-spinner",width:"14",height:"14",xmlns:"http://www.w3.org/2000/svg"},yn("path",{d:"M13.983 6.547c-.12-2.509-1.64-4.893-3.939-5.936-2.48-1.127-5.488-.656-7.556 1.094C.524 3.367-.398 6.048.162 8.562c.556 2.495 2.46 4.52 4.94 5.183 2.932.784 5.61-.602 7.256-3.015-1.493 1.993-3.745 3.309-6.298 2.868-2.514-.434-4.578-2.349-5.153-4.84a6.226 6.226 0 0 1 2.98-6.778C6.34.586 9.74 1.1 11.373 3.493c.407.596.693 1.282.842 1.988.127.598.073 1.197.161 1.794.078.525.543 1.257 1.15.864.525-.341.49-1.05.456-1.592-.007-.15.02.3 0 0","fill-rule":"evenodd"}))},Sn=function(t){var e=Math.round(100*t.value);return yn("div",{class:"uppy-StatusBar-content"},yn(wn,t),"determinate"===t.mode?e+"% \xb7 ":"",t.message)},_n=function(t){var e=ee("uppy-u-reset","uppy-c-btn","uppy-StatusBar-actionBtn");return yn("div",{class:"uppy-StatusBar-statusSecondary"},yn("div",{class:"uppy-StatusBar-statusSecondaryHint"},t.i18n("xMoreFilesAdded",{smart_count:t.newFiles})),yn("button",{type:"button",class:e,"aria-label":t.i18n("uploadXFiles",{smart_count:t.newFiles}),onclick:t.startUpload},t.i18n("upload")))},Cn=st(function(t){return yn("div",{class:"uppy-StatusBar-statusSecondary"},t.numUploads>1&&t.i18n("filesUploadedOfTotal",{complete:t.complete,smart_count:t.numUploads})+" \xb7 ",t.i18n("dataUploadedOfTotal",{complete:R(t.totalUploadedSize),total:R(t.totalSize)})+" \xb7 ",t.i18n("xTimeLeft",{time:dn(t.totalETA)}))},500,{leading:!0,trailing:!0}),Pn=function(t){if(!t.isUploadStarted||t.isAllComplete)return null;var e=t.isAllPaused?t.i18n("paused"):t.i18n("uploading"),n=t.newFiles&&t.isUploadStarted;return yn("div",{class:"uppy-StatusBar-content","aria-label":e,title:e},t.isAllPaused?null:yn(wn,t),yn("div",{class:"uppy-StatusBar-status"},yn("div",{class:"uppy-StatusBar-statusPrimary"},e,": ",t.totalProgress,"%"),t.isAllPaused||n||!t.showProgressDetails?null:yn(Cn,t),n?yn(_n,t):null))},En=function(t){t.totalProgress;var e=t.i18n;return yn("div",{class:"uppy-StatusBar-content",role:"status",title:e("complete")},yn("svg",{"aria-hidden":"true",class:"uppy-StatusBar-statusIndicator UppyIcon",width:"18",height:"17",viewBox:"0 0 23 17"},yn("path",{d:"M8.944 17L0 7.865l2.555-2.61 6.39 6.525L20.41 0 23 2.645z"})),e("complete"))},Fn=function(t){var e=t.error,n=(t.retryAll,t.hideRetryButton,t.i18n);return yn("div",{class:"uppy-StatusBar-content",role:"alert"},yn("span",{class:"uppy-StatusBar-contentPadding"},n("uploadFailed"),"."),yn("span",{class:"uppy-StatusBar-details","aria-label":e,"data-microtip-position":"top","data-microtip-size":"large",role:"tooltip"},"?"))},kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},On=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Tn=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":kn(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));r.id=r.opts.id||"StatusBar",r.title="StatusBar",r.type="progressindicator";var i={strings:{uploading:"Uploading",upload:"Upload",complete:"Complete",uploadFailed:"Upload failed",pleasePressRetry:"Please press Retry to upload again",paused:"Paused",error:"Error",retry:"Retry",cancel:"Cancel",pause:"Pause",resume:"Resume",pressToRetry:"Press to retry",filesUploadedOfTotal:{0:"%{complete} of %{smart_count} file uploaded",1:"%{complete} of %{smart_count} files uploaded"},dataUploadedOfTotal:"%{complete} of %{total}",xTimeLeft:"%{time} left",uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},xMoreFilesAdded:{0:"%{smart_count} more file added",1:"%{smart_count} more files added"}}},s={target:"body",hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeButton:!1,hideCancelButton:!1,showProgressDetails:!1,locale:i,hideAfterFinish:!0};return r.opts=On({},s,o),r.translator=new G([i,r.uppy.locale,r.opts.locale]),r.i18n=r.translator.translate.bind(r.translator),r.startUpload=r.startUpload.bind(r),r.render=r.render.bind(r),r.install=r.install.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":kn(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getTotalSpeed=function(t){var e=0;return t.forEach(function(t){e+=function(t){if(!t.bytesUploaded)return 0;var e=new Date-t.uploadStarted;return t.bytesUploaded/(e/1e3)}(t.progress)}),e},e.prototype.getTotalETA=function(t){var e=this.getTotalSpeed(t);if(0===e)return 0;var n=t.reduce(function(t,e){return t+((n=e.progress).bytesTotal-n.bytesUploaded);var n},0);return Math.round(n/e*10)/10},e.prototype.startUpload=function(){var t=this;return this.uppy.upload().catch(function(e){t.uppy.log(e.stack||e.message||e)})},e.prototype.getUploadingState=function(t,e,n){if(t)return an;if(e)return fn;for(var o=ln,r=Object.keys(n),i=0;i<r.length;i++){var s=n[r[i]].progress;if(s.uploadStarted&&!s.uploadComplete)return pn;s.preprocess&&o!==pn&&(o=un),s.postprocess&&o!==pn&&o!==un&&(o=cn)}return o},e.prototype.render=function(t){var e=t.capabilities,n=t.files,o=t.allowNewUpload,r=t.totalProgress,i=t.error,s=Object.keys(n).filter(function(t){return!n[t].progress.uploadStarted&&!n[t].progress.preprocess&&!n[t].progress.postprocess}),a=Object.keys(n).filter(function(t){return n[t].progress.uploadStarted}),l=a.filter(function(t){return n[t].isPaused}),u=Object.keys(n).filter(function(t){return n[t].progress.uploadComplete}),p=Object.keys(n).filter(function(t){return n[t].error}),c=Object.keys(n).filter(function(t){return!n[t].progress.uploadComplete&&n[t].progress.uploadStarted}),f=c.filter(function(t){return!n[t].isPaused}),d=Object.keys(n).filter(function(t){return n[t].progress.uploadStarted||n[t].progress.preprocess||n[t].progress.postprocess}),h=Object.keys(n).filter(function(t){return n[t].progress.preprocess||n[t].progress.postprocess}),y=f.map(function(t){return n[t]}),m=this.getTotalETA(y),g=0,v=0;y.forEach(function(t){g+=t.progress.bytesTotal||0,v+=t.progress.bytesUploaded||0});var b=a.length>0,w=100===r&&u.length===Object.keys(n).length&&0===h.length,S=b&&p.length===a.length,_=0!==c.length&&l.length===c.length,C=c.length>0,P=e.resumableUploads||!1;return function(t){var e=t=t||{},n=e.newFiles,o=e.allowNewUpload,r=e.isUploadInProgress,i=e.isAllPaused,s=e.resumableUploads,a=e.error,l=e.hideUploadButton,u=e.hidePauseResumeButton,p=e.hideCancelButton,c=e.hideRetryButton,f=t.uploadState,d=t.totalProgress,h=void 0,y=void 0;if(f===un||f===cn){var m=function(t){var e=[];Object.keys(t).forEach(function(n){var o=t[n].progress;o.preprocess&&e.push(o.preprocess),o.postprocess&&e.push(o.postprocess)});var n=e[0];return{mode:n.mode,message:n.message,value:e.filter(function(t){return"determinate"===t.mode}).reduce(function(t,e,n,o){return t+e.value/o.length},0)}}(t.files);"determinate"===(h=m.mode)&&(d=100*m.value),y=Sn(m)}else f===fn?y=En(t):f===pn?y=Pn(t):f===an&&(d=void 0,y=Fn(t));var g="number"==typeof d?d:100,v=f===ln&&t.hideUploadButton||f===ln&&!t.newFiles>0||f===fn&&t.hideAfterFinish,b=!a&&n&&!r&&!i&&o&&!l,w=!p&&f!==ln&&f!==fn,S=s&&!u&&f!==ln&&f!==un&&f!==cn&&f!==fn,_=a&&!c,C="uppy-StatusBar-progress\n                           "+(h?"is-"+h:""),P=ee({"uppy-Root":t.isTargetDOMEl},"uppy-StatusBar","is-"+f);return yn("div",{class:P,"aria-hidden":v},yn("div",{class:C,style:{width:g+"%"},role:"progressbar","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":d}),y,yn("div",{class:"uppy-StatusBar-actions"},b?yn(mn,hn({},t,{uploadState:f})):null,_?yn(gn,t):null,S?yn(bn,t):null,w?yn(vn,t):null))}({error:i,uploadState:this.getUploadingState(S,w,t.files||{}),allowNewUpload:o,totalProgress:r,totalSize:g,totalUploadedSize:v,isAllComplete:w,isAllPaused:_,isAllErrored:S,isUploadStarted:b,isUploadInProgress:C,complete:u.length,newFiles:s.length,numUploads:d.length,totalETA:m,files:n,i18n:this.i18n,pauseAll:this.uppy.pauseAll,resumeAll:this.uppy.resumeAll,retryAll:this.uppy.retryAll,cancelAll:this.uppy.cancelAll,startUpload:this.startUpload,resumableUploads:P,showProgressDetails:this.opts.showProgressDetails,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,hideAfterFinish:this.opts.hideAfterFinish,isTargetDOMEl:this.isTargetDOMEl})},e.prototype.install=function(){var t=this.opts.target;t&&this.mount(t,this)},e.prototype.uninstall=function(){this.unmount()},e}(Z.Plugin),An=function(t,e,n){var o=t.split(",")[1],r=e.mimeType||t.split(",")[0].split(":")[1].split(";")[0];null==r&&(r="plain/text");for(var i=atob(o),s=[],a=0;a<i.length;a++)s.push(i.charCodeAt(a));return n?new File([new Uint8Array(s)],e.name||"",{type:r}):new Blob([new Uint8Array(s)],{type:r})},Un=function(t){return 0===t.indexOf("blob:")},xn=function(t){if(!t)return!1;var e=t.split("/")[1];return!!/^(jpe?g|gif|png|svg|svg\+xml|bmp)$/.test(e)},Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Dn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},jn=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Rn(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));return r.type="thumbnail",r.id=r.opts.id||"ThumbnailGenerator",r.title="Thumbnail Generator",r.queue=[],r.queueProcessing=!1,r.defaultThumbnailDimension=200,r.opts=Dn({},{thumbnailWidth:null,thumbnailHeight:null},o),r.onFileAdded=r.onFileAdded.bind(r),r.onFileRemoved=r.onFileRemoved.bind(r),r.onRestored=r.onRestored.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Rn(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.createThumbnail=function(t,e,n){var o=this,r=URL.createObjectURL(t.data);return new Promise(function(t,e){var n=new Image;n.src=r,n.addEventListener("load",function(){URL.revokeObjectURL(r),t(n)}),n.addEventListener("error",function(t){URL.revokeObjectURL(r),e(t.error||new Error("Could not create thumbnail"))})}).then(function(t){var r=o.getProportionalDimensions(t,e,n),i=o.resizeImage(t,r.width,r.height);return o.canvasToBlob(i,"image/png")}).then(function(t){return URL.createObjectURL(t)})},e.prototype.getProportionalDimensions=function(t,e,n){var o=t.width/t.height;return null!=e?{width:e,height:Math.round(e/o)}:null!=n?{width:Math.round(n*o),height:n}:{width:this.defaultThumbnailDimension,height:Math.round(this.defaultThumbnailDimension/o)}},e.prototype.protect=function(t){var e=t.width/t.height,n=Math.floor(Math.sqrt(5e6*e)),o=Math.floor(5e6/Math.sqrt(5e6*e));if(n>4096&&(n=4096,o=Math.round(n/e)),o>4096&&(o=4096,n=Math.round(e*o)),t.width>n){var r=document.createElement("canvas");r.width=n,r.height=o,r.getContext("2d").drawImage(t,0,0,n,o),t=r}return t},e.prototype.resizeImage=function(t,e,n){t=this.protect(t);var o=Math.ceil(Math.log(t.width/e)*Math.LOG2E);o<1&&(o=1);for(var r=e*Math.pow(2,o-1),i=n*Math.pow(2,o-1);o--;){var s=document.createElement("canvas");s.width=r,s.height=i,s.getContext("2d").drawImage(t,0,0,r,i),t=s,r=Math.round(r/2),i=Math.round(i/2)}return t},e.prototype.canvasToBlob=function(t,e,n){return t.toBlob?new Promise(function(o){t.toBlob(o,e,n)}):Promise.resolve().then(function(){return An(t.toDataURL(e,n),{})})},e.prototype.setPreviewURL=function(t,e){this.uppy.setFileState(t,{preview:e})},e.prototype.addToQueue=function(t){this.queue.push(t),!1===this.queueProcessing&&this.processQueue()},e.prototype.processQueue=function(){var t=this;if(this.queueProcessing=!0,this.queue.length>0){var e=this.queue.shift();return this.requestThumbnail(e).catch(function(t){}).then(function(){return t.processQueue()})}this.queueProcessing=!1,this.uppy.log("[ThumbnailGenerator] Emptied thumbnail queue"),this.uppy.emit("thumbnail:all-generated")},e.prototype.requestThumbnail=function(t){var e=this;return xn(t.type)&&!t.isRemote?this.createThumbnail(t,this.opts.thumbnailWidth,this.opts.thumbnailHeight).then(function(n){e.setPreviewURL(t.id,n),e.uppy.log("[ThumbnailGenerator] Generated thumbnail for "+t.id),e.uppy.emit("thumbnail:generated",e.uppy.getFile(t.id),n)}).catch(function(n){e.uppy.log("[ThumbnailGenerator] Failed thumbnail for "+t.id),e.uppy.log(n,"warning"),e.uppy.emit("thumbnail:error",e.uppy.getFile(t.id),n)}):Promise.resolve()},e.prototype.onFileAdded=function(t){t.preview||this.addToQueue(t)},e.prototype.onFileRemoved=function(t){var e=this.queue.indexOf(t);-1!==e&&this.queue.splice(e,1),t.preview&&Un(t.preview)&&URL.revokeObjectURL(t.preview)},e.prototype.onRestored=function(){var t=this,e=this.uppy.getState().files;Object.keys(e).forEach(function(e){var n=t.uppy.getFile(e);n.isRestored&&(n.preview&&!Un(n.preview)||t.addToQueue(n))})},e.prototype.install=function(){this.uppy.on("file-added",this.onFileAdded),this.uppy.on("file-removed",this.onFileRemoved),this.uppy.on("restored",this.onRestored)},e.prototype.uninstall=function(){this.uppy.off("file-added",this.onFileAdded),this.uppy.off("file-removed",this.onFileRemoved),this.uppy.off("restored",this.onRestored)},e}(Z.Plugin),Bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},In=function(t){if("string"==typeof t){var e=[].slice.call(document.querySelectorAll(t));return e.length>0?e:null}if("object"===(void 0===t?"undefined":Bn(t))&&B(t))return[t]},Mn=function(t){return Array.prototype.slice.call(t||[],0)},Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},zn=Z.Plugin,qn=te.default||te,Hn=le,Wn=['a[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','area[href]:not([tabindex^="-"]):not([inert]):not([aria-hidden])',"input:not([disabled]):not([inert]):not([aria-hidden])","select:not([disabled]):not([inert]):not([aria-hidden])","textarea:not([disabled]):not([inert]):not([aria-hidden])","button:not([disabled]):not([inert]):not([aria-hidden])",'iframe:not([tabindex^="-"]):not([inert]):not([aria-hidden])','object:not([tabindex^="-"]):not([inert]):not([aria-hidden])','embed:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[contenteditable]:not([tabindex^="-"]):not([inert]):not([aria-hidden])','[tabindex]:not([tabindex^="-"]):not([inert]):not([aria-hidden])'],Xn=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Ln(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));r.id=r.opts.id||"Dashboard",r.title="Dashboard",r.type="orchestrator",r.modalName="uppy-Dashboard";var i={target:"body",metaFields:[],trigger:"#uppy-select-files",inline:!1,width:750,height:550,thumbnailWidth:280,defaultTabIcon:Hn,showLinkToFileUploadResult:!0,showProgressDetails:!1,hideUploadButton:!1,hideRetryButton:!1,hidePauseResumeCancelButtons:!1,hideProgressAfterFinish:!1,note:null,closeModalOnClickOutside:!1,closeAfterFinish:!1,disableStatusBar:!1,disableInformer:!1,disableThumbnailGenerator:!1,disablePageScrollWhenModalOpen:!0,animateOpenClose:!0,proudlyDisplayPoweredByUppy:!0,onRequestCloseModal:function(){return r.closeModal()},showSelectedFiles:!0,browserBackButtonClose:!1};return r.opts=Nn({},i,o),r.translator=new G([{strings:{selectToUpload:"Select files to upload",closeModal:"Close Modal",upload:"Upload",importFrom:"Import from %{name}",addingMoreFiles:"Adding more files",addMoreFiles:"Add more files",dashboardWindowTitle:"Uppy Dashboard Window (Press escape to close)",dashboardTitle:"Uppy Dashboard",copyLinkToClipboardSuccess:"Link copied to clipboard",copyLinkToClipboardFallback:"Copy the URL below",copyLink:"Copy link",fileSource:"File source: %{name}",done:"Done",back:"Back",name:"Name",removeFile:"Remove file",editFile:"Edit file",editing:"Editing %{file}",edit:"Edit",finishEditingFile:"Finish editing file",saveChanges:"Save changes",cancel:"Cancel",localDisk:"Local Disk",myDevice:"My Device",dropPasteImport:"Drop files here, paste, %{browse} or import from",dropPaste:"Drop files here, paste or %{browse}",browse:"browse",fileProgress:"File progress: upload speed and ETA",numberOfSelectedFiles:"Number of selected files",uploadAllNewFiles:"Upload all new files",emptyFolderAdded:"No files were added from empty folder",uploadComplete:"Upload complete",uploadPaused:"Upload paused",resumeUpload:"Resume upload",pauseUpload:"Pause upload",retryUpload:"Retry upload",cancelUpload:"Cancel upload",xFilesSelected:{0:"%{smart_count} file selected",1:"%{smart_count} files selected"},uploadXFiles:{0:"Upload %{smart_count} file",1:"Upload %{smart_count} files"},uploadingXFiles:{0:"Uploading %{smart_count} file",1:"Uploading %{smart_count} files"},processingXFiles:{0:"Processing %{smart_count} file",1:"Processing %{smart_count} files"},uploadXNewFiles:{0:"Upload +%{smart_count} file",1:"Upload +%{smart_count} files"},folderAdded:{0:"Added %{smart_count} file from %{folder}",1:"Added %{smart_count} files from %{folder}"}}},r.uppy.locale,r.opts.locale]),r.i18n=r.translator.translate.bind(r.translator),r.i18nArray=r.translator.translateArray.bind(r.translator),r.openModal=r.openModal.bind(r),r.closeModal=r.closeModal.bind(r),r.requestCloseModal=r.requestCloseModal.bind(r),r.isModalOpen=r.isModalOpen.bind(r),r.addTarget=r.addTarget.bind(r),r.removeTarget=r.removeTarget.bind(r),r.hideAllPanels=r.hideAllPanels.bind(r),r.showPanel=r.showPanel.bind(r),r.getFocusableNodes=r.getFocusableNodes.bind(r),r.setFocusToFirstNode=r.setFocusToFirstNode.bind(r),r.handlePopState=r.handlePopState.bind(r),r.maintainFocus=r.maintainFocus.bind(r),r.initEvents=r.initEvents.bind(r),r.handleKeyDown=r.handleKeyDown.bind(r),r.handleFileAdded=r.handleFileAdded.bind(r),r.handleComplete=r.handleComplete.bind(r),r.handleClickOutside=r.handleClickOutside.bind(r),r.toggleFileCard=r.toggleFileCard.bind(r),r.toggleAddFilesPanel=r.toggleAddFilesPanel.bind(r),r.handleDrop=r.handleDrop.bind(r),r.handlePaste=r.handlePaste.bind(r),r.handleInputChange=r.handleInputChange.bind(r),r.render=r.render.bind(r),r.install=r.install.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Ln(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.removeTarget=function(t){var e=this.getPluginState().targets.filter(function(e){return e.id!==t.id});this.setPluginState({targets:e})},e.prototype.addTarget=function(t){var e=t.id||t.constructor.name,n=t.title||e,o=t.type;if("acquirer"===o||"progressindicator"===o||"presenter"===o){var r={id:e,name:n,type:o},i=this.getPluginState().targets.slice();return i.push(r),this.setPluginState({targets:i}),this.el}this.uppy.log("Dashboard: Modal can only be used by plugins of types: acquirer, progressindicator, presenter")},e.prototype.hideAllPanels=function(){this.setPluginState({activePanel:!1,showAddFilesPanel:!1})},e.prototype.showPanel=function(t){var e=this.getPluginState().targets.filter(function(e){return"acquirer"===e.type&&e.id===t})[0];this.setPluginState({activePanel:e})},e.prototype.requestCloseModal=function(){if(this.opts.onRequestCloseModal)return this.opts.onRequestCloseModal();this.closeModal()},e.prototype.getFocusableNodes=function(){var t=this.el.querySelectorAll(Wn);return Object.keys(t).map(function(e){return t[e]})},e.prototype.setFocusToFirstNode=function(){var t=this.getFocusableNodes();t.length&&t[0].focus()},e.prototype.updateBrowserHistory=function(){var t;history.state&&history.state[this.modalName]||history.pushState(((t={})[this.modalName]=!0,t),""),window.addEventListener("popstate",this.handlePopState,!1)},e.prototype.handlePopState=function(t){t.state&&t.state[this.modalName]||this.closeModal({manualClose:!1}),!this.isModalOpen()&&t.state&&t.state[this.modalName]&&history.go(-1)},e.prototype.setFocusToBrowse=function(){var t=this.el.querySelector(".uppy-Dashboard-browse");t&&t.focus()},e.prototype.maintainFocus=function(t){var e=this.getFocusableNodes(),n=e.indexOf(document.activeElement);t.shiftKey&&0===n&&(e[e.length-1].focus(),t.preventDefault()),t.shiftKey||n!==e.length-1||(e[0].focus(),t.preventDefault())},e.prototype.openModal=function(){var t=this;this.savedScrollPosition=window.scrollY,this.savedActiveElement=document.activeElement,this.opts.disablePageScrollWhenModalOpen&&document.body.classList.add("uppy-Dashboard-isFixed"),this.opts.animateOpenClose&&this.getPluginState().isClosing?this.el.addEventListener("animationend",function e(){t.setPluginState({isHidden:!1}),t.el.removeEventListener("animationend",e,!1)},!1):this.setPluginState({isHidden:!1}),this.opts.browserBackButtonClose&&this.updateBrowserHistory(),document.addEventListener("keydown",this.handleKeyDown),this.setFocusToBrowse()},e.prototype.closeModal=function(){var t=this,e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).manualClose,n=void 0===e||e;this.opts.disablePageScrollWhenModalOpen&&document.body.classList.remove("uppy-Dashboard-isFixed"),this.opts.animateOpenClose?(this.setPluginState({isClosing:!0}),this.el.addEventListener("animationend",function e(){t.setPluginState({isHidden:!0,isClosing:!1}),t.el.removeEventListener("animationend",e,!1)},!1)):this.setPluginState({isHidden:!0}),document.removeEventListener("keydown",this.handleKeyDown),this.savedActiveElement.focus(),n&&this.opts.browserBackButtonClose&&history.state&&history.state[this.modalName]&&history.go(-1)},e.prototype.isModalOpen=function(){return!this.getPluginState().isHidden||!1},e.prototype.handleKeyDown=function(t){27===t.keyCode&&this.requestCloseModal(t),9===t.keyCode&&this.maintainFocus(t)},e.prototype.handleClickOutside=function(){this.opts.closeModalOnClickOutside&&this.requestCloseModal()},e.prototype.handlePaste=function(t){var e=this;Mn(t.clipboardData.items).forEach(function(t){if("file"===t.kind){var n=t.getAsFile();if(!n)return e.uppy.log("[Dashboard] File pasted, but the file blob is empty"),void e.uppy.info("Error pasting file","error");e.uppy.log("[Dashboard] File pasted");try{e.uppy.addFile({source:e.id,name:t.name,type:t.type,data:n})}catch(t){}}})},e.prototype.handleInputChange=function(t){var e=this;t.preventDefault(),Mn(t.target.files).forEach(function(t){try{e.uppy.addFile({source:e.id,name:t.name,type:t.type,data:t})}catch(t){}})},e.prototype.initEvents=function(){var t=this,e=In(this.opts.trigger);!this.opts.inline&&e&&e.forEach(function(e){return e.addEventListener("click",t.openModal)}),this.opts.inline||e||this.uppy.log("Dashboard modal trigger not found. Make sure `trigger` is set in Dashboard options unless you are planning to call openModal() method yourself"),this.removeDragDropListener=Jt(this.el,function(e){t.handleDrop(e)}),this.ro=new qn(function(e,n){var o=e,r=Array.isArray(o),i=0;for(o=r?o:o[Symbol.iterator]();;){var s;if(r){if(i>=o.length)break;s=o[i++]}else{if((i=o.next()).done)break;s=i.value}var a=s.contentRect,l=a.width,u=a.height;t.uppy.log("[Dashboard] resized: "+l+" / "+u),t.setPluginState({containerWidth:l,containerHeight:u})}}),this.ro.observe(this.el.querySelector(".uppy-Dashboard-inner")),this.uppy.on("plugin-remove",this.removeTarget),this.uppy.on("file-added",this.handleFileAdded),this.uppy.on("complete",this.handleComplete)},e.prototype.handleFileAdded=function(){this.hideAllPanels()},e.prototype.handleComplete=function(t){var e=t.failed;t.uploadID,this.opts.closeAfterFinish&&0===e.length&&this.requestCloseModal()},e.prototype.removeEvents=function(){var t=this,e=In(this.opts.trigger);!this.opts.inline&&e&&e.forEach(function(e){return e.removeEventListener("click",t.openModal)}),this.ro.unobserve(this.el.querySelector(".uppy-Dashboard-inner")),this.removeDragDropListener(),window.removeEventListener("popstate",this.handlePopState,!1),this.uppy.off("plugin-remove",this.removeTarget),this.uppy.off("file-added",this.handleFileAdded),this.uppy.off("complete",this.handleComplete)},e.prototype.toggleFileCard=function(t){this.setPluginState({fileCardFor:t||!1})},e.prototype.toggleAddFilesPanel=function(t){this.setPluginState({showAddFilesPanel:t})},e.prototype.handleDrop=function(t){var e=this;this.uppy.log("[Dashboard] Files were dropped"),t.forEach(function(t){try{e.uppy.addFile({source:e.id,name:t.name,type:t.type,data:t})}catch(t){}})},e.prototype.render=function(t){var e=this,n=this.getPluginState(),o=t.files,r=t.capabilities,i=t.allowNewUpload,s=Object.keys(o).filter(function(t){return!o[t].progress.uploadStarted}),a=Object.keys(o).filter(function(t){return o[t].progress.uploadStarted}),l=Object.keys(o).filter(function(t){return o[t].isPaused}),u=Object.keys(o).filter(function(t){return o[t].progress.uploadComplete}),p=Object.keys(o).filter(function(t){return o[t].error}),c=Object.keys(o).filter(function(t){return!o[t].progress.uploadComplete&&o[t].progress.uploadStarted}),f=c.filter(function(t){return!o[t].isPaused}),d=Object.keys(o).filter(function(t){return o[t].progress.preprocess||o[t].progress.postprocess}),h=a.length>0,y=100===t.totalProgress&&u.length===Object.keys(o).length&&0===d.length,m=h&&p.length===a.length,g=0!==c.length&&l.length===c.length,v=function(t){var n=e.uppy.getPlugin(t.id);return Nn({},t,{icon:n.icon||e.opts.defaultTabIcon,render:n.render})},b=n.targets.filter(function(t){return"acquirer"===t.type&&function(t){var n=e.uppy.getPlugin(t.id);return"function"!=typeof n.isSupported||n.isSupported()}(t)}).map(v),w=n.targets.filter(function(t){return"progressindicator"===t.type}).map(v);return tn({state:t,modal:n,files:o,newFiles:s,uploadStartedFiles:a,completeFiles:u,erroredFiles:p,inProgressFiles:c,inProgressNotPausedFiles:f,processingFiles:d,isUploadStarted:h,isAllComplete:y,isAllErrored:m,isAllPaused:g,totalFileCount:Object.keys(o).length,totalProgress:t.totalProgress,allowNewUpload:i,acquirers:b,activePanel:n.activePanel,animateOpenClose:this.opts.animateOpenClose,isClosing:n.isClosing,getPlugin:this.uppy.getPlugin,progressindicators:w,autoProceed:this.uppy.opts.autoProceed,id:this.id,closeModal:this.requestCloseModal,handleClickOutside:this.handleClickOutside,handleInputChange:this.handleInputChange,handlePaste:this.handlePaste,inline:this.opts.inline,showPanel:this.showPanel,hideAllPanels:this.hideAllPanels,log:this.uppy.log,i18n:this.i18n,i18nArray:this.i18nArray,addFile:this.uppy.addFile,removeFile:this.uppy.removeFile,info:this.uppy.info,note:this.opts.note,metaFields:n.metaFields,resumableUploads:r.resumableUploads||!1,bundled:r.bundled||!1,startUpload:function(t){e.uppy.upload().catch(function(t){e.uppy.log(t.stack||t.message||t)})},pauseUpload:this.uppy.pauseResume,retryUpload:this.uppy.retryUpload,cancelUpload:function(t){e.uppy.removeFile(t)},cancelAll:this.uppy.cancelAll,fileCardFor:n.fileCardFor,toggleFileCard:this.toggleFileCard,toggleAddFilesPanel:this.toggleAddFilesPanel,showAddFilesPanel:n.showAddFilesPanel,saveFileCard:function(t,n){e.uppy.setFileMeta(n,t),e.toggleFileCard()},width:this.opts.width,height:this.opts.height,showLinkToFileUploadResult:this.opts.showLinkToFileUploadResult,proudlyDisplayPoweredByUppy:this.opts.proudlyDisplayPoweredByUppy,currentWidth:n.containerWidth,isWide:n.containerWidth>400,containerWidth:n.containerWidth,isTargetDOMEl:this.isTargetDOMEl,allowedFileTypes:this.uppy.opts.restrictions.allowedFileTypes,maxNumberOfFiles:this.uppy.opts.restrictions.maxNumberOfFiles,showSelectedFiles:this.opts.showSelectedFiles})},e.prototype.discoverProviderPlugins=function(){var t=this;this.uppy.iteratePlugins(function(e){e&&!e.target&&e.opts&&e.opts.target===t.constructor&&t.addTarget(e)})},e.prototype.install=function(){var t=this;this.setPluginState({isHidden:!0,showFileCard:!1,showAddFilesPanel:!1,activePanel:!1,metaFields:this.opts.metaFields,targets:[]});var e=this.opts,n=e.inline,o=e.closeAfterFinish;if(n&&o)throw new Error("[Dashboard] `closeAfterFinish: true` cannot be used on an inline Dashboard, because an inline Dashboard cannot be closed at all. Either set `inline: false`, or disable the `closeAfterFinish` option.");this.uppy.opts.allowMultipleUploads&&o&&this.uppy.log("[Dashboard] When using `closeAfterFinish`, we recommended setting the `allowMultipleUploads` option to `false` in the Uppy constructor. See https://uppy.io/docs/uppy/#allowMultipleUploads-true","warning");var r=this.opts.target;r&&this.mount(r,this),(this.opts.plugins||[]).forEach(function(e){var n=t.uppy.getPlugin(e);n&&n.mount(t,n)}),this.opts.disableStatusBar||this.uppy.use(Tn,{id:this.id+":StatusBar",target:this,hideUploadButton:this.opts.hideUploadButton,hideRetryButton:this.opts.hideRetryButton,hidePauseResumeButton:this.opts.hidePauseResumeButton,hideCancelButton:this.opts.hideCancelButton,showProgressDetails:this.opts.showProgressDetails,hideAfterFinish:this.opts.hideProgressAfterFinish,locale:this.opts.locale}),this.opts.disableInformer||this.uppy.use(sn,{id:this.id+":Informer",target:this}),this.opts.disableThumbnailGenerator||this.uppy.use(jn,{id:this.id+":ThumbnailGenerator",thumbnailWidth:this.opts.thumbnailWidth}),this.discoverProviderPlugins(),this.initEvents()},e.prototype.uninstall=function(){var t=this;if(!this.opts.disableInformer){var e=this.uppy.getPlugin(this.id+":Informer");e&&this.uppy.removePlugin(e)}if(!this.opts.disableStatusBar){var n=this.uppy.getPlugin(this.id+":StatusBar");n&&this.uppy.removePlugin(n)}if(!this.opts.disableThumbnailGenerator){var o=this.uppy.getPlugin(this.id+":ThumbnailGenerator");o&&this.uppy.removePlugin(o)}(this.opts.plugins||[]).forEach(function(e){var n=t.uppy.getPlugin(e);n&&n.unmount()}),this.unmount(),this.removeEvents()},e}(zn),Vn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gn=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},$n=Z.Plugin,Kn=D.h,Yn=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Vn(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));r.type="acquirer",r.id=r.opts.id||"DragDrop",r.title="Drag & Drop";var i={strings:{dropHereOr:"Drop files here or %{browse}",browse:"browse"}},s={target:null,inputName:"files[]",width:"100%",height:"100%",note:null,locale:i};return r.opts=Gn({},s,o),r.isDragDropSupported=r.checkDragDropSupport(),r.translator=new G([i,r.uppy.locale,r.opts.locale]),r.i18n=r.translator.translate.bind(r.translator),r.i18nArray=r.translator.translateArray.bind(r.translator),r.handleDrop=r.handleDrop.bind(r),r.handleInputChange=r.handleInputChange.bind(r),r.checkDragDropSupport=r.checkDragDropSupport.bind(r),r.render=r.render.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Vn(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.checkDragDropSupport=function(){var t=document.createElement("div");return"draggable"in t&&"ondragstart"in t&&"ondrop"in t&&"FormData"in window&&"FileReader"in window},e.prototype.handleDrop=function(t){var e=this;this.uppy.log("[DragDrop] Files dropped"),t.forEach(function(t){try{e.uppy.addFile({source:e.id,name:t.name,type:t.type,data:t})}catch(t){}})},e.prototype.handleInputChange=function(t){var e=this;this.uppy.log("[DragDrop] Files selected through input"),Mn(t.target.files).forEach(function(t){try{e.uppy.addFile({source:e.id,name:t.name,type:t.type,data:t})}catch(t){}})},e.prototype.render=function(t){var e=this,n="uppy-Root uppy-DragDrop-container "+(this.isDragDropSupported?"uppy-DragDrop--is-dragdrop-supported":""),o={width:this.opts.width,height:this.opts.height},r=this.uppy.opts.restrictions;return Kn("div",{class:n,style:o},Kn("div",{class:"uppy-DragDrop-inner"},Kn("svg",{"aria-hidden":"true",class:"UppyIcon uppy-DragDrop-arrow",width:"16",height:"16",viewBox:"0 0 16 16",xmlns:"http://www.w3.org/2000/svg"},Kn("path",{d:"M11 10V0H5v10H2l6 6 6-6h-3zm0 0","fill-rule":"evenodd"})),Kn("label",{class:"uppy-DragDrop-label"},Kn("input",{style:{width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute",zIndex:-1},class:"uppy-DragDrop-input",type:"file",name:this.opts.inputName,multiple:1!==r.maxNumberOfFiles,accept:r.allowedFileTypes,ref:function(t){e.input=t},onchange:this.handleInputChange,value:""}),this.i18nArray("dropHereOr",{browse:Kn("span",{class:"uppy-DragDrop-dragText"},this.i18n("browse"))})),Kn("span",{class:"uppy-DragDrop-note"},this.opts.note)))},e.prototype.install=function(){var t=this,e=this.opts.target;e&&this.mount(e,this),this.removeDragDropListener=Jt(this.el,function(e){t.handleDrop(e),t.uppy.log(e)})},e.prototype.uninstall=function(){this.unmount(),this.removeDragDropListener()},e}($n),Jn=D.h,Qn=function(t){return Jn("div",{class:"uppy-Provider-loading"},Jn("span",null,"Loading..."))},Zn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function to(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function eo(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Zn(e))&&"function"!=typeof e?t:e}function no(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Zn(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var oo=D.h,ro=D.Component,io=function(t){function e(){return to(this,e),eo(this,t.apply(this,arguments))}return no(e,t),e.prototype.componentDidMount=function(){var t=this;setTimeout(function(){t.connectButton&&t.connectButton.focus({preventScroll:!0})},150)},e.prototype.render=function(){var t=this;return oo("div",{class:"uppy-Provider-auth"},oo("div",{class:"uppy-Provider-authIcon"},this.props.pluginIcon()),oo("h1",{class:"uppy-Provider-authTitle"},"Please authenticate with ",oo("span",{class:"uppy-Provider-authTitleName"},this.props.pluginName),oo("br",null)," to select files"),oo("button",{type:"button",class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn",onclick:this.props.handleAuth,ref:function(e){t.connectButton=e}},"Connect to ",this.props.pluginName),this.props.demo&&oo("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Provider-authBtn",onclick:this.props.handleDemoAuth},"Proceed with Demo Account"))},e}(ro),so=function(t){function e(){return to(this,e),eo(this,t.apply(this,arguments))}return no(e,t),e.prototype.componentDidMount=function(){this.props.checkAuth()},e.prototype.render=function(){return this.props.checkAuthInProgress?oo(Qn,null):oo(io,this.props)},e}(ro),ao=D.h,lo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uo=D.h,po=function(t){function e(n){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":lo(e))&&"function"!=typeof e?t:e}(this,t.call(this,n));return o.isEmpty=!0,o.handleKeyPress=o.handleKeyPress.bind(o),o.handleClear=o.handleClear.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":lo(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleKeyPress=function(t){if(13===t.keyCode)return t.stopPropagation(),void t.preventDefault();this.isEmpty=!this.input.value.length>0,this.props.filterQuery(t)},e.prototype.handleClear=function(t){this.input.value="",this.props.filterQuery()},e.prototype.render=function(){var t=this;return uo("div",{class:"uppy-u-reset uppy-ProviderBrowser-search"},uo("svg",{class:"UppyIcon uppy-ProviderBrowser-searchIcon",viewBox:"0 0 100 100"},uo("path",{d:"M87.533 80.03L62.942 55.439c3.324-4.587 5.312-10.207 5.312-16.295 0-.312-.043-.611-.092-.908.05-.301.093-.605.093-.922 0-15.36-12.497-27.857-27.857-27.857-.273 0-.536.043-.799.08-.265-.037-.526-.08-.799-.08-15.361 0-27.858 12.497-27.858 27.857 0 .312.042.611.092.909a5.466 5.466 0 0 0-.093.921c0 15.36 12.496 27.858 27.857 27.858.273 0 .535-.043.8-.081.263.038.524.081.798.081 5.208 0 10.071-1.464 14.245-3.963L79.582 87.98a5.603 5.603 0 0 0 3.976 1.647 5.621 5.621 0 0 0 3.975-9.597zM39.598 55.838c-.265-.038-.526-.081-.8-.081-9.16 0-16.612-7.452-16.612-16.612 0-.312-.042-.611-.092-.908.051-.301.093-.605.093-.922 0-9.16 7.453-16.612 16.613-16.612.272 0 .534-.042.799-.079.263.037.525.079.799.079 9.16 0 16.612 7.452 16.612 16.612 0 .312.043.611.092.909-.05.301-.094.604-.094.921 0 9.16-7.452 16.612-16.612 16.612-.274 0-.536.043-.798.081z"})),uo("input",{class:"uppy-u-reset uppy-ProviderBrowser-searchInput",type:"text",placeholder:"Filter","aria-label":"Filter",onkeyup:this.handleKeyPress,onkeydown:this.handleKeyPress,onkeypress:this.handleKeyPress,value:this.props.filterInput,ref:function(e){t.input=e}}),!this.isEmpty&&uo("button",{class:"uppy-u-reset uppy-ProviderBrowser-searchClose",type:"button",onclick:this.handleClear},uo("svg",{class:"UppyIcon",viewBox:"0 0 19 19"},uo("path",{d:"M17.318 17.232L9.94 9.854 9.586 9.5l-.354.354-7.378 7.378h.707l-.62-.62v.706L9.318 9.94l.354-.354-.354-.354L1.94 1.854v.707l.62-.62h-.706l7.378 7.378.354.354.354-.354 7.378-7.378h-.707l.622.62v-.706L9.854 9.232l-.354.354.354.354 7.378 7.378.708-.707-7.38-7.378v.708l7.38-7.38.353-.353-.353-.353-.622-.622-.353-.353-.354.352-7.378 7.38h.708L2.56 1.23 2.208.88l-.353.353-.622.62-.353.355.352.353 7.38 7.38v-.708l-7.38 7.38-.353.353.352.353.622.622.353.353.354-.353 7.38-7.38h-.708l7.38 7.38z"}))))},e}(D.Component),co=D.h,fo=function(t){return co("div",{class:"uppy-ProviderBrowser-footer"},co("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary",onclick:t.done},t.i18n("selectXFiles",{smart_count:t.selected})),co("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-link",onclick:t.cancel},t.i18n("cancel")))},ho=D.h,yo=function(t){var e=function(t){13===t.keyCode&&(t.stopPropagation(),t.preventDefault())},n=t.getItemIcon();return ho("li",{class:"uppy-ProviderBrowserItem"+(t.isChecked?" uppy-ProviderBrowserItem--selected":"")+("video"===n?" uppy-ProviderBrowserItem--noPreview":"")},ho("div",{class:"uppy-ProviderBrowserItem-checkbox"},ho("input",{type:"checkbox",role:"option",tabindex:0,"aria-label":"Select "+t.title,id:t.id,checked:t.isChecked,disabled:t.isDisabled,onchange:t.handleClick,onkeyup:e,onkeydown:e,onkeypress:e}),ho("label",{for:t.id,onclick:t.handleClick})),ho("button",{type:"button",class:"uppy-ProviderBrowserItem-inner","aria-label":"Select "+t.title,tabindex:0,onclick:function(e){if(e.preventDefault(),"folder"===t.type)return t.handleFolderClick(e);t.handleClick(e)}},function(t){if(null!==t)switch(t){case"file":return ho("svg",{"aria-hidden":"true",class:"UppyIcon",width:11,height:14.5,viewBox:"0 0 44 58"},ho("path",{d:"M27.437.517a1 1 0 0 0-.094.03H4.25C2.037.548.217 2.368.217 4.58v48.405c0 2.212 1.82 4.03 4.03 4.03H39.03c2.21 0 4.03-1.818 4.03-4.03V15.61a1 1 0 0 0-.03-.28 1 1 0 0 0 0-.093 1 1 0 0 0-.03-.032 1 1 0 0 0 0-.03 1 1 0 0 0-.032-.063 1 1 0 0 0-.03-.063 1 1 0 0 0-.032 0 1 1 0 0 0-.03-.063 1 1 0 0 0-.032-.03 1 1 0 0 0-.03-.063 1 1 0 0 0-.063-.062l-14.593-14a1 1 0 0 0-.062-.062A1 1 0 0 0 28 .708a1 1 0 0 0-.374-.157 1 1 0 0 0-.156 0 1 1 0 0 0-.03-.03l-.003-.003zM4.25 2.547h22.218v9.97c0 2.21 1.82 4.03 4.03 4.03h10.564v36.438a2.02 2.02 0 0 1-2.032 2.032H4.25c-1.13 0-2.032-.9-2.032-2.032V4.58c0-1.13.902-2.032 2.03-2.032zm24.218 1.345l10.375 9.937.75.718H30.5c-1.13 0-2.032-.9-2.032-2.03V3.89z"}));case"folder":return ho("svg",{"aria-hidden":"true",class:"UppyIcon",style:{width:16,marginRight:3},viewBox:"0 0 276.157 276.157"},ho("path",{d:"M273.08 101.378c-3.3-4.65-8.86-7.32-15.254-7.32h-24.34V67.59c0-10.2-8.3-18.5-18.5-18.5h-85.322c-3.63 0-9.295-2.875-11.436-5.805l-6.386-8.735c-4.982-6.814-15.104-11.954-23.546-11.954H58.73c-9.292 0-18.638 6.608-21.737 15.372l-2.033 5.752c-.958 2.71-4.72 5.37-7.596 5.37H18.5C8.3 49.09 0 57.39 0 67.59v167.07c0 .886.16 1.73.443 2.52.152 3.306 1.18 6.424 3.053 9.064 3.3 4.652 8.86 7.32 15.255 7.32h188.487c11.395 0 23.27-8.425 27.035-19.18l40.677-116.188c2.11-6.035 1.43-12.164-1.87-16.816zM18.5 64.088h8.864c9.295 0 18.64-6.607 21.738-15.37l2.032-5.75c.96-2.712 4.722-5.373 7.597-5.373h29.565c3.63 0 9.295 2.876 11.437 5.806l6.386 8.735c4.982 6.815 15.104 11.954 23.546 11.954h85.322c1.898 0 3.5 1.602 3.5 3.5v26.47H69.34c-11.395 0-23.27 8.423-27.035 19.178L15 191.23V67.59c0-1.898 1.603-3.5 3.5-3.5zm242.29 49.15l-40.676 116.188c-1.674 4.78-7.812 9.135-12.877 9.135H18.75c-1.447 0-2.576-.372-3.02-.997-.442-.625-.422-1.814.057-3.18l40.677-116.19c1.674-4.78 7.812-9.134 12.877-9.134h188.487c1.448 0 2.577.372 3.02.997.443.625.423 1.814-.056 3.18z"}));case"video":return ho("svg",{"aria-hidden":"true",viewBox:"0 0 58 58"},ho("path",{d:"M36.537 28.156l-11-7a1.005 1.005 0 0 0-1.02-.033C24.2 21.3 24 21.635 24 22v14a1 1 0 0 0 1.537.844l11-7a1.002 1.002 0 0 0 0-1.688zM26 34.18V23.82L34.137 29 26 34.18z"}),ho("path",{d:"M57 6H1a1 1 0 0 0-1 1v44a1 1 0 0 0 1 1h56a1 1 0 0 0 1-1V7a1 1 0 0 0-1-1zM10 28H2v-9h8v9zm-8 2h8v9H2v-9zm10 10V8h34v42H12V40zm44-12h-8v-9h8v9zm-8 2h8v9h-8v-9zm8-22v9h-8V8h8zM2 8h8v9H2V8zm0 42v-9h8v9H2zm54 0h-8v-9h8v9z"}));default:return ho("img",{src:t})}}(t.getItemIcon()),t.showTitles&&t.title))},mo=D.h,go=function(t){return t.folders.length||t.files.length?mo("div",{class:"uppy-ProviderBrowser-body"},mo("ul",{class:"uppy-ProviderBrowser-list",onscroll:t.handleScroll,role:"listbox","aria-label":"List of files from "+t.title},t.folders.map(function(e){var n=!1,o=t.isChecked(e);return o&&(n=o.loading),yo({title:e.name,id:e.id,type:"folder",getItemIcon:function(){return e.icon},isDisabled:n,isChecked:o,handleFolderClick:function(){return t.handleFolderClick(e)},handleClick:function(n){return t.toggleCheckbox(n,e)},columns:t.columns,showTitles:t.showTitles})}),t.files.map(function(e){return yo({title:e.name,id:e.id,type:"file",getItemIcon:function(){return e.icon},isDisabled:!1,isChecked:t.isChecked(e),handleClick:function(n){return t.toggleCheckbox(n,e)},columns:t.columns,showTitles:t.showTitles})}))):mo("div",{class:"uppy-Provider-empty"},t.i18n("noFilesFound"))},vo=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},bo=D.h,wo=function(t){var e=t.folders,n=t.files;""!==t.filterInput&&(e=t.filterItems(t.folders),n=t.filterItems(t.files));var o=t.currentSelection.length;return bo("div",{class:ee("uppy-ProviderBrowser","uppy-ProviderBrowser-viewType--"+t.viewType)},bo("div",{class:"uppy-ProviderBrowser-header"},bo("div",{class:ee("uppy-ProviderBrowser-headerBar",!t.showBreadcrumbs&&"uppy-ProviderBrowser-headerBar--simple")},bo("div",{class:"uppy-Provider-breadcrumbsWrap"},bo("div",{class:"uppy-Provider-breadcrumbsIcon"},t.pluginIcon&&t.pluginIcon()),t.showBreadcrumbs&&function(t){return ao("div",{class:"uppy-Provider-breadcrumbs"},t.directories.map(function(e,n){return function(t){return ao("button",{type:"button",onclick:t.getFolder},t.title)}({getFolder:function(){return t.getFolder(e.id)},title:0===n?t.title:e.title})}))}({getFolder:t.getFolder,directories:t.directories,title:t.title})),bo("span",{class:"uppy-ProviderBrowser-user"},t.username),bo("button",{type:"button",onclick:t.logout,class:"uppy-ProviderBrowser-userLogout"},t.i18n("logOut")))),t.showFilter&&bo(po,t),bo(go,{columns:[{name:"Name",key:"title"}],folders:e,files:n,activeRow:t.isActiveRow,sortByTitle:t.sortByTitle,sortByDate:t.sortByDate,isChecked:t.isChecked,handleFolderClick:t.getNextFolder,toggleCheckbox:t.toggleCheckbox,handleScroll:t.handleScroll,title:t.title,showTitles:t.showTitles,i18n:t.i18n}),o>0&&bo(fo,vo({selected:o},t)))},So="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};function Co(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var Po=D.h,Eo=function(t){function e(){return Co(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":So(e))&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":So(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentWillUnmount=function(){this.props.onUnmount()},e.prototype.render=function(){return this.props.children[0]},e}(D.Component),Fo=function(){function t(e,n){Co(this,t),this.plugin=e,this.Provider=e[e.id],this.opts=_o({},{viewType:"list",showTitles:!0,showFilter:!0,showBreadcrumbs:!0},n),this.addFile=this.addFile.bind(this),this.filterItems=this.filterItems.bind(this),this.filterQuery=this.filterQuery.bind(this),this.toggleSearch=this.toggleSearch.bind(this),this.getFolder=this.getFolder.bind(this),this.getNextFolder=this.getNextFolder.bind(this),this.logout=this.logout.bind(this),this.checkAuth=this.checkAuth.bind(this),this.handleAuth=this.handleAuth.bind(this),this.handleDemoAuth=this.handleDemoAuth.bind(this),this.sortByTitle=this.sortByTitle.bind(this),this.sortByDate=this.sortByDate.bind(this),this.isActiveRow=this.isActiveRow.bind(this),this.isChecked=this.isChecked.bind(this),this.toggleCheckbox=this.toggleCheckbox.bind(this),this.handleError=this.handleError.bind(this),this.handleScroll=this.handleScroll.bind(this),this.donePicking=this.donePicking.bind(this),this.cancelPicking=this.cancelPicking.bind(this),this.clearSelection=this.clearSelection.bind(this),this.render=this.render.bind(this),this.clearSelection()}return t.prototype.tearDown=function(){},t.prototype._updateFilesAndFolders=function(t,e,n){t.items.forEach(function(t){t.isFolder?n.push(t):e.push(t)}),this.plugin.setPluginState({folders:n,files:e})},t.prototype.checkAuth=function(){var t=this;this.plugin.setPluginState({checkAuthInProgress:!0}),this.Provider.checkAuth().then(function(e){t.plugin.setPluginState({checkAuthInProgress:!1}),t.plugin.onAuth(e)}).catch(function(e){t.plugin.setPluginState({checkAuthInProgress:!1}),t.handleError(e)})},t.prototype.getFolder=function(t,e){var n=this;return this._loaderWrapper(this.Provider.list(t),function(o){var r,i=n.plugin.getPluginState(),s=function(e,n){for(var o=0;o<e.length;o++)if(r=e[o],t===r.id)return o;var r;return-1}(i.directories);r=-1!==s?i.directories.slice(0,s+1):i.directories.concat([{id:t,title:e}]),n.username=n.username?n.username:o.username,n.nextPagePath=o.nextPagePath,n._updateFilesAndFolders(o,[],[]),n.plugin.setPluginState({directories:r})},this.handleError)},t.prototype.getNextFolder=function(t){this.getFolder(t.requestPath,t.name),this.lastCheckbox=void 0},t.prototype.addFile=function(t){var e={id:this.providerFileToId(t),source:this.plugin.id,data:t,name:t.name||t.id,type:t.mimeType,isRemote:!0,body:{fileId:t.id},remote:{serverUrl:this.plugin.opts.serverUrl,url:""+this.Provider.fileUrl(t.requestPath),body:{fileId:t.id},providerOptions:this.Provider.opts}},n=J(e);n&&xn(n)&&(e.preview=t.thumbnail),this.plugin.uppy.log("Adding remote file");try{this.plugin.uppy.addFile(e)}catch(t){}},t.prototype.removeFile=function(t){var e=this.plugin.getPluginState().currentSelection;this.plugin.setPluginState({currentSelection:e.filter(function(e){return e.id!==t})})},t.prototype.logout=function(){var t=this;this.Provider.logout(location.href).then(function(e){e.ok&&t.plugin.setPluginState({authenticated:!1,files:[],folders:[],directories:[]})}).catch(this.handleError)},t.prototype.filterQuery=function(t){var e=this.plugin.getPluginState();this.plugin.setPluginState(_o({},e,{filterInput:t?t.target.value:""}))},t.prototype.toggleSearch=function(t){var e=this.plugin.getPluginState();this.plugin.setPluginState({isSearchVisible:!e.isSearchVisible,filterInput:""})},t.prototype.filterItems=function(t){var e=this.plugin.getPluginState();return""===e.filterInput?t:t.filter(function(t){return-1!==t.name.toLowerCase().indexOf(e.filterInput.toLowerCase())})},t.prototype.sortByTitle=function(){var t=_o({},this.plugin.getPluginState()),e=t.files,n=t.folders,o=t.sorting,r=e.sort(function(t,e){return"titleDescending"===o?e.name.localeCompare(t.name):t.name.localeCompare(e.name)}),i=n.sort(function(t,e){return"titleDescending"===o?e.name.localeCompare(t.name):t.name.localeCompare(e.name)});this.plugin.setPluginState(_o({},t,{files:r,folders:i,sorting:"titleDescending"===o?"titleAscending":"titleDescending"}))},t.prototype.sortByDate=function(){var t=_o({},this.plugin.getPluginState()),e=t.files,n=t.folders,o=t.sorting,r=e.sort(function(t,e){var n=new Date(t.modifiedDate),r=new Date(e.modifiedDate);return"dateDescending"===o?n>r?-1:n<r?1:0:n>r?1:n<r?-1:0}),i=n.sort(function(t,e){var n=new Date(t.modifiedDate),r=new Date(e.modifiedDate);return"dateDescending"===o?n>r?-1:n<r?1:0:n>r?1:n<r?-1:0});this.plugin.setPluginState(_o({},t,{files:r,folders:i,sorting:"dateDescending"===o?"dateAscending":"dateDescending"}))},t.prototype.sortBySize=function(){var t=_o({},this.plugin.getPluginState()),e=t.files,n=t.sorting;if(e.length&&this.plugin.getItemData(e[0]).size){var o=e.sort(function(t,e){var o=t.size,r=e.size;return"sizeDescending"===n?o>r?-1:o<r?1:0:o>r?1:o<r?-1:0});this.plugin.setPluginState(_o({},t,{files:o,sorting:"sizeDescending"===n?"sizeAscending":"sizeDescending"}))}},t.prototype.isActiveRow=function(t){return this.plugin.getPluginState().activeRow===this.plugin.getItemId(t)},t.prototype.isChecked=function(t){return this.plugin.getPluginState().currentSelection.some(function(e){return e===t})},t.prototype.addFolder=function(t){var e=this,n=this.providerFileToId(t),o=this.plugin.getPluginState(),r=o.selectedFolders||{};if(!(n in r&&r[n].loading))return r[n]={loading:!0,files:[]},this.plugin.setPluginState({selectedFolders:r}),this.Provider.list(t.requestPath).then(function(i){var s=[];i.items.forEach(function(t){t.isFolder||(e.addFile(t),s.push(e.providerFileToId(t)))}),(o=e.plugin.getPluginState()).selectedFolders[n]={loading:!1,files:s},e.plugin.setPluginState({selectedFolders:r});var a,l=e.plugin.uppy.getPlugin("Dashboard");a=s.length?l.i18n("folderAdded",{smart_count:s.length,folder:t.name}):l.i18n("emptyFolderAdded"),e.plugin.uppy.info(a)}).catch(function(t){delete(o=e.plugin.getPluginState()).selectedFolders[n],e.plugin.setPluginState({selectedFolders:o.selectedFolders}),e.handleError(t)})},t.prototype.toggleCheckbox=function(t,e){t.stopPropagation(),t.preventDefault();var n=this.plugin.getPluginState(),o=n.folders,r=n.files,i=this.filterItems(o.concat(r));if(this.lastCheckbox&&t.shiftKey){var s,a=i.indexOf(this.lastCheckbox),l=i.indexOf(e);return s=a<l?i.slice(a,l+1):i.slice(l,a+1),void this.plugin.setPluginState({currentSelection:s})}this.lastCheckbox=e;var u=this.plugin.getPluginState().currentSelection;this.isChecked(e)?this.plugin.setPluginState({currentSelection:u.filter(function(t){return t!==e})}):this.plugin.setPluginState({currentSelection:u.concat([e])})},t.prototype.providerFileToId=function(t){return $({data:t,name:t.name||t.id,type:t.mimeType})},t.prototype.handleDemoAuth=function(){var t=this.plugin.getPluginState();this.plugin.setPluginState({},t,{authenticated:!0})},t.prototype.handleAuth=function(){var t=this,e=btoa(JSON.stringify({origin:location.origin})),n=this.Provider.authUrl()+"?state="+e,o=window.open(n,"_blank");window.addEventListener("message",function e(n){t._isOriginAllowed(n.origin,t.plugin.opts.serverPattern)?(o.close(),window.removeEventListener("message",e),t.Provider.setAuthToken(n.data.token),t._loaderWrapper(t.Provider.checkAuth(),t.plugin.onAuth,t.handleError)):t.plugin.uppy.log("rejecting event from "+n.origin+" vs allowed pattern "+t.plugin.opts.serverPattern)})},t.prototype._isOriginAllowed=function(t,e){var n=function(t){return"string"==typeof t?new RegExp("^"+t+"$"):t instanceof RegExp?t:void 0};return(Array.isArray(e)?e.map(n):[n(e)]).filter(function(t){return null!==t}).some(function(e){return e.test(t)})},t.prototype.handleError=function(t){var e=this.plugin.uppy,n=e.i18n("companionError");e.log(t.toString()),e.info({message:n,details:t.toString()},"error",5e3)},t.prototype.handleScroll=function(t){var e=this,n=t.target.scrollHeight-(t.target.scrollTop+t.target.offsetHeight),o=this.nextPagePath?this.nextPagePath:null;n<50&&o&&!this._isHandlingScroll&&(this.Provider.list(o).then(function(t){var n=e.plugin.getPluginState(),o=n.files,r=n.folders;e._updateFilesAndFolders(t,o,r)}).catch(this.handleError).then(function(){e._isHandlingScroll=!1}),this._isHandlingScroll=!0)},t.prototype.donePicking=function(){var t=this,e=this.plugin.getPluginState().currentSelection.map(function(e){return e.isFolder?t.addFolder(e):t.addFile(e)});this._loaderWrapper(Promise.all(e),function(){t.clearSelection()},function(){})},t.prototype.cancelPicking=function(){this.clearSelection();var t=this.plugin.uppy.getPlugin("Dashboard");t&&t.hideAllPanels()},t.prototype.clearSelection=function(){this.plugin.setPluginState({currentSelection:[]})},t.prototype._loaderWrapper=function(t,e,n){var o=this;t.then(function(t){o.plugin.setPluginState({loading:!1}),e(t)}).catch(function(t){o.plugin.setPluginState({loading:!1}),n(t)}),this.plugin.setPluginState({loading:!0})},t.prototype.render=function(t){var e=this.plugin.getPluginState(),n=e.authenticated,o=e.checkAuthInProgress;if(e.loading)return Po(Eo,{onUnmount:this.clearSelection},Po(Qn,null));if(!n)return Po(Eo,{onUnmount:this.clearSelection},Po(so,{pluginName:this.plugin.title,pluginIcon:this.plugin.icon,demo:this.plugin.opts.demo,checkAuth:this.checkAuth,handleAuth:this.handleAuth,handleDemoAuth:this.handleDemoAuth,checkAuthInProgress:o}));var r=_o({},this.plugin.getPluginState(),{username:this.username,getNextFolder:this.getNextFolder,getFolder:this.getFolder,filterItems:this.filterItems,filterQuery:this.filterQuery,toggleSearch:this.toggleSearch,sortByTitle:this.sortByTitle,sortByDate:this.sortByDate,logout:this.logout,demo:this.plugin.opts.demo,isActiveRow:this.isActiveRow,isChecked:this.isChecked,toggleCheckbox:this.toggleCheckbox,handleScroll:this.handleScroll,done:this.donePicking,cancel:this.cancelPicking,title:this.plugin.title,viewType:this.opts.viewType,showTitles:this.opts.showTitles,showFilter:this.opts.showFilter,showBreadcrumbs:this.opts.showBreadcrumbs,pluginIcon:this.plugin.icon,i18n:this.plugin.uppy.i18n});return Po(Eo,{onUnmount:this.clearSelection},Po(wo,r))},t}(),ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oo=Z.Plugin,To=m.Provider,Ao=D.h,Uo=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":ko(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));return r.id=r.opts.id||"Dropbox",To.initPlugin(r,o),r.title=r.opts.title||"Dropbox",r.icon=function(){return Ao("svg",{"aria-hidden":"true",fill:"#0060ff",width:"128",height:"118",viewBox:"0 0 128 118"},Ao("path",{d:"M38.145.777L1.108 24.96l25.608 20.507 37.344-23.06z"}),Ao("path",{d:"M1.108 65.975l37.037 24.183L64.06 68.525l-37.343-23.06zM64.06 68.525l25.917 21.633 37.036-24.183-25.61-20.51z"}),Ao("path",{d:"M127.014 24.96L89.977.776 64.06 22.407l37.345 23.06zM64.136 73.18l-25.99 21.567-11.122-7.262v8.142l37.112 22.256 37.114-22.256v-8.142l-11.12 7.262z"}))},r[r.id]=new To(n,{serverUrl:r.opts.serverUrl,serverHeaders:r.opts.serverHeaders,provider:"dropbox"}),r.onAuth=r.onAuth.bind(r),r.render=r.render.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":ko(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.install=function(){this.view=new Fo(this),this.setPluginState({authenticated:!1,files:[],folders:[],directories:[],activeRow:-1,filterInput:"",isSearchVisible:!1});var t=this.opts.target;t&&this.mount(t,this)},e.prototype.uninstall=function(){this.view.tearDown(),this.unmount()},e.prototype.onAuth=function(t){this.setPluginState({authenticated:t}),t&&this.view.getFolder()},e.prototype.render=function(t){return this.view.render(t)},e}(Oo),xo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ro=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Do=Z.Plugin,jo=D.h,Bo=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":xo(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));r.id=r.opts.id||"FileInput",r.title="File Input",r.type="acquirer";var i={strings:{chooseFiles:"Choose files"}},s={target:null,pretty:!0,inputName:"files[]",locale:i};return r.opts=Ro({},s,o),r.translator=new G([i,r.uppy.locale,r.opts.locale]),r.i18n=r.translator.translate.bind(r.translator),r.i18nArray=r.translator.translateArray.bind(r.translator),r.render=r.render.bind(r),r.handleInputChange=r.handleInputChange.bind(r),r.handleClick=r.handleClick.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":xo(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleInputChange=function(t){var e=this;this.uppy.log("[FileInput] Something selected through input..."),Mn(t.target.files).forEach(function(t){try{e.uppy.addFile({source:e.id,name:t.name,type:t.type,data:t})}catch(t){}})},e.prototype.handleClick=function(t){this.input.click()},e.prototype.render=function(t){var e=this,n=this.uppy.opts.restrictions;return jo("div",{class:"uppy-Root uppy-FileInput-container"},jo("input",{class:"uppy-FileInput-input",style:this.opts.pretty&&{width:"0.1px",height:"0.1px",opacity:0,overflow:"hidden",position:"absolute",zIndex:-1},type:"file",name:this.opts.inputName,onchange:this.handleInputChange,multiple:1!==n.maxNumberOfFiles,accept:n.allowedFileTypes,ref:function(t){e.input=t},value:""}),this.opts.pretty&&jo("button",{class:"uppy-FileInput-btn",type:"button",onclick:this.handleClick},this.i18n("chooseFiles")))},e.prototype.install=function(){var t=this.opts.target;t&&this.mount(t,this)},e.prototype.uninstall=function(){this.unmount()},e}(Do),Io={__esModule:!0};Io.default=Wo,Io.getFieldData=Xo;var Mo={"[object HTMLCollection]":!0,"[object NodeList]":!0,"[object RadioNodeList]":!0},Lo={button:!0,fieldset:!0,reset:!0,submit:!0},No={checkbox:!0,radio:!0},zo=/^\s+|\s+$/g,qo=Array.prototype.slice,Ho=Object.prototype.toString;function Wo(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{trim:!1};if(!t)throw new Error("A form is required by getFormData, was given form="+t);for(var n={},o=void 0,r=[],i={},s=0,a=t.elements.length;s<a;s++){var l=t.elements[s];Lo[l.type]||l.disabled||(o=l.name||l.id)&&!i[o]&&(r.push(o),i[o]=!0)}for(var u=0,p=r.length;u<p;u++){var c=Xo(t,o=r[u],e);null!=c&&(n[o]=c)}return n}function Xo(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{trim:!1};if(!t)throw new Error("A form is required by getFieldData, was given form="+t);if(!e&&"[object String]"!==Ho.call(e))throw new Error("A field name is required by getFieldData, was given fieldName="+e);var o=t.elements[e];if(!o||o.disabled)return null;if(!Mo[Ho.call(o)])return Vo(o,n.trim);for(var r=[],i=!0,s=0,a=o.length;s<a;s++)if(!o[s].disabled){i&&"radio"!==o[s].type&&(i=!1);var l=Vo(o[s],n.trim);null!=l&&(r=r.concat(l))}return i&&1===r.length?r[0]:r.length>0?r:null}function Vo(t,e){var n=null,o=t.type;if("select-one"===o)return t.options.length&&(n=t.options[t.selectedIndex].value),n;if("select-multiple"===o){n=[];for(var r=0,i=t.options.length;r<i;r++)t.options[r].selected&&n.push(t.options[r].value);return 0===n.length&&(n=null),n}return"file"===o&&"files"in t?(t.multiple?0===(n=qo.call(t.files)).length&&(n=null):n=t.files[0],n):(No[o]?t.checked&&(n=t.value):n=e?t.value.replace(zo,""):t.value,n)}Wo.getFieldData=Xo;var Go="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Ko=Z.Plugin,Yo=Io.default||Io,Jo=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Go(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));return r.type="acquirer",r.id="Form",r.title="Form",r.opts=$o({},{target:null,resultName:"uppyResult",getMetaFromForm:!0,addResultToForm:!0,submitOnSuccess:!1,triggerUploadOnSubmit:!1},o),r.handleFormSubmit=r.handleFormSubmit.bind(r),r.handleUploadStart=r.handleUploadStart.bind(r),r.handleSuccess=r.handleSuccess.bind(r),r.addResultToForm=r.addResultToForm.bind(r),r.getMetaFromForm=r.getMetaFromForm.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Go(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleUploadStart=function(){this.opts.getMetaFromForm&&this.getMetaFromForm()},e.prototype.handleSuccess=function(t){this.opts.addResultToForm&&this.addResultToForm(t),this.opts.submitOnSuccess&&this.form.submit()},e.prototype.handleFormSubmit=function(t){var e=this;this.opts.triggerUploadOnSubmit&&(t.preventDefault(),this.uppy.upload().catch(function(t){e.uppy.log(t.stack||t.message||t)}))},e.prototype.addResultToForm=function(t){this.uppy.log("[Form] Adding result to the original form:"),this.uppy.log(t);var e=this.form.querySelector('[name="'+this.opts.resultName+'"]');e?e.value=JSON.stringify(t):((e=document.createElement("input")).name=this.opts.resultName,e.type="hidden",e.value=JSON.stringify(t),this.form.appendChild(e))},e.prototype.getMetaFromForm=function(){var t=Yo(this.form);this.uppy.setMeta(t)},e.prototype.install=function(){this.form=M(this.opts.target),this.form&&"FORM"!==!this.form.nodeName?(this.form.addEventListener("submit",this.handleFormSubmit),this.uppy.on("upload",this.handleUploadStart),this.uppy.on("complete",this.handleSuccess)):console.error("Form plugin requires a <form> target element passed in options to operate, none was found","error")},e.prototype.uninstall=function(){this.form.removeEventListener("submit",this.handleFormSubmit),this.uppy.off("upload",this.handleUploadStart),this.uppy.off("complete",this.handleSuccess)},e}(Ko),Qo={},Zo=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},tr="undefined"!=typeof window&&(window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB),er=!!tr,nr="uppy-blobs",or="files",rr=864e5,ir=3;function sr(t){var e=tr.open(t,ir);return new Promise(function(t,n){e.onupgradeneeded=function(e){var n=e.target.result,o=e.currentTarget.transaction;if(e.oldVersion<2&&n.createObjectStore(or,{keyPath:"id"}).createIndex("store","store",{unique:!1}),e.oldVersion<3){var r=o.objectStore(or);r.createIndex("expires","expires",{unique:!1}),r.openCursor().onsuccess=function(t){var e=t.target.result;if(e){var n=e.value;n.expires=Date.now()+rr,e.update(n)}}}o.oncomplete=function(){t(n)}},e.onsuccess=function(e){t(e.target.result)},e.onerror=n})}function ar(t){return new Promise(function(e,n){t.onsuccess=function(t){e(t.target.result)},t.onerror=n})}var lr=!1,ur=function(){function t(e){var n=this;!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.opts=Zo({dbName:nr,storeName:"default",expires:rr,maxFileSize:10485760,maxTotalSize:314572800},e),this.name=this.opts.storeName;var o=function(){return sr(n.opts.dbName)};lr?this.ready=o():(lr=!0,this.ready=t.cleanup().then(o,o))}return t.prototype.key=function(t){return this.name+"!"+t},t.prototype.list=function(){var t=this;return this.ready.then(function(e){return ar(e.transaction([or],"readonly").objectStore(or).index("store").getAll(IDBKeyRange.only(t.name)))}).then(function(t){var e={};return t.forEach(function(t){e[t.fileID]=t.data}),e})},t.prototype.get=function(t){var e=this;return this.ready.then(function(n){return ar(n.transaction([or],"readonly").objectStore(or).get(e.key(t)))}).then(function(t){return{id:t.data.fileID,data:t.data.data}})},t.prototype.getSize=function(){var t=this;return this.ready.then(function(e){var n=e.transaction([or],"readonly").objectStore(or).index("store").openCursor(IDBKeyRange.only(t.name));return new Promise(function(t,e){var o=0;n.onsuccess=function(e){var n=e.target.result;n?(o+=n.value.data.size,n.continue()):t(o)},n.onerror=function(){e(new Error("Could not retrieve stored blobs size"))}})})},t.prototype.put=function(t){var e=this;return t.data.size>this.opts.maxFileSize?Promise.reject(new Error("File is too big to store.")):this.getSize().then(function(t){return t>e.opts.maxTotalSize?Promise.reject(new Error("No space left")):e.ready}).then(function(n){return ar(n.transaction([or],"readwrite").objectStore(or).add({id:e.key(t.id),fileID:t.id,store:e.name,expires:Date.now()+e.opts.expires,data:t.data}))})},t.prototype.delete=function(t){var e=this;return this.ready.then(function(n){return ar(n.transaction([or],"readwrite").objectStore(or).delete(e.key(t)))})},t.cleanup=function(){return sr(nr).then(function(t){var e=t.transaction([or],"readwrite").objectStore(or).index("expires").openCursor(IDBKeyRange.upperBound(Date.now()));return new Promise(function(n,o){e.onsuccess=function(e){var o=e.target.result;if(o){var r=o.value;console.log("[IndexedDBStore] Deleting record",r.fileID,"of size",R(r.data.size),"- expired on",new Date(r.expires)),o.delete(),o.continue()}else n(t)},e.onerror=o})}).then(function(t){t.close()})},t}();ur.isSupported=er,Qo=ur;var pr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};function cr(t){try{return JSON.parse(t)}catch(t){return null}}var fr=!1,dr=function(){function t(e){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.opts=pr({expires:864e5},e),this.name="uppyState:"+e.storeName,fr||(fr=!0,t.cleanup())}return t.prototype.load=function(){var t=localStorage.getItem(this.name);if(!t)return null;var e=cr(t);return e?e.metadata?e.metadata:(this.save(e),e):null},t.prototype.save=function(t){var e=Date.now()+this.opts.expires,n=JSON.stringify({metadata:t,expires:e});localStorage.setItem(this.name,n)},t.cleanup=function(){var t=function(){for(var t=[],e=0;e<localStorage.length;e++){var n=localStorage.key(e);/^uppyState:/.test(n)&&t.push(n.slice("uppyState:".length))}return t}(),e=Date.now();t.forEach(function(t){var n=localStorage.getItem("uppyState:"+t);if(!n)return null;var o=cr(n);if(!o)return null;o.expires&&o.expires<e&&localStorage.removeItem("uppyState:"+t)})},t}(),hr={},yr="undefined"!=typeof navigator&&"serviceWorker"in navigator,mr=function(){function t(e){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.ready=new Promise(function(t,e){yr?navigator.serviceWorker.controller?t():navigator.serviceWorker.addEventListener("controllerchange",function(){t()}):e(new Error("Unsupported"))}),this.name=e.storeName}return t.prototype.list=function(){var t=this,e={},n=new Promise(function(t,n){e.resolve=t,e.reject=n});console.log("Loading stored blobs from Service Worker");var o=function n(o){if(o.data.store===t.name)switch(o.data.type){case"uppy/ALL_FILES":e.resolve(o.data.files),navigator.serviceWorker.removeEventListener("message",n)}};return this.ready.then(function(){navigator.serviceWorker.addEventListener("message",o),navigator.serviceWorker.controller.postMessage({type:"uppy/GET_FILES",store:t.name})}),n},t.prototype.put=function(t){var e=this;return this.ready.then(function(){navigator.serviceWorker.controller.postMessage({type:"uppy/ADD_FILE",store:e.name,file:t})})},t.prototype.delete=function(t){var e=this;return this.ready.then(function(){navigator.serviceWorker.controller.postMessage({type:"uppy/REMOVE_FILE",store:e.name,fileID:t})})},t}();mr.isSupported=yr,hr=mr;var gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},br=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":gr(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));return r.type="debugger",r.id="GoldenRetriever",r.title="Golden Retriever",r.opts=vr({},{expires:864e5,serviceWorker:!1},o),r.MetaDataStore=new dr({expires:r.opts.expires,storeName:n.getID()}),r.ServiceWorkerStore=null,r.opts.serviceWorker&&(r.ServiceWorkerStore=new hr({storeName:n.getID()})),r.IndexedDBStore=new Qo(vr({expires:r.opts.expires},o.indexedDB||{},{storeName:n.getID()})),r.saveFilesStateToLocalStorage=r.saveFilesStateToLocalStorage.bind(r),r.loadFilesStateFromLocalStorage=r.loadFilesStateFromLocalStorage.bind(r),r.loadFileBlobsFromServiceWorker=r.loadFileBlobsFromServiceWorker.bind(r),r.loadFileBlobsFromIndexedDB=r.loadFileBlobsFromIndexedDB.bind(r),r.onBlobsLoaded=r.onBlobsLoaded.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":gr(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.loadFilesStateFromLocalStorage=function(){var t=this.MetaDataStore.load();t&&(this.uppy.log("[GoldenRetriever] Recovered some state from Local Storage"),this.uppy.setState({currentUploads:t.currentUploads||{},files:t.files||{}}),this.savedPluginData=t.pluginData)},e.prototype.getWaitingFiles=function(){var t={};return this.uppy.getFiles().forEach(function(e){e.progress&&e.progress.uploadStarted||(t[e.id]=e)}),t},e.prototype.getUploadingFiles=function(){var t=this,e={},n=this.uppy.getState().currentUploads;return n&&Object.keys(n).forEach(function(o){n[o].fileIDs.forEach(function(n){e[n]=t.uppy.getFile(n)})}),e},e.prototype.saveFilesStateToLocalStorage=function(){var t=vr(this.getWaitingFiles(),this.getUploadingFiles()),e={};this.uppy.emit("restore:get-data",function(t){vr(e,t)});var n=this.uppy.getState().currentUploads;this.MetaDataStore.save({currentUploads:n,files:t,pluginData:e})},e.prototype.loadFileBlobsFromServiceWorker=function(){var t=this;this.ServiceWorkerStore.list().then(function(e){var n=Object.keys(e).length;return n===t.uppy.getFiles().length?(t.uppy.log("[GoldenRetriever] Successfully recovered "+n+" blobs from Service Worker!"),t.uppy.info("Successfully recovered "+n+" files","success",3e3),t.onBlobsLoaded(e)):(t.uppy.log("[GoldenRetriever] No blobs found in Service Worker, trying IndexedDB now..."),t.loadFileBlobsFromIndexedDB())}).catch(function(e){t.uppy.log("[GoldenRetriever] Failed to recover blobs from Service Worker","warning"),t.uppy.log(e)})},e.prototype.loadFileBlobsFromIndexedDB=function(){var t=this;this.IndexedDBStore.list().then(function(e){var n=Object.keys(e).length;if(n>0)return t.uppy.log("[GoldenRetriever] Successfully recovered "+n+" blobs from IndexedDB!"),t.uppy.info("Successfully recovered "+n+" files","success",3e3),t.onBlobsLoaded(e);t.uppy.log("[GoldenRetriever] No blobs found in IndexedDB")}).catch(function(e){t.uppy.log("[GoldenRetriever] Failed to recover blobs from IndexedDB","warning"),t.uppy.log(e)})},e.prototype.onBlobsLoaded=function(t){var e=this,n=[],o=vr({},this.uppy.getState().files);Object.keys(t).forEach(function(r){var i=e.uppy.getFile(r);if(i){var s=t[r],a=vr({},i,{data:s,isRestored:!0});o[r]=a}else n.push(r)}),this.uppy.setState({files:o}),this.uppy.emit("restored",this.savedPluginData),n.length&&this.deleteBlobs(n).then(function(){e.uppy.log("[GoldenRetriever] Cleaned up "+n.length+" old files")}).catch(function(t){e.uppy.log("[GoldenRetriever] Could not clean up "+n.length+" old files","warning"),e.uppy.log(t)})},e.prototype.deleteBlobs=function(t){var e=this,n=[];return t.forEach(function(t){e.ServiceWorkerStore&&n.push(e.ServiceWorkerStore.delete(t)),e.IndexedDBStore&&n.push(e.IndexedDBStore.delete(t))}),Promise.all(n)},e.prototype.install=function(){var t=this;this.loadFilesStateFromLocalStorage(),this.uppy.getFiles().length>0?this.ServiceWorkerStore?(this.uppy.log("[GoldenRetriever] Attempting to load files from Service Worker..."),this.loadFileBlobsFromServiceWorker()):(this.uppy.log("[GoldenRetriever] Attempting to load files from Indexed DB..."),this.loadFileBlobsFromIndexedDB()):(this.uppy.log("[GoldenRetriever] No files need to be loaded, only restoring processing state..."),this.onBlobsLoaded([])),this.uppy.on("file-added",function(e){e.isRemote||(t.ServiceWorkerStore&&t.ServiceWorkerStore.put(e).catch(function(e){t.uppy.log("[GoldenRetriever] Could not store file","warning"),t.uppy.log(e)}),t.IndexedDBStore.put(e).catch(function(e){t.uppy.log("[GoldenRetriever] Could not store file","warning"),t.uppy.log(e)}))}),this.uppy.on("file-removed",function(e){t.ServiceWorkerStore&&t.ServiceWorkerStore.delete(e.id).catch(function(e){t.uppy.log("[GoldenRetriever] Failed to remove file","warning"),t.uppy.log(e)}),t.IndexedDBStore.delete(e.id).catch(function(e){t.uppy.log("[GoldenRetriever] Failed to remove file","warning"),t.uppy.log(e)})}),this.uppy.on("complete",function(e){var n=e.successful,o=n.map(function(t){return t.id});t.deleteBlobs(o).then(function(){t.uppy.log("[GoldenRetriever] Removed "+n.length+" files that finished uploading")}).catch(function(e){t.uppy.log("[GoldenRetriever] Could not remove "+n.length+" files that finished uploading","warning"),t.uppy.log(e)})}),this.uppy.on("state-update",this.saveFilesStateToLocalStorage),this.uppy.on("restored",function(){var e=t.uppy.getState().currentUploads;e&&Object.keys(e).forEach(function(n){t.uppy.restore(n,e[n])})})},e}(Z.Plugin),wr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Sr=function(t){function e(){return function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":wr(e))&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":wr(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.toggleCheckbox=function(e,n){e.stopPropagation(),e.preventDefault(),n.custom.isTeamDrive||t.prototype.toggleCheckbox.call(this,e,n)},e}(Fo),_r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cr=Z.Plugin,Pr=m.Provider,Er=D.h,Fr=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_r(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));return r.id=r.opts.id||"GoogleDrive",r.title=r.opts.title||"Google Drive",Pr.initPlugin(r,o),r.title=r.opts.title||"Google Drive",r.icon=function(){return Er("svg",{"aria-hidden":"true",width:"18px",height:"16px",viewBox:"0 0 18 16",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},Er("g",{"fill-rule":"evenodd"},Er("polygon",{fill:"#3089FC",points:"6.32475 10.2 18 10.2 14.999625 15.3 3.324375 15.3"}),Er("polygon",{fill:"#00A85D",points:"3.000375 15.3 0 10.2 5.83875 0.275974026 8.838 5.37597403 5.999625 10.2"}),Er("polygon",{fill:"#FFD024",points:"11.838375 9.92402597 5.999625 0 12.000375 0 17.839125 9.92402597"})))},r[r.id]=new Pr(n,{serverUrl:r.opts.serverUrl,serverHeaders:r.opts.serverHeaders,provider:"drive",authProvider:"google"}),r.onAuth=r.onAuth.bind(r),r.render=r.render.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_r(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.install=function(){this.view=new Sr(this),this.setPluginState({authenticated:!1,files:[],folders:[],directories:[],activeRow:-1,filterInput:"",isSearchVisible:!1,hasTeamDrives:!1,teamDrives:[],teamDriveId:""});var t=this.opts.target;t&&this.mount(t,this)},e.prototype.uninstall=function(){this.view.tearDown(),this.unmount()},e.prototype.onAuth=function(t){this.setPluginState({authenticated:t}),t&&this.view.getFolder("root","/")},e.prototype.render=function(t){return this.view.render(t)},e}(Cr),kr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Or=Z.Plugin,Tr=m.Provider,Ar=D.h,Ur=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":kr(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));return r.id=r.opts.id||"Instagram",Tr.initPlugin(r,o),r.title=r.opts.title||"Instagram",r.icon=function(){return Ar("svg",{"aria-hidden":"true",fill:"#DE3573",width:"28",height:"28",viewBox:"0 0 512 512"},Ar("path",{d:"M256,49.471c67.266,0,75.233.257,101.8,1.469,24.562,1.121,37.9,5.224,46.778,8.674a78.052,78.052,0,0,1,28.966,18.845,78.052,78.052,0,0,1,18.845,28.966c3.45,8.877,7.554,22.216,8.674,46.778,1.212,26.565,1.469,34.532,1.469,101.8s-0.257,75.233-1.469,101.8c-1.121,24.562-5.225,37.9-8.674,46.778a83.427,83.427,0,0,1-47.811,47.811c-8.877,3.45-22.216,7.554-46.778,8.674-26.56,1.212-34.527,1.469-101.8,1.469s-75.237-.257-101.8-1.469c-24.562-1.121-37.9-5.225-46.778-8.674a78.051,78.051,0,0,1-28.966-18.845,78.053,78.053,0,0,1-18.845-28.966c-3.45-8.877-7.554-22.216-8.674-46.778-1.212-26.564-1.469-34.532-1.469-101.8s0.257-75.233,1.469-101.8c1.121-24.562,5.224-37.9,8.674-46.778A78.052,78.052,0,0,1,78.458,78.458a78.053,78.053,0,0,1,28.966-18.845c8.877-3.45,22.216-7.554,46.778-8.674,26.565-1.212,34.532-1.469,101.8-1.469m0-45.391c-68.418,0-77,.29-103.866,1.516-26.815,1.224-45.127,5.482-61.151,11.71a123.488,123.488,0,0,0-44.62,29.057A123.488,123.488,0,0,0,17.3,90.982C11.077,107.007,6.819,125.319,5.6,152.134,4.369,179,4.079,187.582,4.079,256S4.369,333,5.6,359.866c1.224,26.815,5.482,45.127,11.71,61.151a123.489,123.489,0,0,0,29.057,44.62,123.486,123.486,0,0,0,44.62,29.057c16.025,6.228,34.337,10.486,61.151,11.71,26.87,1.226,35.449,1.516,103.866,1.516s77-.29,103.866-1.516c26.815-1.224,45.127-5.482,61.151-11.71a128.817,128.817,0,0,0,73.677-73.677c6.228-16.025,10.486-34.337,11.71-61.151,1.226-26.87,1.516-35.449,1.516-103.866s-0.29-77-1.516-103.866c-1.224-26.815-5.482-45.127-11.71-61.151a123.486,123.486,0,0,0-29.057-44.62A123.487,123.487,0,0,0,421.018,17.3C404.993,11.077,386.681,6.819,359.866,5.6,333,4.369,324.418,4.079,256,4.079h0Z"}),Ar("path",{d:"M256,126.635A129.365,129.365,0,1,0,385.365,256,129.365,129.365,0,0,0,256,126.635Zm0,213.338A83.973,83.973,0,1,1,339.974,256,83.974,83.974,0,0,1,256,339.973Z"}),Ar("circle",{cx:"390.476",cy:"121.524",r:"30.23"}))},r[r.id]=new Tr(n,{serverUrl:r.opts.serverUrl,serverHeaders:r.opts.serverHeaders,provider:"instagram",authProvider:"instagram"}),r.onAuth=r.onAuth.bind(r),r.render=r.render.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":kr(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.install=function(){this.view=new Fo(this,{viewType:"grid",showTitles:!1,showFilter:!1,showBreadcrumbs:!1}),this.setPluginState({authenticated:!1,files:[],folders:[],directories:[],activeRow:-1,filterInput:"",isSearchVisible:!1});var t=this.opts.target;t&&this.mount(t,this)},e.prototype.uninstall=function(){this.view.tearDown(),this.unmount()},e.prototype.onAuth=function(t){this.setPluginState({authenticated:t}),t&&this.view.getFolder("recent")},e.prototype.render=function(t){return this.view.render(t)},e}(Or),xr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rr=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Dr=Z.Plugin,jr=D.h,Br=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":xr(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));return r.id=r.opts.id||"ProgressBar",r.title="Progress Bar",r.type="progressindicator",r.opts=Rr({},{target:"body",replaceTargetContent:!1,fixed:!1,hideAfterFinish:!0},o),r.render=r.render.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":xr(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.render=function(t){var e=t.totalProgress||0,n=100===e&&this.opts.hideAfterFinish;return jr("div",{class:"uppy uppy-ProgressBar",style:{position:this.opts.fixed?"fixed":"initial"},"aria-hidden":n},jr("div",{class:"uppy-ProgressBar-inner",style:{width:e+"%"}}),jr("div",{class:"uppy-ProgressBar-percentage"},e))},e.prototype.install=function(){var t=this.opts.target;t&&this.mount(t,this)},e.prototype.uninstall=function(){this.unmount()},e}(Dr),Ir=Object.getOwnPropertySymbols,Mr=Object.prototype.hasOwnProperty,Lr=Object.prototype.propertyIsEnumerable,Nr=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach(function(t){o[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,o,r=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),i=1;i<arguments.length;i++){for(var s in n=Object(arguments[i]))Mr.call(n,s)&&(r[s]=n[s]);if(Ir){o=Ir(n);for(var a=0;a<o.length;a++)Lr.call(n,o[a])&&(r[o[a]]=n[o[a]])}}return r},zr="function"==typeof Symbol&&Symbol.for,qr=zr?Symbol.for("react.element"):60103,Hr=zr?Symbol.for("react.portal"):60106,Wr=zr?Symbol.for("react.fragment"):60107,Xr=zr?Symbol.for("react.strict_mode"):60108,Vr=zr?Symbol.for("react.profiler"):60114,Gr=zr?Symbol.for("react.provider"):60109,$r=zr?Symbol.for("react.context"):60110,Kr=zr?Symbol.for("react.concurrent_mode"):60111,Yr=zr?Symbol.for("react.forward_ref"):60112,Jr=zr?Symbol.for("react.suspense"):60113,Qr=zr?Symbol.for("react.memo"):60115,Zr=zr?Symbol.for("react.lazy"):60116,ti="function"==typeof Symbol&&Symbol.iterator;function ei(t){for(var e=arguments.length-1,n="https://reactjs.org/docs/error-decoder.html?invariant="+t,o=0;o<e;o++)n+="&args[]="+encodeURIComponent(arguments[o+1]);!function(t,e,n,o,r,i,s,a){if(!t){if(t=void 0,void 0===e)t=Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,void 0,void 0,void 0,void 0,void 0],u=0;(t=Error(e.replace(/%s/g,function(){return l[u++]}))).name="Invariant Violation"}throw t.framesToPop=1,t}}(!1,"Minified React error #"+t+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}var ni={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},oi={};function ri(t,e,n){this.props=t,this.context=e,this.refs=oi,this.updater=n||ni}function ii(){}function si(t,e,n){this.props=t,this.context=e,this.refs=oi,this.updater=n||ni}ri.prototype.isReactComponent={},ri.prototype.setState=function(t,e){"object"!=typeof t&&"function"!=typeof t&&null!=t&&ei("85"),this.updater.enqueueSetState(this,t,e,"setState")},ri.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},ii.prototype=ri.prototype;var ai=si.prototype=new ii;ai.constructor=si,Nr(ai,ri.prototype),ai.isPureReactComponent=!0;var li={current:null,currentDispatcher:null},ui=Object.prototype.hasOwnProperty,pi={key:!0,ref:!0,__self:!0,__source:!0};function ci(t,e,n){var o=void 0,r={},i=null,s=null;if(null!=e)for(o in void 0!==e.ref&&(s=e.ref),void 0!==e.key&&(i=""+e.key),e)ui.call(e,o)&&!pi.hasOwnProperty(o)&&(r[o]=e[o]);var a=arguments.length-2;if(1===a)r.children=n;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(o in a=t.defaultProps)void 0===r[o]&&(r[o]=a[o]);return{$$typeof:qr,type:t,key:i,ref:s,props:r,_owner:li.current}}function fi(t){return"object"==typeof t&&null!==t&&t.$$typeof===qr}var di=/\/+/g,hi=[];function yi(t,e,n,o){if(hi.length){var r=hi.pop();return r.result=t,r.keyPrefix=e,r.func=n,r.context=o,r.count=0,r}return{result:t,keyPrefix:e,func:n,context:o,count:0}}function mi(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>hi.length&&hi.push(t)}function gi(t,e,n){return null==t?0:function t(e,n,o,r){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var s=!1;if(null===e)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case qr:case Hr:s=!0}}if(s)return o(r,e,""===n?"."+vi(e,0):n),1;if(s=0,n=""===n?".":n+":",Array.isArray(e))for(var a=0;a<e.length;a++){var l=n+vi(i=e[a],a);s+=t(i,l,o,r)}else if("function"==typeof(l=null===e||"object"!=typeof e?null:"function"==typeof(l=ti&&e[ti]||e["@@iterator"])?l:null))for(e=l.call(e),a=0;!(i=e.next()).done;)s+=t(i=i.value,l=n+vi(i,a++),o,r);else"object"===i&&ei("31","[object Object]"==(o=""+e)?"object with keys {"+Object.keys(e).join(", ")+"}":o,"");return s}(t,"",e,n)}function vi(t,e){return"object"==typeof t&&null!==t&&null!=t.key?function(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,function(t){return e[t]})}(t.key):e.toString(36)}function bi(t,e){t.func.call(t.context,e,t.count++)}function wi(t,e,n){var o=t.result,r=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?Si(t,o,n,function(t){return t}):null!=t&&(fi(t)&&(t=function(t,e){return{$$typeof:qr,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}(t,r+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(di,"$&/")+"/")+n)),o.push(t))}function Si(t,e,n,o,r){var i="";null!=n&&(i=(""+n).replace(di,"$&/")+"/"),gi(t,wi,e=yi(e,i,o,r)),mi(e)}var _i={Children:{map:function(t,e,n){if(null==t)return t;var o=[];return Si(t,o,null,e,n),o},forEach:function(t,e,n){if(null==t)return t;gi(t,bi,e=yi(null,null,e,n)),mi(e)},count:function(t){return gi(t,function(){return null},null)},toArray:function(t){var e=[];return Si(t,e,null,function(t){return t}),e},only:function(t){return fi(t)||ei("143"),t}},createRef:function(){return{current:null}},Component:ri,PureComponent:si,createContext:function(t,e){return void 0===e&&(e=null),(t={$$typeof:$r,_calculateChangedBits:e,_currentValue:t,_currentValue2:t,Provider:null,Consumer:null}).Provider={$$typeof:Gr,_context:t},t.Consumer=t},forwardRef:function(t){return{$$typeof:Yr,render:t}},lazy:function(t){return{$$typeof:Zr,_ctor:t,_status:-1,_result:null}},memo:function(t,e){return{$$typeof:Qr,type:t,compare:void 0===e?null:e}},Fragment:Wr,StrictMode:Xr,unstable_ConcurrentMode:Kr,Suspense:Jr,unstable_Profiler:Vr,createElement:ci,cloneElement:function(t,e,n){null==t&&ei("267",t);var o=void 0,r=Nr({},t.props),i=t.key,s=t.ref,a=t._owner;if(null!=e){void 0!==e.ref&&(s=e.ref,a=li.current),void 0!==e.key&&(i=""+e.key);var l=void 0;for(o in t.type&&t.type.defaultProps&&(l=t.type.defaultProps),e)ui.call(e,o)&&!pi.hasOwnProperty(o)&&(r[o]=void 0===e[o]&&void 0!==l?l[o]:e[o])}if(1==(o=arguments.length-2))r.children=n;else if(1<o){l=Array(o);for(var u=0;u<o;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:qr,type:t.type,key:i,ref:s,props:r,_owner:a}},createFactory:function(t){var e=ci.bind(null,t);return e.type=t,e},isValidElement:fi,version:"16.6.0",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:li,assign:Nr}},Ci={default:_i},Pi=Ci&&_i||Ci,Ei=Pi.default||Pi,Fi="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";function ki(){}var Oi,Ti=function(){function t(t,e,n,o,r,i){if(i!==Fi){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function e(){return t}t.isRequired=t;var n={array:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:e,element:t,instanceOf:e,node:t,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e};return n.checkPropTypes=ki,n.PropTypes=n,n}(),Ai=Ti.any,Ui=Ti.arrayOf(Ti.string),xi=Ti.shape({strings:Ti.object,pluralize:Ti.func}),Ri=Ti.shape({id:Ti.string.isRequired,name:Ti.string.isRequired,placeholder:Ti.string}),Di=Ti.arrayOf(Ri),ji=Ti.oneOfType([Ti.string,Ti.number]),Bi={uppy:Ai,locale:xi,dashboard:{uppy:Ai,inline:Ti.bool,plugins:Ui,width:ji,height:ji,showProgressDetails:Ti.bool,hideUploadButton:Ti.bool,hideProgressAfterFinish:Ti.bool,note:Ti.string,metaFields:Di,proudlyDisplayPoweredByUppy:Ti.bool,disableStatusBar:Ti.bool,disableInformer:Ti.bool,disableThumbnailGenerator:Ti.bool,locale:xi}},Ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Mi=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Li=Bi.dashboard,Ni=Ei.createElement,zi=function(t){function e(){return function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Ii(e))&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Ii(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentDidMount=function(){var t=this.props.uppy,e=Mi({id:"react:Dashboard"},this.props,{target:this.container});delete e.uppy,t.use(Xn,e),this.plugin=t.getPlugin(e.id)},e.prototype.componentWillUnmount=function(){this.props.uppy.removePlugin(this.plugin)},e.prototype.render=function(){var t=this;return Ni("div",{ref:function(e){t.container=e}})},e}(Ei.Component);zi.propTypes=Li,zi.defaultProps={inline:!0},Oi=zi;var qi,Hi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wi=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Xi=Bi.dashboard,Vi=Ei.createElement,Gi=function(t){function e(){return function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Hi(e))&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Hi(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentDidMount=function(){var t=this.props.uppy,e=Wi({id:"react:DashboardModal"},this.props,{onRequestCloseModal:this.props.onRequestClose});e.target||(e.target=this.container),delete e.uppy,t.use(Xn,e),this.plugin=t.getPlugin(e.id),this.props.open&&this.plugin.openModal()},e.prototype.componentWillUnmount=function(){this.props.uppy.removePlugin(this.plugin)},e.prototype.componentWillReceiveProps=function(t){this.props.open&&!t.open?this.plugin.closeModal():!this.props.open&&t.open&&this.plugin.openModal()},e.prototype.render=function(){var t=this;return Vi("div",{ref:function(e){t.container=e}})},e}(Ei.Component);Gi.propTypes=Wi({target:"undefined"!=typeof window?Ti.instanceOf(window.HTMLElement):Ti.any,open:Ti.bool,onRequestClose:Ti.func,closeModalOnClickOutside:Ti.bool,disablePageScrollWhenModalOpen:Ti.bool},Xi),Gi.defaultProps={},qi=Gi;var $i,Ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yi=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Ji=Ei.createElement,Qi=function(t){function e(){return function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Ki(e))&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Ki(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentDidMount=function(){var t=this.props.uppy,e=Yi({id:"react:DragDrop"},this.props,{target:this.container});delete e.uppy,t.use(Yn,e),this.plugin=t.getPlugin(e.id)},e.prototype.componentWillUnmount=function(){this.props.uppy.removePlugin(this.plugin)},e.prototype.render=function(){var t=this;return Ji("div",{ref:function(e){t.container=e}})},e}(Ei.Component);Qi.propTypes={uppy:Bi.uppy,locale:Bi.locale},Qi.defaultProps={},$i=Qi;var Zi,ts="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},es=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},ns=Bi.uppy,os=Ei.createElement,rs=function(t){function e(){return function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":ts(e))&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":ts(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentDidMount=function(){var t=this.props.uppy,e=es({id:"react:ProgressBar"},this.props,{target:this.container});delete e.uppy,t.use(Br,e),this.plugin=t.getPlugin(e.id)},e.prototype.componentWillUnmount=function(){this.props.uppy.removePlugin(this.plugin)},e.prototype.render=function(){var t=this;return os("div",{ref:function(e){t.container=e}})},e}(Ei.Component);rs.propTypes={uppy:ns,fixed:Ti.bool,hideAfterFinish:Ti.bool},rs.defaultProps={},Zi=rs;var is,ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},as=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},ls=Bi.uppy,us=Ei.createElement,ps=function(t){function e(){return function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":ss(e))&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":ss(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentDidMount=function(){var t=this.props.uppy,e=as({id:"react:StatusBar"},this.props,{target:this.container});delete e.uppy,t.use(Tn,e),this.plugin=t.getPlugin(e.id)},e.prototype.componentWillUnmount=function(){this.props.uppy.removePlugin(this.plugin)},e.prototype.render=function(){var t=this;return us("div",{ref:function(e){t.container=e}})},e}(Ei.Component);ps.propTypes={uppy:ls,hideAfterFinish:Ti.bool,showProgressDetails:Ti.bool},ps.defaultProps={},is=ps;var cs={};cs.Dashboard=Oi,cs.DashboardModal=qi,cs.DragDrop=$i,cs.ProgressBar=Zi,cs.StatusBar=is;var fs,ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hs=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},ys=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":ds(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));return r.type="debugger",r.id="ReduxDevTools",r.title="Redux DevTools",r.opts=hs({},{},o),r.handleStateChange=r.handleStateChange.bind(r),r.initDevTools=r.initDevTools.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":ds(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleStateChange=function(t,e,n){this.devTools.send("UPPY_STATE_UPDATE",e)},e.prototype.initDevTools=function(){var t=this;this.devTools=window.devToolsExtension.connect(),this.devToolsUnsubscribe=this.devTools.subscribe(function(e){if("DISPATCH"===e.type)switch(console.log(e.payload.type),e.payload.type){case"RESET":return void t.uppy.reset();case"IMPORT_STATE":var n=e.payload.nextLiftedState.computedStates;return t.uppy.store.state=hs({},t.uppy.getState(),n[n.length-1].state),void t.uppy.updateAll(t.uppy.getState());case"JUMP_TO_STATE":case"JUMP_TO_ACTION":t.uppy.store.state=hs({},t.uppy.getState(),JSON.parse(e.state)),t.uppy.updateAll(t.uppy.getState())}})},e.prototype.install=function(){this.withDevTools="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__,this.withDevTools&&(this.initDevTools(),this.uppy.on("state-update",this.handleStateChange))},e.prototype.uninstall=function(){this.withDevTools&&(this.devToolsUnsubscribe(),this.uppy.off("state-update",this.handleStateUpdate))},e}(Z.Plugin),ms=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},gs=function(t){return function(e){return e.uppy[t]}},vs=function(){function t(e){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this._store=e.store,this._id=e.id||_(),this._selector=e.selector||gs(this._id),this.setState({})}return t.prototype.setState=function(t){this._store.dispatch({type:"uppy/STATE_UPDATE",id:this._id,payload:t})},t.prototype.getState=function(){return this._selector(this._store.getState())},t.prototype.subscribe=function(t){var e=this,n=this.getState();return this._store.subscribe(function(){var o=e.getState();if(n!==o){var r=function(t,e){var n=Object.keys(e),o={};return n.forEach(function(n){t[n]!==e[n]&&(o[n]=e[n])}),o}(n,o);t(n,o,r),n=o}})},t}();(fs=function(t){return new vs(t)}).STATE_UPDATE="uppy/STATE_UPDATE",fs.reducer=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments[1];if("uppy/STATE_UPDATE"===e.type){var n,o=ms({},t[e.id],e.payload);return ms({},t,((n={})[e.id]=o,n))}return t},fs.middleware=function(){return function(){return function(t){return function(e){t(e)}}}};var bs={exports:{}};function ws(t){if(t)return function(t){for(var e in ws.prototype)t[e]=ws.prototype[e];return t}(t)}bs.exports=ws,ws.prototype.on=ws.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},ws.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},ws.prototype.off=ws.prototype.removeListener=ws.prototype.removeAllListeners=ws.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,o=this._callbacks["$"+t];if(!o)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var r=0;r<o.length;r++)if((n=o[r])===e||n.fn===e){o.splice(r,1);break}return this},ws.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),n=this._callbacks["$"+t];if(n)for(var o=0,r=(n=n.slice(0)).length;o<r;++o)n[o].apply(this,e);return this},ws.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},ws.prototype.hasListeners=function(t){return!!this.listeners(t).length},bs=bs.exports;var Ss={};function _s(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Ss=_s,_s.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},_s.prototype.reset=function(){this.attempts=0},_s.prototype.setMin=function(t){this.ms=t},_s.prototype.setMax=function(t){this.max=t},_s.prototype.setJitter=function(t){this.jitter=t};var Cs=[].slice,Ps=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var n=Cs.call(arguments,2);return function(){return e.apply(t,n.concat(Cs.call(arguments)))}};function Es(){}var Fs=function(t,e,n){var o=!1;return n=n||Es,r.count=t,0===t?e():r;function r(t,i){if(r.count<=0)throw new Error("after called too many times");--r.count,t?(o=!0,e(t),e=n):0!==r.count||o||e(null,i)}},ks=function(t,e,n){var o=t.byteLength;if(e=e||0,n=n||o,t.slice)return t.slice(e,n);if(e<0&&(e+=o),n<0&&(n+=o),n>o&&(n=o),e>=o||e>=n||0===o)return new ArrayBuffer(0);for(var r=new Uint8Array(t),i=new Uint8Array(n-e),s=e,a=0;s<n;s++,a++)i[a]=r[s];return i.buffer},Os={};!function(){"use strict";for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=new Uint8Array(256),n=0;n<t.length;n++)e[t.charCodeAt(n)]=n;Os.encode=function(e){var n,o=new Uint8Array(e),r=o.length,i="";for(n=0;n<r;n+=3)i+=t[o[n]>>2],i+=t[(3&o[n])<<4|o[n+1]>>4],i+=t[(15&o[n+1])<<2|o[n+2]>>6],i+=t[63&o[n+2]];return r%3==2?i=i.substring(0,i.length-1)+"=":r%3==1&&(i=i.substring(0,i.length-2)+"=="),i},Os.decode=function(t){var n,o,r,i,s,a=.75*t.length,l=t.length,u=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var p=new ArrayBuffer(a),c=new Uint8Array(p);for(n=0;n<l;n+=4)o=e[t.charCodeAt(n)],r=e[t.charCodeAt(n+1)],i=e[t.charCodeAt(n+2)],s=e[t.charCodeAt(n+3)],c[u++]=o<<2|r>>4,c[u++]=(15&r)<<4|i>>2,c[u++]=(3&i)<<6|63&s;return p}}();var Ts={},As=void 0!==As?As:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,Us=function(){try{return 2===new Blob(["hi"]).size}catch(t){return!1}}(),xs=Us&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(t){return!1}}(),Rs=As&&As.prototype.append&&As.prototype.getBlob;function Ds(t){return t.map(function(t){if(t.buffer instanceof ArrayBuffer){var e=t.buffer;if(t.byteLength!==e.byteLength){var n=new Uint8Array(t.byteLength);n.set(new Uint8Array(e,t.byteOffset,t.byteLength)),e=n.buffer}return e}return t})}function js(t,e){e=e||{};var n=new As;return Ds(t).forEach(function(t){n.append(t)}),e.type?n.getBlob(e.type):n.getBlob()}function Bs(t,e){return new Blob(Ds(t),e||{})}"undefined"!=typeof Blob&&(js.prototype=Blob.prototype,Bs.prototype=Blob.prototype),Ts=Us?xs?Blob:Bs:Rs?js:void 0;var Is,Ms,Ls,Ns=Object.keys||function(t){var e=[],n=Object.prototype.hasOwnProperty;for(var o in t)n.call(t,o)&&e.push(o);return e},zs=String.fromCharCode;function qs(t){for(var e,n,o=[],r=0,i=t.length;r<i;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<i?56320==(64512&(n=t.charCodeAt(r++)))?o.push(((1023&e)<<10)+(1023&n)+65536):(o.push(e),r--):o.push(e);return o}function Hs(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function Ws(t,e){return zs(t>>e&63|128)}function Xs(t,e){if(0==(4294967168&t))return zs(t);var n="";return 0==(4294965248&t)?n=zs(t>>6&31|192):0==(4294901760&t)?(Hs(t,e)||(t=65533),n=zs(t>>12&15|224),n+=Ws(t,6)):0==(4292870144&t)&&(n=zs(t>>18&7|240),n+=Ws(t,12),n+=Ws(t,6)),n+zs(63&t|128)}function Vs(){if(Ls>=Ms)throw Error("Invalid byte index");var t=255&Is[Ls];if(Ls++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function Gs(t){var e,n;if(Ls>Ms)throw Error("Invalid byte index");if(Ls==Ms)return!1;if(e=255&Is[Ls],Ls++,0==(128&e))return e;if(192==(224&e)){if((n=(31&e)<<6|Vs())>=128)return n;throw Error("Invalid continuation byte")}if(224==(240&e)){if((n=(15&e)<<12|Vs()<<6|Vs())>=2048)return Hs(n,t)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&(n=(7&e)<<18|Vs()<<12|Vs()<<6|Vs())>=65536&&n<=1114111)return n;throw Error("Invalid UTF-8 detected")}for(var $s=function(t,e){for(var n=!1!==(e=e||{}).strict,o=qs(t),r=o.length,i=-1,s="";++i<r;)s+=Xs(o[i],n);return s},Ks=function(t,e){var n=!1!==(e=e||{}).strict;Is=qs(t),Ms=Is.length,Ls=0;for(var o,r=[];!1!==(o=Gs(n));)r.push(o);return function(t){for(var e,n=t.length,o=-1,r="";++o<n;)(e=t[o])>65535&&(r+=zs((e-=65536)>>>10&1023|55296),e=56320|1023&e),r+=zs(e);return r}(r)},Ys={toByteArray:function(t){for(var e,n=oa(t),o=n[0],r=n[1],i=new Zs(function(t,e,n){return 3*(e+n)/4-n}(0,o,r)),s=0,a=r>0?o-4:o,l=0;l<a;l+=4)e=Qs[t.charCodeAt(l)]<<18|Qs[t.charCodeAt(l+1)]<<12|Qs[t.charCodeAt(l+2)]<<6|Qs[t.charCodeAt(l+3)],i[s++]=e>>16&255,i[s++]=e>>8&255,i[s++]=255&e;return 2===r&&(e=Qs[t.charCodeAt(l)]<<2|Qs[t.charCodeAt(l+1)]>>4,i[s++]=255&e),1===r&&(e=Qs[t.charCodeAt(l)]<<10|Qs[t.charCodeAt(l+1)]<<4|Qs[t.charCodeAt(l+2)]>>2,i[s++]=e>>8&255,i[s++]=255&e),i},fromByteArray:function(t){for(var e,n=t.length,o=n%3,r=[],i=0,s=n-o;i<s;i+=16383)r.push(ra(t,i,i+16383>s?s:i+16383));return 1===o?(e=t[n-1],r.push(Js[e>>2]+Js[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],r.push(Js[e>>10]+Js[e>>4&63]+Js[e<<2&63]+"=")),r.join("")}},Js=[],Qs=[],Zs="undefined"!=typeof Uint8Array?Uint8Array:Array,ta="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ea=0,na=ta.length;ea<na;++ea)Js[ea]=ta[ea],Qs[ta.charCodeAt(ea)]=ea;function oa(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function ra(t,e,n){for(var o,r,i=[],s=e;s<n;s+=3)o=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),i.push(Js[(r=o)>>18&63]+Js[r>>12&63]+Js[r>>6&63]+Js[63&r]);return i.join("")}Qs["-".charCodeAt(0)]=62,Qs["_".charCodeAt(0)]=63;var ia={read:function(t,e,n,o,r){var i,s,a=8*r-o-1,l=(1<<a)-1,u=l>>1,p=-7,c=n?r-1:0,f=n?-1:1,d=t[e+c];for(c+=f,i=d&(1<<-p)-1,d>>=-p,p+=a;p>0;i=256*i+t[e+c],c+=f,p-=8);for(s=i&(1<<-p)-1,i>>=-p,p+=o;p>0;s=256*s+t[e+c],c+=f,p-=8);if(0===i)i=1-u;else{if(i===l)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,o),i-=u}return(d?-1:1)*s*Math.pow(2,i-o)},write:function(t,e,n,o,r,i){var s,a,l,u=8*i-r-1,p=(1<<u)-1,c=p>>1,f=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,d=o?0:i-1,h=o?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=p):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+c>=1?f/l:f*Math.pow(2,1-c))*l>=2&&(s++,l/=2),s+c>=p?(a=0,s=p):s+c>=1?(a=(e*l-1)*Math.pow(2,r),s+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,r),s=0));r>=8;t[n+d]=255&a,d+=h,a/=256,r-=8);for(s=s<<r|a,u+=r;u>0;t[n+d]=255&s,d+=h,s/=256,u-=8);t[n+d-h]|=128*y}},sa={};sa.Buffer=ua,sa.INSPECT_MAX_BYTES=50;var aa=2147483647;function la(t){if(t>aa)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return e.__proto__=ua.prototype,e}function ua(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return fa(t)}return pa(t,e,n)}function pa(t,e,n){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!ua.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var n=0|ya(t,e),o=la(n),r=o.write(t,e);return r!==n&&(o=o.slice(0,r)),o}(t,e);if(ArrayBuffer.isView(t))return da(t);if(null==t)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(za(t,ArrayBuffer)||t&&za(t.buffer,ArrayBuffer))return function(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');var o;return(o=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n)).__proto__=ua.prototype,o}(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var o=t.valueOf&&t.valueOf();if(null!=o&&o!==t)return ua.from(o,e,n);var r=function(t){if(ua.isBuffer(t)){var e=0|ha(t.length),n=la(e);return 0===n.length?n:(t.copy(n,0,0,e),n)}return void 0!==t.length?"number"!=typeof t.length||qa(t.length)?la(0):da(t):"Buffer"===t.type&&Array.isArray(t.data)?da(t.data):void 0}(t);if(r)return r;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return ua.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function ca(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function fa(t){return ca(t),la(t<0?0:0|ha(t))}function da(t){for(var e=t.length<0?0:0|ha(t.length),n=la(e),o=0;o<e;o+=1)n[o]=255&t[o];return n}function ha(t){if(t>=aa)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+aa.toString(16)+" bytes");return 0|t}function ya(t,e){if(ua.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||za(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var n=t.length,o=arguments.length>2&&!0===arguments[2];if(!o&&0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return Ma(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return La(t).length;default:if(r)return o?-1:Ma(t).length;e=(""+e).toLowerCase(),r=!0}}function ma(t,e,n){var o=t[e];t[e]=t[n],t[n]=o}function ga(t,e,n,o,r){if(0===t.length)return-1;if("string"==typeof n?(o=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),qa(n=+n)&&(n=r?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(r)return-1;n=t.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof e&&(e=ua.from(e,o)),ua.isBuffer(e))return 0===e.length?-1:va(t,e,n,o,r);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):va(t,[e],n,o,r);throw new TypeError("val must be string, number or Buffer")}function va(t,e,n,o,r){var i,s=1,a=t.length,l=e.length;if(void 0!==o&&("ucs2"===(o=String(o).toLowerCase())||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(t.length<2||e.length<2)return-1;s=2,a/=2,l/=2,n/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(r){var p=-1;for(i=n;i<a;i++)if(u(t,i)===u(e,-1===p?0:i-p)){if(-1===p&&(p=i),i-p+1===l)return p*s}else-1!==p&&(i-=i-p),p=-1}else for(n+l>a&&(n=a-l),i=n;i>=0;i--){for(var c=!0,f=0;f<l;f++)if(u(t,i+f)!==u(e,f)){c=!1;break}if(c)return i}return-1}function ba(t,e,n,o){n=Number(n)||0;var r=t.length-n;o?(o=Number(o))>r&&(o=r):o=r;var i=e.length;o>i/2&&(o=i/2);for(var s=0;s<o;++s){var a=parseInt(e.substr(2*s,2),16);if(qa(a))return s;t[n+s]=a}return s}function wa(t,e,n,o){return Na(Ma(e,t.length-n),t,n,o)}function Sa(t,e,n,o){return Na(function(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,o)}function _a(t,e,n,o){return Sa(t,e,n,o)}function Ca(t,e,n,o){return Na(La(e),t,n,o)}function Pa(t,e,n,o){return Na(function(t,e){for(var n,o,r,i=[],s=0;s<t.length&&!((e-=2)<0);++s)o=(n=t.charCodeAt(s))>>8,r=n%256,i.push(r),i.push(o);return i}(e,t.length-n),t,n,o)}function Ea(t,e,n){return 0===e&&n===t.length?Ys.fromByteArray(t):Ys.fromByteArray(t.slice(e,n))}function Fa(t,e,n){n=Math.min(t.length,n);for(var o=[],r=e;r<n;){var i,s,a,l,u=t[r],p=null,c=u>239?4:u>223?3:u>191?2:1;if(r+c<=n)switch(c){case 1:u<128&&(p=u);break;case 2:128==(192&(i=t[r+1]))&&(l=(31&u)<<6|63&i)>127&&(p=l);break;case 3:i=t[r+1],s=t[r+2],128==(192&i)&&128==(192&s)&&(l=(15&u)<<12|(63&i)<<6|63&s)>2047&&(l<55296||l>57343)&&(p=l);break;case 4:i=t[r+1],s=t[r+2],a=t[r+3],128==(192&i)&&128==(192&s)&&128==(192&a)&&(l=(15&u)<<18|(63&i)<<12|(63&s)<<6|63&a)>65535&&l<1114112&&(p=l)}null===p?(p=65533,c=1):p>65535&&(p-=65536,o.push(p>>>10&1023|55296),p=56320|1023&p),o.push(p),r+=c}return function(t){var e=t.length;if(e<=ka)return String.fromCharCode.apply(String,t);for(var n="",o=0;o<e;)n+=String.fromCharCode.apply(String,t.slice(o,o+=ka));return n}(o)}ua.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(t){return!1}}(),ua.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(ua.prototype,"parent",{enumerable:!0,get:function(){if(ua.isBuffer(this))return this.buffer}}),Object.defineProperty(ua.prototype,"offset",{enumerable:!0,get:function(){if(ua.isBuffer(this))return this.byteOffset}}),"undefined"!=typeof Symbol&&null!=Symbol.species&&ua[Symbol.species]===ua&&Object.defineProperty(ua,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),ua.poolSize=8192,ua.from=function(t,e,n){return pa(t,e,n)},ua.prototype.__proto__=Uint8Array.prototype,ua.__proto__=Uint8Array,ua.alloc=function(t,e,n){return function(t,e,n){return ca(t),t<=0?la(t):void 0!==e?"string"==typeof n?la(t).fill(e,n):la(t).fill(e):la(t)}(t,e,n)},ua.allocUnsafe=function(t){return fa(t)},ua.allocUnsafeSlow=function(t){return fa(t)},ua.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==ua.prototype},ua.compare=function(t,e){if(za(t,Uint8Array)&&(t=ua.from(t,t.offset,t.byteLength)),za(e,Uint8Array)&&(e=ua.from(e,e.offset,e.byteLength)),!ua.isBuffer(t)||!ua.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var n=t.length,o=e.length,r=0,i=Math.min(n,o);r<i;++r)if(t[r]!==e[r]){n=t[r],o=e[r];break}return n<o?-1:o<n?1:0},ua.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},ua.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return ua.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var o=ua.allocUnsafe(e),r=0;for(n=0;n<t.length;++n){var i=t[n];if(za(i,Uint8Array)&&(i=ua.from(i)),!ua.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(o,r),r+=i.length}return o},ua.byteLength=ya,ua.prototype._isBuffer=!0,ua.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)ma(this,e,e+1);return this},ua.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)ma(this,e,e+3),ma(this,e+1,e+2);return this},ua.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)ma(this,e,e+7),ma(this,e+1,e+6),ma(this,e+2,e+5),ma(this,e+3,e+4);return this},ua.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?Fa(this,0,t):function(t,e,n){var o=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return Aa(this,e,n);case"utf8":case"utf-8":return Fa(this,e,n);case"ascii":return Oa(this,e,n);case"latin1":case"binary":return Ta(this,e,n);case"base64":return Ea(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ua(this,e,n);default:if(o)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),o=!0}}.apply(this,arguments)},ua.prototype.toLocaleString=ua.prototype.toString,ua.prototype.equals=function(t){if(!ua.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===ua.compare(this,t)},ua.prototype.inspect=function(){var t="",e=sa.INSPECT_MAX_BYTES;return t=this.toString("hex",0,e).replace(/(.{2})/g,"$1 ").trim(),this.length>e&&(t+=" ... "),"<Buffer "+t+">"},ua.prototype.compare=function(t,e,n,o,r){if(za(t,Uint8Array)&&(t=ua.from(t,t.offset,t.byteLength)),!ua.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===o&&(o=0),void 0===r&&(r=this.length),e<0||n>t.length||o<0||r>this.length)throw new RangeError("out of range index");if(o>=r&&e>=n)return 0;if(o>=r)return-1;if(e>=n)return 1;if(this===t)return 0;for(var i=(r>>>=0)-(o>>>=0),s=(n>>>=0)-(e>>>=0),a=Math.min(i,s),l=this.slice(o,r),u=t.slice(e,n),p=0;p<a;++p)if(l[p]!==u[p]){i=l[p],s=u[p];break}return i<s?-1:s<i?1:0},ua.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},ua.prototype.indexOf=function(t,e,n){return ga(this,t,e,n,!0)},ua.prototype.lastIndexOf=function(t,e,n){return ga(this,t,e,n,!1)},ua.prototype.write=function(t,e,n,o){if(void 0===e)o="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)o=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===o&&(o="utf8")):(o=n,n=void 0)}var r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var i=!1;;)switch(o){case"hex":return ba(this,t,e,n);case"utf8":case"utf-8":return wa(this,t,e,n);case"ascii":return Sa(this,t,e,n);case"latin1":case"binary":return _a(this,t,e,n);case"base64":return Ca(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Pa(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),i=!0}},ua.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var ka=4096;function Oa(t,e,n){var o="";n=Math.min(t.length,n);for(var r=e;r<n;++r)o+=String.fromCharCode(127&t[r]);return o}function Ta(t,e,n){var o="";n=Math.min(t.length,n);for(var r=e;r<n;++r)o+=String.fromCharCode(t[r]);return o}function Aa(t,e,n){var o,r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var i="",s=e;s<n;++s)i+=(o=t[s])<16?"0"+o.toString(16):o.toString(16);return i}function Ua(t,e,n){for(var o=t.slice(e,n),r="",i=0;i<o.length;i+=2)r+=String.fromCharCode(o[i]+256*o[i+1]);return r}function xa(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function Ra(t,e,n,o,r,i){if(!ua.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<i)throw new RangeError('"value" argument is out of bounds');if(n+o>t.length)throw new RangeError("Index out of range")}function Da(t,e,n,o,r,i){if(n+o>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function ja(t,e,n,o,r){return e=+e,n>>>=0,r||Da(t,0,n,4),ia.write(t,e,n,o,23,4),n+4}function Ba(t,e,n,o,r){return e=+e,n>>>=0,r||Da(t,0,n,8),ia.write(t,e,n,o,52,8),n+8}ua.prototype.slice=function(t,e){var n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);var o=this.subarray(t,e);return o.__proto__=ua.prototype,o},ua.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||xa(t,e,this.length);for(var o=this[t],r=1,i=0;++i<e&&(r*=256);)o+=this[t+i]*r;return o},ua.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||xa(t,e,this.length);for(var o=this[t+--e],r=1;e>0&&(r*=256);)o+=this[t+--e]*r;return o},ua.prototype.readUInt8=function(t,e){return t>>>=0,e||xa(t,1,this.length),this[t]},ua.prototype.readUInt16LE=function(t,e){return t>>>=0,e||xa(t,2,this.length),this[t]|this[t+1]<<8},ua.prototype.readUInt16BE=function(t,e){return t>>>=0,e||xa(t,2,this.length),this[t]<<8|this[t+1]},ua.prototype.readUInt32LE=function(t,e){return t>>>=0,e||xa(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},ua.prototype.readUInt32BE=function(t,e){return t>>>=0,e||xa(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},ua.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||xa(t,e,this.length);for(var o=this[t],r=1,i=0;++i<e&&(r*=256);)o+=this[t+i]*r;return o>=(r*=128)&&(o-=Math.pow(2,8*e)),o},ua.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||xa(t,e,this.length);for(var o=e,r=1,i=this[t+--o];o>0&&(r*=256);)i+=this[t+--o]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*e)),i},ua.prototype.readInt8=function(t,e){return t>>>=0,e||xa(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},ua.prototype.readInt16LE=function(t,e){t>>>=0,e||xa(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},ua.prototype.readInt16BE=function(t,e){t>>>=0,e||xa(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},ua.prototype.readInt32LE=function(t,e){return t>>>=0,e||xa(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},ua.prototype.readInt32BE=function(t,e){return t>>>=0,e||xa(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},ua.prototype.readFloatLE=function(t,e){return t>>>=0,e||xa(t,4,this.length),ia.read(this,t,!0,23,4)},ua.prototype.readFloatBE=function(t,e){return t>>>=0,e||xa(t,4,this.length),ia.read(this,t,!1,23,4)},ua.prototype.readDoubleLE=function(t,e){return t>>>=0,e||xa(t,8,this.length),ia.read(this,t,!0,52,8)},ua.prototype.readDoubleBE=function(t,e){return t>>>=0,e||xa(t,8,this.length),ia.read(this,t,!1,52,8)},ua.prototype.writeUIntLE=function(t,e,n,o){t=+t,e>>>=0,n>>>=0,o||Ra(this,t,e,n,Math.pow(2,8*n)-1,0);var r=1,i=0;for(this[e]=255&t;++i<n&&(r*=256);)this[e+i]=t/r&255;return e+n},ua.prototype.writeUIntBE=function(t,e,n,o){t=+t,e>>>=0,n>>>=0,o||Ra(this,t,e,n,Math.pow(2,8*n)-1,0);var r=n-1,i=1;for(this[e+r]=255&t;--r>=0&&(i*=256);)this[e+r]=t/i&255;return e+n},ua.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||Ra(this,t,e,1,255,0),this[e]=255&t,e+1},ua.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||Ra(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},ua.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||Ra(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},ua.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||Ra(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},ua.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||Ra(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},ua.prototype.writeIntLE=function(t,e,n,o){if(t=+t,e>>>=0,!o){var r=Math.pow(2,8*n-1);Ra(this,t,e,n,r-1,-r)}var i=0,s=1,a=0;for(this[e]=255&t;++i<n&&(s*=256);)t<0&&0===a&&0!==this[e+i-1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},ua.prototype.writeIntBE=function(t,e,n,o){if(t=+t,e>>>=0,!o){var r=Math.pow(2,8*n-1);Ra(this,t,e,n,r-1,-r)}var i=n-1,s=1,a=0;for(this[e+i]=255&t;--i>=0&&(s*=256);)t<0&&0===a&&0!==this[e+i+1]&&(a=1),this[e+i]=(t/s>>0)-a&255;return e+n},ua.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||Ra(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},ua.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||Ra(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},ua.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||Ra(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},ua.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||Ra(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},ua.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||Ra(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},ua.prototype.writeFloatLE=function(t,e,n){return ja(this,t,e,!0,n)},ua.prototype.writeFloatBE=function(t,e,n){return ja(this,t,e,!1,n)},ua.prototype.writeDoubleLE=function(t,e,n){return Ba(this,t,e,!0,n)},ua.prototype.writeDoubleBE=function(t,e,n){return Ba(this,t,e,!1,n)},ua.prototype.copy=function(t,e,n,o){if(!ua.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),o||0===o||(o=this.length),e>=t.length&&(e=t.length),e||(e=0),o>0&&o<n&&(o=n),o===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),t.length-e<o-n&&(o=t.length-e+n);var r=o-n;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,n,o);else if(this===t&&n<e&&e<o)for(var i=r-1;i>=0;--i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,o),e);return r},ua.prototype.fill=function(t,e,n,o){if("string"==typeof t){if("string"==typeof e?(o=e,e=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!ua.isEncoding(o))throw new TypeError("Unknown encoding: "+o);if(1===t.length){var r=t.charCodeAt(0);("utf8"===o&&r<128||"latin1"===o)&&(t=r)}}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var s=ua.isBuffer(t)?t:ua.from(t,o),a=s.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<n-e;++i)this[i+e]=s[i%a]}return this};var Ia=/[^+\/0-9A-Za-z-_]/g;function Ma(t,e){var n;e=e||1/0;for(var o=t.length,r=null,i=[],s=0;s<o;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!r){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===o){(e-=3)>-1&&i.push(239,191,189);continue}r=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(e-=3)>-1&&i.push(239,191,189);if(r=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function La(t){return Ys.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(Ia,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Na(t,e,n,o){for(var r=0;r<o&&!(r+n>=e.length||r>=t.length);++r)e[r+n]=t[r];return r}function za(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function qa(t){return t!=t}var Ha={}.toString,Wa=Array.isArray||function(t){return"[object Array]"==Ha.call(t)},Xa={};(function(t){var e=Object.prototype.toString,n="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===e.call(Blob),o="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===e.call(File);Xa=function e(r){if(!r||"object"!=typeof r)return!1;if(Wa(r)){for(var i=0,s=r.length;i<s;i++)if(e(r[i]))return!0;return!1}if("function"==typeof t&&t.isBuffer&&t.isBuffer(r)||"function"==typeof ArrayBuffer&&r instanceof ArrayBuffer||n&&r instanceof Blob||o&&r instanceof File)return!0;if(r.toJSON&&"function"==typeof r.toJSON&&1===arguments.length)return e(r.toJSON(),!0);for(var a in r)if(Object.prototype.hasOwnProperty.call(r,a)&&e(r[a]))return!0;return!1}}).call(this,sa.Buffer);var Va,Ga={};"undefined"!=typeof ArrayBuffer&&(Va=Os);var $a="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),Ka="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),Ya=$a||Ka;Ga.protocol=3;var Ja=Ga.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},Qa=Ns(Ja),Za={type:"error",data:"parser error"};function tl(t,e,n){for(var o=new Array(t.length),r=Fs(t.length,n),i=function(t,n,r){e(n,function(e,n){o[t]=n,r(e,o)})},s=0;s<t.length;s++)i(s,t[s],r)}Ga.encodePacket=function(t,e,n,o){"function"==typeof e&&(o=e,e=!1),"function"==typeof n&&(o=n,n=null);var r=void 0===t.data?void 0:t.data.buffer||t.data;if("undefined"!=typeof ArrayBuffer&&r instanceof ArrayBuffer)return function(t,e,n){if(!e)return Ga.encodeBase64Packet(t,n);var o=t.data,r=new Uint8Array(o),i=new Uint8Array(1+o.byteLength);i[0]=Ja[t.type];for(var s=0;s<r.length;s++)i[s+1]=r[s];return n(i.buffer)}(t,e,o);if(void 0!==Ts&&r instanceof Ts)return function(t,e,n){if(!e)return Ga.encodeBase64Packet(t,n);if(Ya)return function(t,e,n){if(!e)return Ga.encodeBase64Packet(t,n);var o=new FileReader;return o.onload=function(){Ga.encodePacket({type:t.type,data:o.result},e,!0,n)},o.readAsArrayBuffer(t.data)}(t,e,n);var o=new Uint8Array(1);return o[0]=Ja[t.type],n(new Ts([o.buffer,t.data]))}(t,e,o);if(r&&r.base64)return function(t,e){return e("b"+Ga.packets[t.type]+t.data.data)}(t,o);var i=Ja[t.type];return void 0!==t.data&&(i+=n?$s(String(t.data),{strict:!1}):String(t.data)),o(""+i)},Ga.encodeBase64Packet=function(t,e){var n,o="b"+Ga.packets[t.type];if(void 0!==Ts&&t.data instanceof Ts){var r=new FileReader;return r.onload=function(){var t=r.result.split(",")[1];e(o+t)},r.readAsDataURL(t.data)}try{n=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var i=new Uint8Array(t.data),s=new Array(i.length),a=0;a<i.length;a++)s[a]=i[a];n=String.fromCharCode.apply(null,s)}return o+=btoa(n),e(o)},Ga.decodePacket=function(t,e,n){if(void 0===t)return Za;if("string"==typeof t){if("b"===t.charAt(0))return Ga.decodeBase64Packet(t.substr(1),e);if(n&&!1===(t=function(t){try{t=Ks(t,{strict:!1})}catch(t){return!1}return t}(t)))return Za;var o=t.charAt(0);return Number(o)==o&&Qa[o]?t.length>1?{type:Qa[o],data:t.substring(1)}:{type:Qa[o]}:Za}o=new Uint8Array(t)[0];var r=ks(t,1);return Ts&&"blob"===e&&(r=new Ts([r])),{type:Qa[o],data:r}},Ga.decodeBase64Packet=function(t,e){var n=Qa[t.charAt(0)];if(!Va)return{type:n,data:{base64:!0,data:t.substr(1)}};var o=Va.decode(t.substr(1));return"blob"===e&&Ts&&(o=new Ts([o])),{type:n,data:o}},Ga.encodePayload=function(t,e,n){"function"==typeof e&&(n=e,e=null);var o=Xa(t);return e&&o?Ts&&!Ya?Ga.encodePayloadAsBlob(t,n):Ga.encodePayloadAsArrayBuffer(t,n):t.length?void tl(t,function(t,n){Ga.encodePacket(t,!!o&&e,!1,function(t){n(null,function(t){return t.length+":"+t}(t))})},function(t,e){return n(e.join(""))}):n("0:")},Ga.decodePayload=function(t,e,n){if("string"!=typeof t)return Ga.decodePayloadAsBinary(t,e,n);var o;if("function"==typeof e&&(n=e,e=null),""===t)return n(Za,0,1);for(var r,i,s="",a=0,l=t.length;a<l;a++){var u=t.charAt(a);if(":"===u){if(""===s||s!=(r=Number(s)))return n(Za,0,1);if(s!=(i=t.substr(a+1,r)).length)return n(Za,0,1);if(i.length){if(o=Ga.decodePacket(i,e,!1),Za.type===o.type&&Za.data===o.data)return n(Za,0,1);if(!1===n(o,a+r,l))return}a+=r,s=""}else s+=u}return""!==s?n(Za,0,1):void 0},Ga.encodePayloadAsArrayBuffer=function(t,e){if(!t.length)return e(new ArrayBuffer(0));tl(t,function(t,e){Ga.encodePacket(t,!0,!0,function(t){return e(null,t)})},function(t,n){var o=n.reduce(function(t,e){var n;return t+(n="string"==typeof e?e.length:e.byteLength).toString().length+n+2},0),r=new Uint8Array(o),i=0;return n.forEach(function(t){var e="string"==typeof t,n=t;if(e){for(var o=new Uint8Array(t.length),s=0;s<t.length;s++)o[s]=t.charCodeAt(s);n=o.buffer}r[i++]=e?0:1;var a=n.byteLength.toString();for(s=0;s<a.length;s++)r[i++]=parseInt(a[s]);for(r[i++]=255,o=new Uint8Array(n),s=0;s<o.length;s++)r[i++]=o[s]}),e(r.buffer)})},Ga.encodePayloadAsBlob=function(t,e){tl(t,function(t,e){Ga.encodePacket(t,!0,!0,function(t){var n=new Uint8Array(1);if(n[0]=1,"string"==typeof t){for(var o=new Uint8Array(t.length),r=0;r<t.length;r++)o[r]=t.charCodeAt(r);t=o.buffer,n[0]=0}var i=(t instanceof ArrayBuffer?t.byteLength:t.size).toString(),s=new Uint8Array(i.length+1);for(r=0;r<i.length;r++)s[r]=parseInt(i[r]);if(s[i.length]=255,Ts){var a=new Ts([n.buffer,s.buffer,t]);e(null,a)}})},function(t,n){return e(new Ts(n))})},Ga.decodePayloadAsBinary=function(t,e,n){"function"==typeof e&&(n=e,e=null);for(var o=t,r=[];o.byteLength>0;){for(var i=new Uint8Array(o),s=0===i[0],a="",l=1;255!==i[l];l++){if(a.length>310)return n(Za,0,1);a+=i[l]}o=ks(o,2+a.length),a=parseInt(a);var u=ks(o,0,a);if(s)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(t){var p=new Uint8Array(u);for(u="",l=0;l<p.length;l++)u+=String.fromCharCode(p[l])}r.push(u),o=ks(o,a)}var c=r.length;r.forEach(function(t,o){n(Ga.decodePacket(t,e,!0),o,c)})};var el={};function nl(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}el=nl,bs(nl.prototype),nl.prototype.onError=function(t,e){var n=new Error(t);return n.type="TransportError",n.description=e,this.emit("error",n),this},nl.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},nl.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},nl.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},nl.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},nl.prototype.onData=function(t){var e=Ga.decodePacket(t,this.socket.binaryType);this.onPacket(e)},nl.prototype.onPacket=function(t){this.emit("packet",t)},nl.prototype.onClose=function(){this.readyState="closed",this.emit("close")};var ol=function(t,e){var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t},rl={};try{rl="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(Za){rl=!1}var il={};(function(t){il=function(e){var n=e.xdomain,o=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!n||rl))return new XMLHttpRequest}catch(t){}try{if("undefined"!=typeof XDomainRequest&&!o&&r)return new XDomainRequest}catch(t){}if(!n)try{return new(t[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var sl=1e3,al=6e4,ll=864e5;function ul(t,e,n){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}var pl=function(t,e){e=e||{};var n,o=typeof t;if("string"===o&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"days":case"day":case"d":return n*ll;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*n;case"minutes":case"minute":case"mins":case"min":case"m":return n*al;case"seconds":case"second":case"secs":case"sec":case"s":return n*sl;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(t);if("number"===o&&!1===isNaN(t))return e.long?ul(n=t,ll,"day")||ul(n,36e5,"hour")||ul(n,al,"minute")||ul(n,sl,"second")||n+" ms":function(t){return t>=ll?Math.round(t/ll)+"d":t>=36e5?Math.round(t/36e5)+"h":t>=al?Math.round(t/al)+"m":t>=sl?Math.round(t/sl)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))},cl={};function fl(t){var e;function n(){if(n.enabled){var t=n,o=+new Date,r=o-(e||o);t.diff=r,t.prev=e,t.curr=o,e=o;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=cl.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var a=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(e,n){if("%%"===e)return e;a++;var o=cl.formatters[n];if("function"==typeof o){var r=i[a];e=o.call(t,r),i.splice(a,1),a--}return e}),cl.formatArgs.call(t,i),(n.log||cl.log||console.log.bind(console)).apply(t,i)}}return n.namespace=t,n.enabled=cl.enabled(t),n.useColors=cl.useColors(),n.color=function(t){var e,n=0;for(e in t)n=(n<<5)-n+t.charCodeAt(e),n|=0;return cl.colors[Math.abs(n)%cl.colors.length]}(t),n.destroy=dl,"function"==typeof cl.init&&cl.init(n),cl.instances.push(n),n}function dl(){var t=cl.instances.indexOf(this);return-1!==t&&(cl.instances.splice(t,1),!0)}(cl=cl=fl.debug=fl.default=fl).coerce=function(t){return t instanceof Error?t.stack||t.message:t},cl.disable=function(){cl.enable("")},cl.enable=function(t){var e;cl.save(t),cl.names=[],cl.skips=[];var n=("string"==typeof t?t:"").split(/[\s,]+/),o=n.length;for(e=0;e<o;e++)n[e]&&("-"===(t=n[e].replace(/\*/g,".*?"))[0]?cl.skips.push(new RegExp("^"+t.substr(1)+"$")):cl.names.push(new RegExp("^"+t+"$")));for(e=0;e<cl.instances.length;e++){var r=cl.instances[e];r.enabled=cl.enabled(r.namespace)}},cl.enabled=function(t){if("*"===t[t.length-1])return!0;var e,n;for(e=0,n=cl.skips.length;e<n;e++)if(cl.skips[e].test(t))return!1;for(e=0,n=cl.names.length;e<n;e++)if(cl.names[e].test(t))return!0;return!1},cl.humanize=pl,cl.instances=[],cl.names=[],cl.skips=[],cl.formatters={};var hl={};(function(t){function e(){var e;try{e=hl.storage.debug}catch(t){}return!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG),e}(hl=hl=cl).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},hl.formatArgs=function(t){var e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+hl.humanize(this.diff),e){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var o=0,r=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(o++,"%c"===t&&(r=o))}),t.splice(r,0,n)}},hl.save=function(t){try{null==t?hl.storage.removeItem("debug"):hl.storage.debug=t}catch(t){}},hl.load=e,hl.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},hl.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),hl.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],hl.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},hl.enable(e())}).call(this,Rt);var yl,ml={encode:function(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e},decode:function(t){for(var e={},n=t.split("&"),o=0,r=n.length;o<r;o++){var i=n[o].split("=");e[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return e}},gl={},vl="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),bl=64,wl={},Sl=0,_l=0;function Cl(t){var e="";do{e=vl[t%bl]+e,t=Math.floor(t/bl)}while(t>0);return e}function Pl(){var t=Cl(+new Date);return t!==yl?(Sl=0,yl=t):t+"."+Cl(Sl++)}for(;_l<bl;_l++)wl[vl[_l]]=_l;Pl.encode=Cl,Pl.decode=function(t){var e=0;for(_l=0;_l<t.length;_l++)e=e*bl+wl[t.charAt(_l)];return e},gl=Pl;var El=hl("engine.io-client:polling"),Fl=Ol,kl=null!=new il({xdomain:!1}).responseType;function Ol(t){var e=t&&t.forceBase64;kl&&!e||(this.supportsBinary=!1),el.call(this,t)}ol(Ol,el),Ol.prototype.name="polling",Ol.prototype.doOpen=function(){this.poll()},Ol.prototype.pause=function(t){var e=this;function n(){El("paused"),e.readyState="paused",t()}if(this.readyState="pausing",this.polling||!this.writable){var o=0;this.polling&&(El("we are currently polling - waiting to pause"),o++,this.once("pollComplete",function(){El("pre-pause polling complete"),--o||n()})),this.writable||(El("we are currently writing - waiting to pause"),o++,this.once("drain",function(){El("pre-pause writing complete"),--o||n()}))}else n()},Ol.prototype.poll=function(){El("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},Ol.prototype.onData=function(t){var e=this;El("polling got data %s",t),Ga.decodePayload(t,this.socket.binaryType,function(t,n,o){if("opening"===e.readyState&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():El('ignoring poll - transport state "%s"',this.readyState))},Ol.prototype.doClose=function(){var t=this;function e(){El("writing close packet"),t.write([{type:"close"}])}"open"===this.readyState?(El("transport open - closing"),e()):(El("transport not open - deferring close"),this.once("open",e))},Ol.prototype.write=function(t){var e=this;this.writable=!1;var n=function(){e.writable=!0,e.emit("drain")};Ga.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,n)})},Ol.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(t[this.timestampParam]=gl()),this.supportsBinary||t.sid||(t.b64=1),t=ml.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(n=":"+this.port),t.length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+t};var Tl={};(function(t){Tl=i;var e,n=/\n/g,o=/\\n/g;function r(){}function i(n){Fl.call(this,n),this.query=this.query||{},e||(t.___eio||(t.___eio=[]),e=t.___eio),this.index=e.length;var o=this;e.push(function(t){o.onData(t)}),this.query.j=this.index,t.document&&t.addEventListener&&t.addEventListener("beforeunload",function(){o.script&&(o.script.onerror=r)},!1)}ol(i,Fl),i.prototype.supportsBinary=!1,i.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),Fl.prototype.doClose.call(this)},i.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},i.prototype.doWrite=function(t,e){var r=this;if(!this.form){var i,s=document.createElement("form"),a=document.createElement("textarea"),l=this.iframeId="eio_iframe_"+this.index;s.className="socketio",s.style.position="absolute",s.style.top="-1000px",s.style.left="-1000px",s.target=l,s.method="POST",s.setAttribute("accept-charset","utf-8"),a.name="d",s.appendChild(a),document.body.appendChild(s),this.form=s,this.area=a}function u(){p(),e()}function p(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(t){r.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+r.iframeId+'">';i=document.createElement(t)}catch(t){(i=document.createElement("iframe")).name=r.iframeId,i.src="javascript:0"}i.id=r.iframeId,r.form.appendChild(i),r.iframe=i}this.form.action=this.uri(),p(),t=t.replace(o,"\\\n"),this.area.value=t.replace(n,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===r.iframe.readyState&&u()}:this.iframe.onload=u}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Al={};(function(t){var e=hl("engine.io-client:polling-xhr");function n(){}function o(e){if(Fl.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,t.location){var n="https:"===location.protocol,o=location.port;o||(o=n?443:80),this.xd=e.hostname!==t.location.hostname||o!==e.port,this.xs=e.secure!==n}}function r(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}function i(){for(var t in r.requests)r.requests.hasOwnProperty(t)&&r.requests[t].abort()}(Al=o).Request=r,ol(o,Fl),o.prototype.supportsBinary=!0,o.prototype.request=function(t){return(t=t||{}).uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new r(t)},o.prototype.doWrite=function(t,e){var n="string"!=typeof t&&void 0!==t,o=this.request({method:"POST",data:t,isBinary:n}),r=this;o.on("success",e),o.on("error",function(t){r.onError("xhr post error",t)}),this.sendXhr=o},o.prototype.doPoll=function(){e("xhr poll");var t=this.request(),n=this;t.on("data",function(t){n.onData(t)}),t.on("error",function(t){n.onError("xhr poll error",t)}),this.pollXhr=t},bs(r.prototype),r.prototype.create=function(){var n={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized;var o=this.xhr=new il(n),i=this;try{e("xhr open %s: %s",this.method,this.uri),o.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var s in o.setDisableHeaderCheck&&o.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(s)&&o.setRequestHeader(s,this.extraHeaders[s])}catch(t){}if("POST"===this.method)try{this.isBinary?o.setRequestHeader("Content-type","application/octet-stream"):o.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{o.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in o&&(o.withCredentials=!0),this.requestTimeout&&(o.timeout=this.requestTimeout),this.hasXDR()?(o.onload=function(){i.onLoad()},o.onerror=function(){i.onError(o.responseText)}):o.onreadystatechange=function(){if(2===o.readyState)try{var t=o.getResponseHeader("Content-Type");i.supportsBinary&&"application/octet-stream"===t&&(o.responseType="arraybuffer")}catch(t){}4===o.readyState&&(200===o.status||1223===o.status?i.onLoad():setTimeout(function(){i.onError(o.status)},0))},e("xhr data %s",this.data),o.send(this.data)}catch(t){return void setTimeout(function(){i.onError(t)},0)}t.document&&(this.index=r.requestsCount++,r.requests[this.index]=this)},r.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},r.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},r.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},r.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=n:this.xhr.onreadystatechange=n,e)try{this.xhr.abort()}catch(t){}t.document&&delete r.requests[this.index],this.xhr=null}},r.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type")}catch(t){}t="application/octet-stream"===e&&this.xhr.response||this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},r.prototype.hasXDR=function(){return void 0!==t.XDomainRequest&&!this.xs&&this.enablesXDR},r.prototype.abort=function(){this.cleanup()},r.requestsCount=0,r.requests={},t.document&&(t.attachEvent?t.attachEvent("onunload",i):t.addEventListener&&t.addEventListener("beforeunload",i,!1))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Ul={},xl={};(function(t){var e,n=hl("engine.io-client:websocket"),o=t.WebSocket||t.MozWebSocket;if("undefined"==typeof window)try{e=Ul}catch(t){}var r=o;function i(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=o&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(r=e),el.call(this,t)}r||"undefined"!=typeof window||(r=e),xl=i,ol(i,el),i.prototype.name="websocket",i.prototype.supportsBinary=!0,i.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?e?new r(t,e):new r(t):new r(t,e,n)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},i.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},i.prototype.write=function(e){var o=this;this.writable=!1;for(var r=e.length,i=0,s=r;i<s;i++)!function(e){Ga.encodePacket(e,o.supportsBinary,function(i){if(!o.usingBrowserWebSocket){var s={};e.options&&(s.compress=e.options.compress),o.perMessageDeflate&&("string"==typeof i?t.Buffer.byteLength(i):i.length)<o.perMessageDeflate.threshold&&(s.compress=!1)}try{o.usingBrowserWebSocket?o.ws.send(i):o.ws.send(i,s)}catch(t){n("websocket closed before onclose event")}--r||(o.emit("flush"),setTimeout(function(){o.writable=!0,o.emit("drain")},0))})}(e[i])},i.prototype.onClose=function(){el.prototype.onClose.call(this)},i.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},i.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",n="";return this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=gl()),this.supportsBinary||(t.b64=1),(t=ml.encode(t)).length&&(t="?"+t),e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+t},i.prototype.check=function(){return!(!r||"__initialize"in r&&this.name===i.prototype.name)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Rl={};(function(t){Rl.polling=function(e){var n=!1,o=!1,r=!1!==e.jsonp;if(t.location){var i="https:"===location.protocol,s=location.port;s||(s=i?443:80),n=e.hostname!==location.hostname||s!==e.port,o=e.secure!==i}if(e.xdomain=n,e.xscheme=o,"open"in new il(e)&&!e.forceJSONP)return new Al(e);if(!r)throw new Error("JSONP disabled");return new Tl(e)},Rl.websocket=xl}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Dl=[].indexOf,jl=function(t,e){if(Dl)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1},Bl=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Il=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],Ml=function(t){var e=t,n=t.indexOf("["),o=t.indexOf("]");-1!=n&&-1!=o&&(t=t.substring(0,n)+t.substring(n,o).replace(/:/g,";")+t.substring(o,t.length));for(var r=Bl.exec(t||""),i={},s=14;s--;)i[Il[s]]=r[s]||"";return-1!=n&&-1!=o&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i},Ll={};(function(t){var e=hl("engine.io-client:socket");function n(e,o){if(!(this instanceof n))return new n(e,o);o=o||{},e&&"object"==typeof e&&(o=e,e=null),e?(e=Ml(e),o.hostname=e.host,o.secure="https"===e.protocol||"wss"===e.protocol,o.port=e.port,e.query&&(o.query=e.query)):o.host&&(o.hostname=Ml(o.host).host),this.secure=null!=o.secure?o.secure:t.location&&"https:"===location.protocol,o.hostname&&!o.port&&(o.port=this.secure?"443":"80"),this.agent=o.agent||!1,this.hostname=o.hostname||(t.location?location.hostname:"localhost"),this.port=o.port||(t.location&&location.port?location.port:this.secure?443:80),this.query=o.query||{},"string"==typeof this.query&&(this.query=ml.decode(this.query)),this.upgrade=!1!==o.upgrade,this.path=(o.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!o.forceJSONP,this.jsonp=!1!==o.jsonp,this.forceBase64=!!o.forceBase64,this.enablesXDR=!!o.enablesXDR,this.timestampParam=o.timestampParam||"t",this.timestampRequests=o.timestampRequests,this.transports=o.transports||["polling","websocket"],this.transportOptions=o.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=o.policyPort||843,this.rememberUpgrade=o.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=o.onlyBinaryUpgrades,this.perMessageDeflate=!1!==o.perMessageDeflate&&(o.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=o.pfx||null,this.key=o.key||null,this.passphrase=o.passphrase||null,this.cert=o.cert||null,this.ca=o.ca||null,this.ciphers=o.ciphers||null,this.rejectUnauthorized=void 0===o.rejectUnauthorized||o.rejectUnauthorized,this.forceNode=!!o.forceNode;var r="object"==typeof t&&t;r.global===r&&(o.extraHeaders&&Object.keys(o.extraHeaders).length>0&&(this.extraHeaders=o.extraHeaders),o.localAddress&&(this.localAddress=o.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}Ll=n,n.priorWebsocketSuccess=!1,bs(n.prototype),n.protocol=Ga.protocol,n.Socket=n,n.Transport=el,n.transports=Rl,n.parser=Ga,n.prototype.createTransport=function(t){e('creating transport "%s"',t);var n=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}(this.query);n.EIO=Ga.protocol,n.transport=t;var o=this.transportOptions[t]||{};return this.id&&(n.sid=this.id),new Rl[t]({query:n,socket:this,agent:o.agent||this.agent,hostname:o.hostname||this.hostname,port:o.port||this.port,secure:o.secure||this.secure,path:o.path||this.path,forceJSONP:o.forceJSONP||this.forceJSONP,jsonp:o.jsonp||this.jsonp,forceBase64:o.forceBase64||this.forceBase64,enablesXDR:o.enablesXDR||this.enablesXDR,timestampRequests:o.timestampRequests||this.timestampRequests,timestampParam:o.timestampParam||this.timestampParam,policyPort:o.policyPort||this.policyPort,pfx:o.pfx||this.pfx,key:o.key||this.key,passphrase:o.passphrase||this.passphrase,cert:o.cert||this.cert,ca:o.ca||this.ca,ciphers:o.ciphers||this.ciphers,rejectUnauthorized:o.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:o.perMessageDeflate||this.perMessageDeflate,extraHeaders:o.extraHeaders||this.extraHeaders,forceNode:o.forceNode||this.forceNode,localAddress:o.localAddress||this.localAddress,requestTimeout:o.requestTimeout||this.requestTimeout,protocols:o.protocols||void 0})},n.prototype.open=function(){var t;if(this.rememberUpgrade&&n.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available")},0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},n.prototype.setTransport=function(t){e("setting transport %s",t.name);var n=this;this.transport&&(e("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){n.onDrain()}).on("packet",function(t){n.onPacket(t)}).on("error",function(t){n.onError(t)}).on("close",function(){n.onClose("transport close")})},n.prototype.probe=function(t){e('probing transport "%s"',t);var o=this.createTransport(t,{probe:1}),r=!1,i=this;function s(){if(i.onlyBinaryUpgrades){var s=!this.supportsBinary&&i.transport.supportsBinary;r=r||s}r||(e('probe transport "%s" opened',t),o.send([{type:"ping",data:"probe"}]),o.once("packet",function(s){if(!r)if("pong"===s.type&&"probe"===s.data){if(e('probe transport "%s" pong',t),i.upgrading=!0,i.emit("upgrading",o),!o)return;n.priorWebsocketSuccess="websocket"===o.name,e('pausing current transport "%s"',i.transport.name),i.transport.pause(function(){r||"closed"!==i.readyState&&(e("changing transport and sending upgrade packet"),f(),i.setTransport(o),o.send([{type:"upgrade"}]),i.emit("upgrade",o),o=null,i.upgrading=!1,i.flush())})}else{e('probe transport "%s" failed',t);var a=new Error("probe error");a.transport=o.name,i.emit("upgradeError",a)}}))}function a(){r||(r=!0,f(),o.close(),o=null)}function l(n){var r=new Error("probe error: "+n);r.transport=o.name,a(),e('probe transport "%s" failed because of error: %s',t,n),i.emit("upgradeError",r)}function u(){l("transport closed")}function p(){l("socket closed")}function c(t){o&&t.name!==o.name&&(e('"%s" works - aborting "%s"',t.name,o.name),a())}function f(){o.removeListener("open",s),o.removeListener("error",l),o.removeListener("close",u),i.removeListener("close",p),i.removeListener("upgrading",c)}n.priorWebsocketSuccess=!1,o.once("open",s),o.once("error",l),o.once("close",u),this.once("close",p),this.once("upgrading",c),o.open()},n.prototype.onOpen=function(){if(e("socket open"),this.readyState="open",n.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){e("starting upgrade probes");for(var t=0,o=this.upgrades.length;t<o;t++)this.probe(this.upgrades[t])}},n.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(e('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var n=new Error("server error");n.code=t.data,this.onError(n);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else e('packet received with socket readyState "%s"',this.readyState)},n.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},n.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){"closed"!==e.readyState&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)},n.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){e("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)},n.prototype.ping=function(){var t=this;this.sendPacket("ping",function(){t.emit("ping")})},n.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},n.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(e("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},n.prototype.write=n.prototype.send=function(t,e,n){return this.sendPacket("message",t,e,n),this},n.prototype.sendPacket=function(t,e,n,o){if("function"==typeof e&&(o=e,e=void 0),"function"==typeof n&&(o=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var r={type:t,data:e,options:n};this.emit("packetCreate",r),this.writeBuffer.push(r),o&&this.once("flush",o),this.flush()}},n.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var t=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():n()}):this.upgrading?r():n()}function n(){t.onClose("forced close"),e("socket closing - telling transport to close"),t.transport.close()}function o(){t.removeListener("upgrade",o),t.removeListener("upgradeError",o),n()}function r(){t.once("upgrade",o),t.once("upgradeError",o)}return this},n.prototype.onError=function(t){e("socket error %j",t),n.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},n.prototype.onClose=function(t,n){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(e('socket close with reason: "%s"',t),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,n),this.writeBuffer=[],this.prevBufferLen=0)},n.prototype.filterUpgrades=function(t){for(var e=[],n=0,o=t.length;n<o;n++)~jl(this.transports,t[n])&&e.push(t[n]);return e}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Nl={};(Nl=Ll).parser=Ga;var zl=function(t,e,n){return t.on(e,n),{destroy:function(){t.removeListener(e,n)}}},ql={};function Hl(t){var e;function n(){if(n.enabled){var t=n,o=+new Date,r=o-(e||o);t.diff=r,t.prev=e,t.curr=o,e=o;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=ql.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var a=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(e,n){if("%%"===e)return e;a++;var o=ql.formatters[n];if("function"==typeof o){var r=i[a];e=o.call(t,r),i.splice(a,1),a--}return e}),ql.formatArgs.call(t,i),(n.log||ql.log||console.log.bind(console)).apply(t,i)}}return n.namespace=t,n.enabled=ql.enabled(t),n.useColors=ql.useColors(),n.color=function(t){var e,n=0;for(e in t)n=(n<<5)-n+t.charCodeAt(e),n|=0;return ql.colors[Math.abs(n)%ql.colors.length]}(t),n.destroy=Wl,"function"==typeof ql.init&&ql.init(n),ql.instances.push(n),n}function Wl(){var t=ql.instances.indexOf(this);return-1!==t&&(ql.instances.splice(t,1),!0)}(ql=ql=Hl.debug=Hl.default=Hl).coerce=function(t){return t instanceof Error?t.stack||t.message:t},ql.disable=function(){ql.enable("")},ql.enable=function(t){var e;ql.save(t),ql.names=[],ql.skips=[];var n=("string"==typeof t?t:"").split(/[\s,]+/),o=n.length;for(e=0;e<o;e++)n[e]&&("-"===(t=n[e].replace(/\*/g,".*?"))[0]?ql.skips.push(new RegExp("^"+t.substr(1)+"$")):ql.names.push(new RegExp("^"+t+"$")));for(e=0;e<ql.instances.length;e++){var r=ql.instances[e];r.enabled=ql.enabled(r.namespace)}},ql.enabled=function(t){if("*"===t[t.length-1])return!0;var e,n;for(e=0,n=ql.skips.length;e<n;e++)if(ql.skips[e].test(t))return!1;for(e=0,n=ql.names.length;e<n;e++)if(ql.names[e].test(t))return!0;return!1},ql.humanize=pl,ql.instances=[],ql.names=[],ql.skips=[],ql.formatters={};var Xl={};(function(t){function e(){var e;try{e=Xl.storage.debug}catch(t){}return!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG),e}(Xl=Xl=ql).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},Xl.formatArgs=function(t){var e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+Xl.humanize(this.diff),e){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var o=0,r=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(o++,"%c"===t&&(r=o))}),t.splice(r,0,n)}},Xl.save=function(t){try{null==t?Xl.storage.removeItem("debug"):Xl.storage.debug=t}catch(t){}},Xl.load=e,Xl.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},Xl.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),Xl.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],Xl.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},Xl.enable(e())}).call(this,Rt);var Vl={};(function(t){Vl=function(r){return e&&t.Buffer.isBuffer(r)||n&&(r instanceof t.ArrayBuffer||o(r))};var e="function"==typeof t.Buffer&&"function"==typeof t.Buffer.isBuffer,n="function"==typeof t.ArrayBuffer,o=n&&"function"==typeof t.ArrayBuffer.isView?t.ArrayBuffer.isView:function(e){return e.buffer instanceof t.ArrayBuffer}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Gl={};(function(t){var e=Object.prototype.toString,n="function"==typeof t.Blob||"[object BlobConstructor]"===e.call(t.Blob),o="function"==typeof t.File||"[object FileConstructor]"===e.call(t.File);Gl.deconstructPacket=function(t){var e=[],n=t.data,o=t;return o.data=function t(e,n){if(!e)return e;if(Vl(e)){var o={_placeholder:!0,num:n.length};return n.push(e),o}if(Wa(e)){for(var r=new Array(e.length),i=0;i<e.length;i++)r[i]=t(e[i],n);return r}if("object"==typeof e&&!(e instanceof Date)){r={};for(var s in e)r[s]=t(e[s],n);return r}return e}(n,e),o.attachments=e.length,{packet:o,buffers:e}},Gl.reconstructPacket=function(t,e){return t.data=function t(e,n){if(!e)return e;if(e&&e._placeholder)return n[e.num];if(Wa(e))for(var o=0;o<e.length;o++)e[o]=t(e[o],n);else if("object"==typeof e)for(var r in e)e[r]=t(e[r],n);return e}(t.data,e),t.attachments=void 0,t},Gl.removeBlobs=function(t,e){var r=0,i=t;!function t(s,a,l){if(!s)return s;if(n&&s instanceof Blob||o&&s instanceof File){r++;var u=new FileReader;u.onload=function(){l?l[a]=this.result:i=this.result,--r||e(i)},u.readAsArrayBuffer(s)}else if(Wa(s))for(var p=0;p<s.length;p++)t(s[p],p,s);else if("object"==typeof s&&!Vl(s))for(var c in s)t(s[c],c,s)}(i),r||e(i)}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var $l={};function Kl(t){var e;function n(){if(n.enabled){var t=n,o=+new Date,r=o-(e||o);t.diff=r,t.prev=e,t.curr=o,e=o;for(var i=new Array(arguments.length),s=0;s<i.length;s++)i[s]=arguments[s];i[0]=$l.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var a=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(e,n){if("%%"===e)return e;a++;var o=$l.formatters[n];if("function"==typeof o){var r=i[a];e=o.call(t,r),i.splice(a,1),a--}return e}),$l.formatArgs.call(t,i),(n.log||$l.log||console.log.bind(console)).apply(t,i)}}return n.namespace=t,n.enabled=$l.enabled(t),n.useColors=$l.useColors(),n.color=function(t){var e,n=0;for(e in t)n=(n<<5)-n+t.charCodeAt(e),n|=0;return $l.colors[Math.abs(n)%$l.colors.length]}(t),n.destroy=Yl,"function"==typeof $l.init&&$l.init(n),$l.instances.push(n),n}function Yl(){var t=$l.instances.indexOf(this);return-1!==t&&($l.instances.splice(t,1),!0)}($l=$l=Kl.debug=Kl.default=Kl).coerce=function(t){return t instanceof Error?t.stack||t.message:t},$l.disable=function(){$l.enable("")},$l.enable=function(t){var e;$l.save(t),$l.names=[],$l.skips=[];var n=("string"==typeof t?t:"").split(/[\s,]+/),o=n.length;for(e=0;e<o;e++)n[e]&&("-"===(t=n[e].replace(/\*/g,".*?"))[0]?$l.skips.push(new RegExp("^"+t.substr(1)+"$")):$l.names.push(new RegExp("^"+t+"$")));for(e=0;e<$l.instances.length;e++){var r=$l.instances[e];r.enabled=$l.enabled(r.namespace)}},$l.enabled=function(t){if("*"===t[t.length-1])return!0;var e,n;for(e=0,n=$l.skips.length;e<n;e++)if($l.skips[e].test(t))return!1;for(e=0,n=$l.names.length;e<n;e++)if($l.names[e].test(t))return!0;return!1},$l.humanize=pl,$l.instances=[],$l.names=[],$l.skips=[],$l.formatters={};var Jl={};(function(t){function e(){var e;try{e=Jl.storage.debug}catch(t){}return!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG),e}(Jl=Jl=$l).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},Jl.formatArgs=function(t){var e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+Jl.humanize(this.diff),e){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var o=0,r=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(o++,"%c"===t&&(r=o))}),t.splice(r,0,n)}},Jl.save=function(t){try{null==t?Jl.storage.removeItem("debug"):Jl.storage.debug=t}catch(t){}},Jl.load=e,Jl.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},Jl.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),Jl.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],Jl.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},Jl.enable(e())}).call(this,Rt);var Ql={},Zl=Jl("socket.io-parser");function tu(){}Ql.protocol=4,Ql.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],Ql.CONNECT=0,Ql.DISCONNECT=1,Ql.EVENT=2,Ql.ACK=3,Ql.ERROR=4,Ql.BINARY_EVENT=5,Ql.BINARY_ACK=6,Ql.Encoder=tu,Ql.Decoder=ou;var eu=Ql.ERROR+'"encode error"';function nu(t){var e=""+t.type;if(Ql.BINARY_EVENT!==t.type&&Ql.BINARY_ACK!==t.type||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data){var n=function(t){try{return JSON.stringify(t)}catch(t){return!1}}(t.data);if(!1===n)return eu;e+=n}return Zl("encoded %j as %s",t,e),e}function ou(){this.reconstructor=null}function ru(t){this.reconPack=t,this.buffers=[]}function iu(t){return{type:Ql.ERROR,data:"parser error: "+t}}tu.prototype.encode=function(t,e){Zl("encoding packet %j",t),Ql.BINARY_EVENT===t.type||Ql.BINARY_ACK===t.type?function(t,e){Gl.removeBlobs(t,function(t){var n=Gl.deconstructPacket(t),o=nu(n.packet),r=n.buffers;r.unshift(o),e(r)})}(t,e):e([nu(t)])},bs(ou.prototype),ou.prototype.add=function(t){var e;if("string"==typeof t)e=function(t){var e=0,n={type:Number(t.charAt(0))};if(null==Ql.types[n.type])return iu("unknown packet type "+n.type);if(Ql.BINARY_EVENT===n.type||Ql.BINARY_ACK===n.type){for(var o="";"-"!==t.charAt(++e)&&(o+=t.charAt(e),e!=t.length););if(o!=Number(o)||"-"!==t.charAt(e))throw new Error("Illegal attachments");n.attachments=Number(o)}if("/"===t.charAt(e+1))for(n.nsp="";++e;){if(","===(i=t.charAt(e)))break;if(n.nsp+=i,e===t.length)break}else n.nsp="/";var r=t.charAt(e+1);if(""!==r&&Number(r)==r){for(n.id="";++e;){var i;if(null==(i=t.charAt(e))||Number(i)!=i){--e;break}if(n.id+=t.charAt(e),e===t.length)break}n.id=Number(n.id)}if(t.charAt(++e)){var s=function(t){try{return JSON.parse(t)}catch(t){return!1}}(t.substr(e));if(!(!1!==s&&(n.type===Ql.ERROR||Wa(s))))return iu("invalid payload");n.data=s}return Zl("decoded %s as %j",t,n),n}(t),Ql.BINARY_EVENT===e.type||Ql.BINARY_ACK===e.type?(this.reconstructor=new ru(e),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",e)):this.emit("decoded",e);else{if(!Vl(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(e=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",e))}},ou.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},ru.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=Gl.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},ru.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]};var su=function(t,e){for(var n=[],o=(e=e||0)||0;o<t.length;o++)n[o-e]=t[o];return n},au={},lu=Xl("socket.io-client:socket");au=au=cu;var uu={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},pu=bs.prototype.emit;function cu(t,e,n){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}bs(cu.prototype),cu.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[zl(t,"open",Ps(this,"onopen")),zl(t,"packet",Ps(this,"onpacket")),zl(t,"close",Ps(this,"onclose"))]}},cu.prototype.open=cu.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},cu.prototype.send=function(){var t=su(arguments);return t.unshift("message"),this.emit.apply(this,t),this},cu.prototype.emit=function(t){if(uu.hasOwnProperty(t))return pu.apply(this,arguments),this;var e=su(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:Xa(e))?Ql.BINARY_EVENT:Ql.EVENT,data:e,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(lu("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},cu.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},cu.prototype.onopen=function(){if(lu("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"==typeof this.query?ml.encode(this.query):this.query;lu("sending connect packet with query %s",t),this.packet({type:Ql.CONNECT,query:t})}else this.packet({type:Ql.CONNECT})},cu.prototype.onclose=function(t){lu("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},cu.prototype.onpacket=function(t){var e=t.nsp===this.nsp,n=t.type===Ql.ERROR&&"/"===t.nsp;if(e||n)switch(t.type){case Ql.CONNECT:this.onconnect();break;case Ql.EVENT:case Ql.BINARY_EVENT:this.onevent(t);break;case Ql.ACK:case Ql.BINARY_ACK:this.onack(t);break;case Ql.DISCONNECT:this.ondisconnect();break;case Ql.ERROR:this.emit("error",t.data)}},cu.prototype.onevent=function(t){var e=t.data||[];lu("emitting event %j",e),null!=t.id&&(lu("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?pu.apply(this,e):this.receiveBuffer.push(e)},cu.prototype.ack=function(t){var e=this,n=!1;return function(){if(!n){n=!0;var o=su(arguments);lu("sending ack %j",o),e.packet({type:Xa(o)?Ql.BINARY_ACK:Ql.ACK,id:t,data:o})}}},cu.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(lu("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):lu("bad ack %s",t.id)},cu.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},cu.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)pu.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},cu.prototype.ondisconnect=function(){lu("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},cu.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},cu.prototype.close=cu.prototype.disconnect=function(){return this.connected&&(lu("performing disconnect (%s)",this.nsp),this.packet({type:Ql.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},cu.prototype.compress=function(t){return this.flags.compress=t,this},cu.prototype.binary=function(t){return this.flags.binary=t,this};var fu={},du=Xl("socket.io-client:manager"),hu=Object.prototype.hasOwnProperty;function yu(t,e){if(!(this instanceof yu))return new yu(t,e);t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new Ss({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=e.parser||Ql;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}fu=yu,yu.prototype.emitAll=function(){for(var t in this.emit.apply(this,arguments),this.nsps)hu.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},yu.prototype.updateSocketIds=function(){for(var t in this.nsps)hu.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},yu.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},bs(yu.prototype),yu.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},yu.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},yu.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},yu.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},yu.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},yu.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},yu.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},yu.prototype.open=yu.prototype.connect=function(t,e){if(du("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;du("opening %s",this.uri),this.engine=Nl(this.uri,this.opts);var n=this.engine,o=this;this.readyState="opening",this.skipReconnect=!1;var r=zl(n,"open",function(){o.onopen(),t&&t()}),i=zl(n,"error",function(e){if(du("connect_error"),o.cleanup(),o.readyState="closed",o.emitAll("connect_error",e),t){var n=new Error("Connection error");n.data=e,t(n)}else o.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;du("connect attempt will timeout after %d",s);var a=setTimeout(function(){du("connect attempt timed out after %d",s),r.destroy(),n.close(),n.emit("error","timeout"),o.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(a)}})}return this.subs.push(r),this.subs.push(i),this},yu.prototype.onopen=function(){du("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(zl(t,"data",Ps(this,"ondata"))),this.subs.push(zl(t,"ping",Ps(this,"onping"))),this.subs.push(zl(t,"pong",Ps(this,"onpong"))),this.subs.push(zl(t,"error",Ps(this,"onerror"))),this.subs.push(zl(t,"close",Ps(this,"onclose"))),this.subs.push(zl(this.decoder,"decoded",Ps(this,"ondecoded")))},yu.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},yu.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},yu.prototype.ondata=function(t){this.decoder.add(t)},yu.prototype.ondecoded=function(t){this.emit("packet",t)},yu.prototype.onerror=function(t){du("error",t),this.emitAll("error",t)},yu.prototype.socket=function(t,e){var n=this.nsps[t];if(!n){n=new au(this,t,e),this.nsps[t]=n;var o=this;n.on("connecting",r),n.on("connect",function(){n.id=o.generateId(t)}),this.autoConnect&&r()}function r(){~jl(o.connecting,n)||o.connecting.push(n)}return n},yu.prototype.destroy=function(t){var e=jl(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},yu.prototype.packet=function(t){du("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(n){for(var o=0;o<n.length;o++)e.engine.write(n[o],t.options);e.encoding=!1,e.processPacketQueue()}))},yu.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},yu.prototype.cleanup=function(){du("cleanup");for(var t=this.subs.length,e=0;e<t;e++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},yu.prototype.close=yu.prototype.disconnect=function(){du("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},yu.prototype.onclose=function(t){du("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},yu.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)du("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();du("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var n=setTimeout(function(){t.skipReconnect||(du("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(du("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(du("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(n)}})}},yu.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)};var mu={};(function(t){var e=Xl("socket.io-client:url");mu=function(n,o){var r=n;o=o||t.location,null==n&&(n=o.protocol+"//"+o.host),"string"==typeof n&&("/"===n.charAt(0)&&(n="/"===n.charAt(1)?o.protocol+n:o.host+n),/^(https?|wss?):\/\//.test(n)||(e("protocol-less url %s",n),n=void 0!==o?o.protocol+"//"+n:"https://"+n),e("parse %s",n),r=Ml(n)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";var i=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+i+":"+r.port,r.href=r.protocol+"://"+i+(o&&o.port===r.port?"":":"+r.port),r}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var gu={},vu=Xl("socket.io-client"),bu=(gu=gu=wu).managers={};function wu(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var n,o=mu(t),r=o.source,i=o.id,s=o.path,a=bu[i]&&s in bu[i].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||a?(vu("ignoring socket cache for %s",r),n=fu(r,e)):(bu[i]||(vu("new io instance for %s",r),bu[i]=fu(r,e)),n=bu[i]),o.query&&!e.query&&(e.query=o.query),n.socket(o.path,e)}gu.protocol=Ql.protocol,gu.connect=wu,gu.Manager=fu,gu.Socket=au;var Su="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_u=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Cu=void 0,Pu=["ASSEMBLY_UPLOADING","ASSEMBLY_EXECUTING","ASSEMBLY_COMPLETED"];function Eu(t,e){return Pu.indexOf(t)>=Pu.indexOf(e)}var Fu=function(t){function e(n){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Su(e))&&"function"!=typeof e?t:e}(this,t.call(this));return o.status=n,o.socket=null,o.pollInterval=null,o.closed=!1,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Su(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.connect=function(){this._connectSocket(),this._beginPolling()},e.prototype._onFinished=function(){this.emit("finished"),this.close()},e.prototype._connectSocket=function(){var t=this,e=function(t){var e=/^\w+:\/\//.exec(t),n=0;e&&(n=e[0].length+1);var o=t.indexOf("/",n);return-1===o?{origin:t,pathname:"/"}:{origin:t.slice(0,o),pathname:t.slice(o)}}(this.status.websocket_url),n=(Cu||(Cu=gu),Cu).connect(e.origin,{transports:["websocket"],path:e.pathname});n.on("connect",function(){n.emit("assembly_connect",{id:t.status.assembly_id}),t.emit("connect")}),n.on("error",function(){n.disconnect(),t.socket=null}),n.on("assembly_finished",function(){t._onFinished()}),n.on("assembly_upload_finished",function(e){t.emit("upload",e),t._fetchStatus({diff:!1})}),n.on("assembly_uploading_finished",function(){t.emit("executing"),t._fetchStatus({diff:!1})}),n.on("assembly_upload_meta_data_extracted",function(){t.emit("metadata"),t._fetchStatus({diff:!1})}),n.on("assembly_result_finished",function(e,n){t.emit("result",e,n),t._fetchStatus({diff:!1})}),n.on("assembly_error",function(e){t._onError(e),t._fetchStatus({diff:!1})}),this.socket=n},e.prototype._onError=function(t){this.emit("error",_u(new Error(t.message),t))},e.prototype._beginPolling=function(){var t=this;this.pollInterval=setInterval(function(){t.socket&&t.socket.connected||t._fetchStatus()},2e3)},e.prototype._fetchStatus=function(){var t=this,e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).diff,n=void 0===e||e;return fetch(this.status.assembly_ssl_url).then(function(t){return t.json()}).then(function(e){t.closed||(t.emit("status",e),n?t.updateStatus(e):t.status=e)})},e.prototype.update=function(){return this._fetchStatus({diff:!0})},e.prototype.updateStatus=function(t){this._diffStatus(this.status,t),this.status=t},e.prototype._diffStatus=function(t,e){var n=this,o=t.ok,r=e.ok;if(e.error&&!t.error)return this._onError(e);var i=Eu(r,"ASSEMBLY_EXECUTING")&&!Eu(o,"ASSEMBLY_EXECUTING");i&&this.emit("executing"),Object.keys(e.uploads).filter(function(e){return!t.uploads.hasOwnProperty(e)}).map(function(t){return e.uploads[t]}).forEach(function(t){n.emit("upload",t)}),i&&this.emit("metadata"),Object.keys(e.results).forEach(function(o){var r=e.results[o],i=t.results[o];r.filter(function(t){return!i||!i.some(function(e){return e.id===t.id})}).forEach(function(t){n.emit("result",o,t)})}),Eu(r,"ASSEMBLY_COMPLETED")&&!Eu(o,"ASSEMBLY_COMPLETED")&&this.emit("finished")},e.prototype.close=function(){this.closed=!0,this.socket&&(this.socket.disconnect(),this.socket=null),clearInterval(this.pollInterval)},e}(bs);function ku(t){if(!t)throw new Error("Transloadit: The `params` option is required.");if("string"==typeof t)try{t=JSON.parse(t)}catch(t){throw t.message="Transloadit: The `params` option is a malformed JSON string: "+t.message,t}if(!t.auth||!t.auth.key)throw new Error("Transloadit: The `params.auth.key` option is required. You can find your Transloadit API key at https://transloadit.com/account/api-settings.")}var Ou=(Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t})(function(){function t(e,n){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.files=e,this.opts=n}return t.prototype._normalizeAssemblyOptions=function(t,e){if(Array.isArray(e.fields)){var n=e.fields;e.fields={},n.forEach(function(n){e.fields[n]=t.meta[n]})}return e.fields||(e.fields={}),e},t.prototype._getAssemblyOptions=function(t){var e=this,n=this.opts;return Promise.resolve().then(function(){return n.getAssemblyOptions(t,n)}).then(function(n){return e._normalizeAssemblyOptions(t,n)}).then(function(e){return ku(e.params),{fileIDs:[t.id],options:e}})},t.prototype._dedupe=function(t){var e=Object.create(null);return t.forEach(function(t){var n,o=t.fileIDs,r=t.options,i=JSON.stringify(r);e[i]?(n=e[i].fileIDs).push.apply(n,o):e[i]={options:r,fileIDs:[].concat(o)}}),Object.keys(e).map(function(t){return e[t]})},t.prototype.build=function(){var t=this,e=this.opts;return this.files.length>0?Promise.all(this.files.map(function(e){return t._getAssemblyOptions(e)})).then(function(e){return t._dedupe(e)}):e.alwaysRunAssembly?Promise.resolve(e.getAssemblyOptions(null,e)).then(function(e){return ku(e.params),[{fileIDs:t.files.map(function(t){return t.id}),options:e}]}):Promise.resolve([])},t}(),{validateParams:ku}),Tu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Au=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Tu(e))&&"function"!=typeof e?t:e}(this,t.call(this));return r._uppy=n,r._assemblyIDs=o,r._remaining=o.length,r.promise=new Promise(function(t,e){r._resolve=t,r._reject=e}),r._onAssemblyComplete=r._onAssemblyComplete.bind(r),r._onAssemblyError=r._onAssemblyError.bind(r),r._onImportError=r._onImportError.bind(r),r._addListeners(),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Tu(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._watching=function(t){return-1!==this._assemblyIDs.indexOf(t)},e.prototype._onAssemblyComplete=function(t){this._watching(t.assembly_id)&&(this._uppy.log("[Transloadit] AssemblyWatcher: Got Assembly finish "+t.assembly_id),this.emit("assembly-complete",t.assembly_id),this._checkAllComplete())},e.prototype._onAssemblyError=function(t,e){this._watching(t.assembly_id)&&(this._uppy.log("[Transloadit] AssemblyWatcher: Got Assembly error "+t.assembly_id),this._uppy.log(e),this.emit("assembly-error",t.assembly_id,e),this._checkAllComplete())},e.prototype._onImportError=function(t,e,n){this._watching(t.assembly_id)&&this._onAssemblyError(t,n)},e.prototype._checkAllComplete=function(){this._remaining-=1,0===this._remaining&&(this._removeListeners(),this._resolve())},e.prototype._removeListeners=function(){this._uppy.off("transloadit:complete",this._onAssemblyComplete),this._uppy.off("transloadit:assembly-error",this._onAssemblyError),this._uppy.off("transloadit:import-error",this._onImportError)},e.prototype._addListeners=function(){this._uppy.on("transloadit:complete",this._onAssemblyComplete),this._uppy.on("transloadit:assembly-error",this._onAssemblyError),this._uppy.on("transloadit:import-error",this._onImportError)},e}(bs),Uu=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.opts=e}return t.prototype.createAssembly=function(t){t.templateId;var e=t.params,n=t.fields,o=t.signature,r=t.expectedFiles,i=new FormData;return i.append("params","string"==typeof e?e:JSON.stringify(e)),o&&i.append("signature",o),Object.keys(n).forEach(function(t){i.append(t,n[t])}),i.append("num_expected_upload_files",r),fetch(this.opts.service+"/assemblies",{method:"post",body:i}).then(function(t){return t.json()}).then(function(t){if(t.error){var e=new Error(t.error);throw e.message=t.error,e.details=t.reason,e}return t})},t.prototype.reserveFile=function(t,e){var n=encodeURIComponent(e.size);return fetch(t.assembly_ssl_url+"/reserve_file?size="+n,{method:"post"}).then(function(t){return t.json()})},t.prototype.addFile=function(t,e){if(!e.uploadURL)return Promise.reject(new Error("File does not have an `uploadURL`."));var n=encodeURIComponent(e.size),o=encodeURIComponent(e.uploadURL),r="size="+n+"&filename="+encodeURIComponent(e.name)+"&fieldname=file&s3Url="+o;return fetch(t.assembly_ssl_url+"/add_file?"+r,{method:"post"}).then(function(t){return t.json()})},t.prototype.getAssemblyStatus=function(t){return fetch(t).then(function(t){return t.json()})},t}(),xu={};Object.defineProperty(xu,"__esModule",{value:!0}),xu.setItem=function(t,e){if(Ru)return localStorage.setItem(t,e)},xu.getItem=function(t){if(Ru)return localStorage.getItem(t)},xu.removeItem=function(t){if(Ru)return localStorage.removeItem(t)};var Ru=!1;try{Ru="localStorage"in window;var Du="tusSupport";localStorage.setItem(Du,localStorage.getItem(Du))}catch(t){if(t.code!==t.SECURITY_ERR&&t.code!==t.QUOTA_EXCEEDED_ERR)throw t;Ru=!1}xu.canStoreURLs=Ru;var ju=Object.prototype.hasOwnProperty,Bu=Object.prototype.toString,Iu=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===Bu.call(t)},Mu=function(t){if(!t||"[object Object]"!==Bu.call(t))return!1;var e,n=ju.call(t,"constructor"),o=t.constructor&&t.constructor.prototype&&ju.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!o)return!1;for(e in t);return void 0===e||ju.call(t,e)},Lu={};Object.defineProperty(Lu,"__esModule",{value:!0}),Lu.encode=function(t){return Nu(unescape(encodeURIComponent(t)))};var Nu=window.btoa;Lu.isSupported="btoa"in window;var zu={};Object.defineProperty(zu,"__esModule",{value:!0}),zu.newRequest=function(){return new window.XMLHttpRequest},zu.resolveUrl=function(t,e){return(0,Hu.default)(t,e)};var qu,Hu=(qu=vt)&&qu.__esModule?qu:{default:qu},Wu={},Xu=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();Object.defineProperty(Wu,"__esModule",{value:!0}),Wu.getSource=function(t){if("function"==typeof t.slice&&void 0!==t.size)return new Vu(t);throw new Error("source object may only be an instance of File or Blob in this environment")};var Vu=function(){function t(e){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this._file=e,this.size=e.size}return Xu(t,[{key:"slice",value:function(t,e){return this._file.slice(t,e)}},{key:"close",value:function(){}}]),t}(),Gu={};Object.defineProperty(Gu,"__esModule",{value:!0});var $u=function(t){function e(t){var n=arguments.length<=1||void 0===arguments[1]?null:arguments[1],o=arguments.length<=2||void 0===arguments[2]?null:arguments[2];!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,Object.getPrototypeOf(e).call(this,t.message));r.originalRequest=o,r.causingError=n;var i=t.message;return null!=n&&(i+=", caused by "+n.toString()),null!=o&&(i+=", originated from request (response code: "+o.status+", response text: "+o.responseText+")"),r.message=i,r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,Error),e}();Gu.default=$u;var Ku={};Object.defineProperty(Ku,"__esModule",{value:!0}),Ku.default=function(t,e){return["tus",t.name,t.type,t.size,t.lastModified,e.endpoint].join("-")};var Yu={},Ju=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();Object.defineProperty(Yu,"__esModule",{value:!0});var Qu=rp(Ku),Zu=rp(Gu),tp=rp(function t(){var e,n,o,r,i,s,a=arguments[0],l=1,u=arguments.length,p=!1;for("boolean"==typeof a&&(p=a,a=arguments[1]||{},l=2),(null==a||"object"!=typeof a&&"function"!=typeof a)&&(a={});l<u;++l)if(null!=(e=arguments[l]))for(n in e)o=a[n],a!==(r=e[n])&&(p&&r&&(Mu(r)||(i=Iu(r)))?(i?(i=!1,s=o&&Iu(o)?o:[]):s=o&&Mu(o)?o:{},a[n]=t(p,s,r)):void 0!==r&&(a[n]=r));return a}),ep=op(Lu),np=op(xu);function op(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function rp(t){return t&&t.__esModule?t:{default:t}}var ip={endpoint:null,fingerprint:Qu.default,resume:!0,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,headers:{},chunkSize:1/0,withCredentials:!1,uploadUrl:null,uploadSize:null,overridePatchMethod:!1,retryDelays:null,removeFingerprintOnSuccess:!1},sp=function(){function t(e,n){!function(e,n){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this),this.options=(0,tp.default)(!0,{},ip,n),this.file=e,this.url=null,this._xhr=null,this._fingerprint=null,this._offset=null,this._aborted=!1,this._size=null,this._source=null,this._retryAttempt=0,this._retryTimeout=null,this._offsetBeforeRetry=0}return Ju(t,[{key:"start",value:function(){var t=this,e=this.file;if(e)if(this.options.endpoint||this.options.uploadUrl){var n=this._source=(0,Wu.getSource)(e,this.options.chunkSize);if(null!=this.options.uploadSize){var o=+this.options.uploadSize;if(isNaN(o))throw new Error("tus: cannot convert `uploadSize` option into a number");this._size=o}else{if(null==(o=n.size))throw new Error("tus: cannot automatically derive upload's size from input and must be specified manually using the `uploadSize` option");this._size=o}var r,i=this.options.retryDelays;if(null!=i){if("[object Array]"!==Object.prototype.toString.call(i))throw new Error("tus: the `retryDelays` option must either be an array or null");r=t.options.onError,t.options.onError=function(e){t.options.onError=r,null!=t._offset&&t._offset>t._offsetBeforeRetry&&(t._retryAttempt=0);var n=!0;if("undefined"!=typeof window&&"navigator"in window&&!1===window.navigator.onLine&&(n=!1),t._retryAttempt<i.length&&null!=e.originalRequest&&!ap(e.originalRequest.status,400)&&n){var o=i[t._retryAttempt++];t._offsetBeforeRetry=t._offset,t.options.uploadUrl=t.url,t._retryTimeout=setTimeout(function(){t.start()},o)}else t._emitError(e)}}if(this._aborted=!1,null==this.url){if(null!=this.options.uploadUrl)return this.url=this.options.uploadUrl,void this._resumeUpload();if(this.options.resume){this._fingerprint=this.options.fingerprint(e,this.options);var s=np.getItem(this._fingerprint);if(null!=s)return this.url=s,void this._resumeUpload()}this._createUpload()}else this._resumeUpload()}else this._emitError(new Error("tus: neither an endpoint or an upload URL is provided"));else this._emitError(new Error("tus: no file or stream to upload provided"))}},{key:"abort",value:function(){null!==this._xhr&&(this._xhr.abort(),this._source.close(),this._aborted=!0),null!=this._retryTimeout&&(clearTimeout(this._retryTimeout),this._retryTimeout=null)}},{key:"_emitXhrError",value:function(t,e,n){this._emitError(new Zu.default(e,n,t))}},{key:"_emitError",value:function(t){if("function"!=typeof this.options.onError)throw t;this.options.onError(t)}},{key:"_emitSuccess",value:function(){"function"==typeof this.options.onSuccess&&this.options.onSuccess()}},{key:"_emitProgress",value:function(t,e){"function"==typeof this.options.onProgress&&this.options.onProgress(t,e)}},{key:"_emitChunkComplete",value:function(t,e,n){"function"==typeof this.options.onChunkComplete&&this.options.onChunkComplete(t,e,n)}},{key:"_setupXHR",value:function(t){this._xhr=t,t.setRequestHeader("Tus-Resumable","1.0.0");var e=this.options.headers;for(var n in e)t.setRequestHeader(n,e[n]);t.withCredentials=this.options.withCredentials}},{key:"_createUpload",value:function(){var t=this;if(this.options.endpoint){var e=(0,zu.newRequest)();e.open("POST",this.options.endpoint,!0),e.onload=function(){if(ap(e.status,200)){var n=e.getResponseHeader("Location");if(null!=n){if(t.url=(0,zu.resolveUrl)(t.options.endpoint,n),0===t._size)return t._emitSuccess(),void t._source.close();t.options.resume&&np.setItem(t._fingerprint,t.url),t._offset=0,t._startUpload()}else t._emitXhrError(e,new Error("tus: invalid or missing Location header"))}else t._emitXhrError(e,new Error("tus: unexpected response while creating upload"))},e.onerror=function(n){t._emitXhrError(e,new Error("tus: failed to create upload"),n)},this._setupXHR(e),e.setRequestHeader("Upload-Length",this._size);var n=function(t){if(!ep.isSupported)return"";var e=[];for(var n in t)e.push(n+" "+ep.encode(t[n]));return e.join(",")}(this.options.metadata);""!==n&&e.setRequestHeader("Upload-Metadata",n),e.send(null)}else this._emitError(new Error("tus: unable to create upload because no endpoint is provided"))}},{key:"_resumeUpload",value:function(){var t=this,e=(0,zu.newRequest)();e.open("HEAD",this.url,!0),e.onload=function(){if(!ap(e.status,200))return t.options.resume&&ap(e.status,400)&&np.removeItem(t._fingerprint),423===e.status?void t._emitXhrError(e,new Error("tus: upload is currently locked; retry later")):t.options.endpoint?(t.url=null,void t._createUpload()):void t._emitXhrError(e,new Error("tus: unable to resume upload (new upload cannot be created without an endpoint)"));var n=parseInt(e.getResponseHeader("Upload-Offset"),10);if(isNaN(n))t._emitXhrError(e,new Error("tus: invalid or missing offset value"));else{var o=parseInt(e.getResponseHeader("Upload-Length"),10);if(isNaN(o))t._emitXhrError(e,new Error("tus: invalid or missing length value"));else{if(n===o)return t._emitProgress(o,o),void t._emitSuccess();t._offset=n,t._startUpload()}}},e.onerror=function(n){t._emitXhrError(e,new Error("tus: failed to resume upload"),n)},this._setupXHR(e),e.send(null)}},{key:"_startUpload",value:function(){var t=this;if(!this._aborted){var e=(0,zu.newRequest)();this.options.overridePatchMethod?(e.open("POST",this.url,!0),e.setRequestHeader("X-HTTP-Method-Override","PATCH")):e.open("PATCH",this.url,!0),e.onload=function(){if(ap(e.status,200)){var n=parseInt(e.getResponseHeader("Upload-Offset"),10);if(isNaN(n))t._emitXhrError(e,new Error("tus: invalid or missing offset value"));else{if(t._emitProgress(n,t._size),t._emitChunkComplete(n-t._offset,n,t._size),t._offset=n,n==t._size)return t.options.removeFingerprintOnSuccess&&t.options.resume&&np.removeItem(t._fingerprint),t._emitSuccess(),void t._source.close();t._startUpload()}}else t._emitXhrError(e,new Error("tus: unexpected response while uploading chunk"))},e.onerror=function(n){t._aborted||t._emitXhrError(e,new Error("tus: failed to upload chunk at offset "+t._offset),n)},"upload"in e&&(e.upload.onprogress=function(e){e.lengthComputable&&t._emitProgress(n+e.loaded,t._size)}),this._setupXHR(e),e.setRequestHeader("Upload-Offset",this._offset),e.setRequestHeader("Content-Type","application/offset+octet-stream");var n=this._offset,o=this._offset+this.options.chunkSize;(o===1/0||o>this._size)&&(o=this._size),e.send(this._source.slice(n,o)),this._emitProgress(this._offset,this._size)}}}]),t}();function ap(t,e){return t>=e&&t<e+100}sp.defaultOptions=ip,Yu.default=sp;var lp,up=(lp=Yu)&&lp.__esModule?lp:{default:lp};up.default.defaultOptions;if("undefined"!=typeof window){var pp=window,cp=pp.XMLHttpRequest,fp=pp.Blob;cp&&fp&&fp.prototype.slice}else!0;var dp={Upload:up.default},hp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yp=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},mp=m.Provider,gp=m.RequestClient,vp=m.Socket,bp={endpoint:"",resume:!0,onProgress:null,onChunkComplete:null,onSuccess:null,onError:null,headers:{},chunkSize:1/0,withCredentials:!1,uploadUrl:null,uploadSize:null,overridePatchMethod:!1,retryDelays:null};function wp(t){var e=[];return{on:function(n,o){return e.push([n,o]),t.on(n,o)},remove:function(){e.forEach(function(e){var n=e[0],o=e[1];t.off(n,o)})}}}var Sp=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":hp(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));return r.type="uploader",r.id="Tus",r.title="Tus",r.opts=yp({},{resume:!0,autoRetry:!0,useFastRemoteRetry:!0,limit:0,retryDelays:[0,1e3,3e3,5e3]},o),"number"==typeof r.opts.limit&&0!==r.opts.limit?r.limitUploads=ut(r.opts.limit):r.limitUploads=function(t){return t},r.uploaders=Object.create(null),r.uploaderEvents=Object.create(null),r.uploaderSockets=Object.create(null),r.handleResetProgress=r.handleResetProgress.bind(r),r.handleUpload=r.handleUpload.bind(r),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":hp(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.handleResetProgress=function(){var t=yp({},this.uppy.getState().files);Object.keys(t).forEach(function(e){if(t[e].tus&&t[e].tus.uploadUrl){var n=yp({},t[e].tus);delete n.uploadUrl,t[e]=yp({},t[e],{tus:n})}}),this.uppy.setState({files:t})},e.prototype.resetUploaderReferences=function(t){this.uploaders[t]&&(this.uploaders[t].abort(),this.uploaders[t]=null),this.uploaderEvents[t]&&(this.uploaderEvents[t].remove(),this.uploaderEvents[t]=null),this.uploaderSockets[t]&&(this.uploaderSockets[t].close(),this.uploaderSockets[t]=null)},e.prototype.upload=function(t,e,n){var o=this;return this.resetUploaderReferences(t.id),new Promise(function(e,n){var r=yp({},bp,o.opts,t.tus||{});r.onError=function(e){o.uppy.log(e),o.uppy.emit("upload-error",t,e),e.message="Failed because: "+e.message,o.resetUploaderReferences(t.id),n(e)},r.onProgress=function(e,n){o.onReceiveUploadUrl(t,a.url),o.uppy.emit("upload-progress",t,{uploader:o,bytesUploaded:e,bytesTotal:n})},r.onSuccess=function(){o.uppy.emit("upload-success",t,a,a.url),a.url&&o.uppy.log("Download "+a.file.name+" from "+a.url),o.resetUploaderReferences(t.id),e(a)};var i=function(t,e,n){Object.prototype.hasOwnProperty.call(t,e)&&!Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=t[e])},s=yp({},t.meta);i(s,"type","filetype"),i(s,"name","filename"),r.metadata=s;var a=new dp.Upload(t.data,r);o.uploaders[t.id]=a,o.uploaderEvents[t.id]=wp(o.uppy),o.onFileRemove(t.id,function(n){o.resetUploaderReferences(t.id),e("upload "+n+" was removed")}),o.onPause(t.id,function(t){t?a.abort():a.start()}),o.onPauseAll(t.id,function(){a.abort()}),o.onCancelAll(t.id,function(){o.resetUploaderReferences(t.id)}),o.onResumeAll(t.id,function(){t.error&&a.abort(),a.start()}),t.isPaused||a.start()})},e.prototype.uploadRemote=function(t,e,n){var o=this;this.resetUploaderReferences(t.id);var r=yp({},this.opts,t.tus||{});return new Promise(function(e,n){if(o.uppy.log(t.remote.url),t.serverToken)return o.connectToServerSocket(t).then(function(){return e()}).catch(n);o.uppy.emit("upload-started",t),new(t.remote.providerOptions.provider?mp:gp)(o.uppy,t.remote.providerOptions).post(t.remote.url,yp({},t.remote.body,{endpoint:r.endpoint,uploadUrl:r.uploadUrl,protocol:"tus",size:t.data.size,metadata:t.meta})).then(function(e){return o.uppy.setFileState(t.id,{serverToken:e.token}),t=o.uppy.getFile(t.id)}).then(function(t){return o.connectToServerSocket(t)}).then(function(){e()}).catch(function(t){n(new Error(t))})})},e.prototype.connectToServerSocket=function(t){var e=this;return new Promise(function(n,o){var r=t.serverToken,i=lt(t.remote.serverUrl),s=new vp({target:i+"/api/"+r});e.uploaderSockets[t.id]=s,e.uploaderEvents[t.id]=wp(e.uppy),e.onFileRemove(t.id,function(){s.send("pause",{}),n("upload "+t.id+" was removed")}),e.onPause(t.id,function(t){t?s.send("pause",{}):s.send("resume",{})}),e.onPauseAll(t.id,function(){return s.send("pause",{})}),e.onCancelAll(t.id,function(){return s.send("pause",{})}),e.onResumeAll(t.id,function(){t.error&&s.send("pause",{}),s.send("resume",{})}),e.onRetry(t.id,function(){s.send("pause",{}),s.send("resume",{})}),e.onRetryAll(t.id,function(){s.send("pause",{}),s.send("resume",{})}),t.isPaused&&s.send("pause",{}),s.on("progress",function(n){return at(e,n,t)}),s.on("error",function(n){var r=n.error.message,i=yp(new Error(r),{cause:n.error});e.opts.useFastRemoteRetry||(e.resetUploaderReferences(t.id),e.uppy.setFileState(t.id,{serverToken:null})),e.uppy.emit("upload-error",t,i),o(i)}),s.on("success",function(o){e.uppy.emit("upload-success",t,o,o.url),e.resetUploaderReferences(t.id),n()})})},e.prototype.onReceiveUploadUrl=function(t,e){var n=this.uppy.getFile(t.id);n&&(n.tus&&n.tus.uploadUrl===e||(this.uppy.log("[Tus] Storing upload url"),this.uppy.setFileState(n.id,{tus:yp({},n.tus,{uploadUrl:e})})))},e.prototype.onFileRemove=function(t,e){this.uploaderEvents[t].on("file-removed",function(n){t===n.id&&e(n.id)})},e.prototype.onPause=function(t,e){this.uploaderEvents[t].on("upload-pause",function(n,o){t===n&&e(o)})},e.prototype.onRetry=function(t,e){this.uploaderEvents[t].on("upload-retry",function(n){t===n&&e()})},e.prototype.onRetryAll=function(t,e){var n=this;this.uploaderEvents[t].on("retry-all",function(o){n.uppy.getFile(t)&&e()})},e.prototype.onPauseAll=function(t,e){var n=this;this.uploaderEvents[t].on("pause-all",function(){n.uppy.getFile(t)&&e()})},e.prototype.onCancelAll=function(t,e){var n=this;this.uploaderEvents[t].on("cancel-all",function(){n.uppy.getFile(t)&&e()})},e.prototype.onResumeAll=function(t,e){var n=this;this.uploaderEvents[t].on("resume-all",function(){n.uppy.getFile(t)&&e()})},e.prototype.uploadFiles=function(t){var e=this,n=t.map(function(n,o){var r=parseInt(o,10)+1,i=t.length;return n.error?function(){return Promise.reject(new Error(n.error))}:n.isRemote?(e.uppy.emit("upload-started",n),e.uploadRemote.bind(e,n,r,i)):(e.uppy.emit("upload-started",n),e.upload.bind(e,n,r,i))}).map(function(t){return e.limitUploads(t)()});return bt(n)},e.prototype.handleUpload=function(t){var e=this;if(0===t.length)return this.uppy.log("Tus: no files to upload!"),Promise.resolve();this.uppy.log("Tus is uploading...");var n=t.map(function(t){return e.uppy.getFile(t)});return this.uploadFiles(n).then(function(){return null})},e.prototype.install=function(){this.uppy.setState({capabilities:yp({},this.uppy.getState().capabilities,{resumableUploads:!0})}),this.uppy.addUploader(this.handleUpload),this.uppy.on("reset-progress",this.handleResetProgress),this.opts.autoRetry&&this.uppy.on("back-online",this.uppy.retryAll)},e.prototype.uninstall=function(){this.uppy.setState({capabilities:yp({},this.uppy.getState().capabilities,{resumableUploads:!1})}),this.uppy.removeUploader(this.handleUpload),this.opts.autoRetry&&this.uppy.off("back-online",this.uppy.retryAll)},e}(Z.Plugin),_p={},Cp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Pp=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};function Ep(t,e){return{params:e.params,signature:e.signature,fields:e.fields}}var Fp="https://api2.transloadit.com/companion",kp=/https?:\/\/api2(?:-\w+)?\.transloadit\.com\/companion/,Op=/https?:\/\/api2(?:-\w+)?\.transloadit\.com\/uppy-server/;(_p=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Cp(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));r.type="uploader",r.id="Transloadit",r.title="Transloadit";var i={strings:{creatingAssembly:"Preparing upload...",creatingAssemblyFailed:"Transloadit: Could not create Assembly",encoding:"Encoding..."}},s={service:"https://api2.transloadit.com",waitForEncoding:!1,waitForMetadata:!1,alwaysRunAssembly:!1,importFromUploadURLs:!1,signature:null,params:null,fields:{},getAssemblyOptions:Ep,locale:i};r.opts=Pp({},s,o),r.translator=new G([i,r.uppy.locale,r.opts.locale]),r.i18n=r.translator.translate.bind(r.translator),r.i18nArray=r.translator.translateArray.bind(r.translator),r._prepareUpload=r._prepareUpload.bind(r),r._afterUpload=r._afterUpload.bind(r),r._handleError=r._handleError.bind(r),r._onFileUploadURLAvailable=r._onFileUploadURLAvailable.bind(r),r._onRestored=r._onRestored.bind(r),r._getPersistentData=r._getPersistentData.bind(r);var a=r.opts.getAssemblyOptions!==s.getAssemblyOptions;return r.opts.params?Ou.validateParams(r.opts.params):a||Ou.validateParams(null),r.client=new Uu({service:r.opts.service}),r.activeAssemblies={},r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Cp(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype._attachAssemblyMetadata=function(t,e){var n=Pp({},t.meta,{assembly_url:e.assembly_url,filename:t.name,fieldname:"file"}),o=Pp({},t.tus,{endpoint:e.tus_url}),r=t.remote;if(t.remote&&Op.test(t.remote.serverUrl)){var i=new Error("The https://api2.transloadit.com/uppy-server endpoint was renamed to https://api2.transloadit.com/companion, please update your `serverUrl` options accordingly.");throw this.uppy.log(i),i}if(t.remote&&kp.test(t.remote.serverUrl)){var s=e.companion_url.replace(/\/$/,""),a=t.remote.url.replace(t.remote.serverUrl,"").replace(/^\//,"");r=Pp({},t.remote,{serverUrl:s,url:s+"/"+a})}var l=Pp({},t,{transloadit:{assembly:e.assembly_id}});return this.opts.importFromUploadURLs||Pp(l,{meta:n,tus:o,remote:r}),l},e.prototype._createAssembly=function(t,e,n){var o=this;return this.uppy.log("[Transloadit] create Assembly"),this.client.createAssembly({params:n.params,fields:n.fields,expectedFiles:t.length,signature:n.signature}).then(function(n){var r,i,s=new Fu(n),a=s.status,l=o.getPluginState(),u=l.assemblies,p=l.uploadsAssemblies;o.setPluginState({assemblies:Pp({},u,(r={},r[a.assembly_id]=a,r)),uploadsAssemblies:Pp({},p,(i={},i[e]=[].concat(p[e],[a.assembly_id]),i))});var c=o.uppy.getState().files,f={};return t.forEach(function(t){f[t]=o._attachAssemblyMetadata(o.uppy.getFile(t),a)}),o.uppy.setState({files:Pp({},c,f)}),o.uppy.emit("transloadit:assembly-created",a,t),o._connectAssembly(s),o.uppy.log("[Transloadit] Created Assembly "+a.assembly_id),s}).catch(function(t){throw t.message=o.i18n("creatingAssemblyFailed")+": "+t.message,t})},e.prototype._shouldWaitAfterUpload=function(){return this.opts.waitForEncoding||this.opts.waitForMetadata},e.prototype._reserveFiles=function(t,e){var n=this;return Promise.all(e.map(function(e){var o=n.uppy.getFile(e);return n.client.reserveFile(t,o)}))},e.prototype._onFileUploadURLAvailable=function(t){var e=this;if(t&&t.transloadit&&t.transloadit.assembly){var n=this.getPluginState().assemblies[t.transloadit.assembly];this.client.addFile(n,t).catch(function(o){e.uppy.log(o),e.uppy.emit("transloadit:import-error",n,t.id,o)})}},e.prototype._findFile=function(t){for(var e=this.uppy.getFiles(),n=0;n<e.length;n++){var o=e[n];if(o.uploadURL===t.tus_upload_url)return o;if(o.tus&&o.tus.uploadUrl===t.tus_upload_url)return o;if(!t.is_tus_file&&o.name===t.name&&o.size===t.size)return o}},e.prototype._onFileUploadComplete=function(t,e){var n,o=this.getPluginState(),r=this._findFile(e);r?(this.setPluginState({files:Pp({},o.files,(n={},n[e.id]={assembly:t,id:r.id,uploadedFile:e},n))}),this.uppy.emit("transloadit:upload",e,this.getAssembly(t))):this.uppy.log("[Transloadit] Couldn\u2019t file the file, it was likely removed in the process")},e.prototype._onResult=function(t,e,n){var o=this.getPluginState(),r=o.files[n.original_id];n.localId=r?r.id:null;var i={result:n,stepName:e,id:n.id,assembly:t};this.setPluginState({results:[].concat(o.results,[i])}),this.uppy.emit("transloadit:result",e,n,this.getAssembly(t))},e.prototype._onAssemblyFinished=function(t){var e=this,n=t.assembly_ssl_url;this.client.getAssemblyStatus(n).then(function(t){var n,o=e.getPluginState();e.setPluginState({assemblies:Pp({},o.assemblies,(n={},n[t.assembly_id]=t,n))}),e.uppy.emit("transloadit:complete",t)})},e.prototype._getPersistentData=function(t){var e,n=this.getPluginState(),o=n.assemblies,r=n.uploadsAssemblies;t(((e={})[this.id]={assemblies:o,uploadsAssemblies:r},e))},e.prototype._onRestored=function(t){var e=this,n=t&&t[this.id]?t[this.id]:{},o=n.assemblies||{},r=n.uploadsAssemblies||{};0!==Object.keys(r).length&&(this.restored=Promise.resolve().then(function(){var t,n,i;return t=o,n={},i=[],Object.keys(t).forEach(function(o){var r=t[o];r.uploads.forEach(function(t){var r=e._findFile(t);n[t.id]={id:r.id,assembly:o,uploadedFile:t}});var s=e.getPluginState();Object.keys(r.results).forEach(function(t){r.results[t].forEach(function(e){var n=s.files[e.original_id];e.localId=n?n.id:null,i.push({id:e.id,result:e,stepName:t,assembly:o})})})}),e.setPluginState({assemblies:t,files:n,results:i,uploadsAssemblies:r}),function(){var t=e.getPluginState().assemblies;Object.keys(t).forEach(function(n){var o=new Fu(t[n]);e._connectAssembly(o)})}(),function(){var t=e.getPluginState().assemblies;return Promise.all(Object.keys(t).map(function(t){return e.activeAssemblies[t].update()}))}()}),this.restored.then(function(){e.restored=null}))},e.prototype._connectAssembly=function(t){var e=this,n=t.status.assembly_id;return this.activeAssemblies[n]=t,t.on("status",function(t){var o,r=e.getPluginState().assemblies;e.setPluginState({assemblies:Pp({},r,(o={},o[n]=t,o))})}),t.on("upload",function(t){e._onFileUploadComplete(n,t)}),t.on("error",function(n){e.uppy.emit("transloadit:assembly-error",t.status,n)}),t.on("executing",function(){e.uppy.emit("transloadit:assembly-executing",t.status)}),this.opts.waitForEncoding&&t.on("result",function(t,o){e._onResult(n,t,o)}),this.opts.waitForEncoding?t.on("finished",function(){e._onAssemblyFinished(t.status)}):this.opts.waitForMetadata&&t.on("metadata",function(){e._onAssemblyFinished(t.status)}),"ASSEMBLY_COMPLETE"===t.ok?t:(new Promise(function(e,n){t.once("connect",e),t.once("status",e),t.once("error",n)}).then(function(){e.uppy.log("[Transloadit] Socket is ready")}),t.connect(),t)},e.prototype._prepareUpload=function(t,e){var n,o=this;(t=t.filter(function(t){return!t.error})).forEach(function(t){var e=o.uppy.getFile(t);o.uppy.emit("preprocess-progress",e,{mode:"indeterminate",message:o.i18n("creatingAssembly")})});var r=function(t){var n=t.fileIDs,r=t.options;return o._createAssembly(n,e,r).then(function(t){if(o.opts.importFromUploadURLs)return o._reserveFiles(t,n)}).then(function(){n.forEach(function(t){var e=o.uppy.getFile(t);o.uppy.emit("preprocess-complete",e)})}).catch(function(t){throw n.forEach(function(e){var n=o.uppy.getFile(e);o.uppy.emit("preprocess-complete",n),o.uppy.emit("upload-error",n,t)}),t})},i=this.getPluginState().uploadsAssemblies;this.setPluginState({uploadsAssemblies:Pp({},i,(n={},n[e]=[],n))});var s=t.map(function(t){return o.uppy.getFile(t)});return new Ou(s,this.opts).build().then(function(t){return Promise.all(t.map(r))},function(e){throw t.forEach(function(t){var n=o.uppy.getFile(t);o.uppy.emit("preprocess-complete",n),o.uppy.emit("upload-error",n,e)}),e})},e.prototype._afterUpload=function(t,e){var n=this;t=t.filter(function(t){return!t.error});var o=this.getPluginState();if(this.restored)return this.restored.then(function(){return n._afterUpload(t,e)});var r=o.uploadsAssemblies[e];if(!this._shouldWaitAfterUpload()){r.forEach(function(t){n.activeAssemblies[t].close(),delete n.activeAssemblies[t]});var i=r.map(function(t){return n.getAssembly(t)});return this.uppy.addResultData(e,{transloadit:i}),Promise.resolve()}if(0===r.length)return this.uppy.addResultData(e,{transloadit:[]}),Promise.resolve();var s=new Au(this.uppy,r);return t.forEach(function(t){var e=n.uppy.getFile(t);n.uppy.emit("postprocess-progress",e,{mode:"indeterminate",message:n.i18n("encoding")})}),s.on("assembly-complete",function(t){n.getAssemblyFiles(t).forEach(function(t){n.uppy.emit("postprocess-complete",t)})}),s.on("assembly-error",function(t,e){n.getAssemblyFiles(t).forEach(function(t){n.uppy.emit("upload-error",t,e),n.uppy.emit("postprocess-complete",t)})}),s.promise.then(function(){var t=r.map(function(t){return n.getAssembly(t)}),o=n.getPluginState(),i=Pp({},o.uploadsAssemblies);delete i[e],n.setPluginState({uploadsAssemblies:i}),n.uppy.addResultData(e,{transloadit:t})})},e.prototype._handleError=function(t,e){var n=this;this.uppy.log("[Transloadit] _handleError in upload "+e),this.uppy.log(t),this.getPluginState().uploadsAssemblies[e].forEach(function(t){n.activeAssemblies[t]&&n.activeAssemblies[t].close()})},e.prototype.install=function(){this.uppy.addPreProcessor(this._prepareUpload),this.uppy.addPostProcessor(this._afterUpload),this.uppy.on("error",this._handleError),this.opts.importFromUploadURLs?this.uppy.on("upload-success",this._onFileUploadURLAvailable):this.uppy.use(Sp,{resume:!1,useFastRemoteRetry:!1,metaFields:["assembly_url","filename","fieldname"]}),this.uppy.on("restore:get-data",this._getPersistentData),this.uppy.on("restored",this._onRestored),this.setPluginState({assemblies:{},uploadsAssemblies:{},files:{},results:[]})},e.prototype.uninstall=function(){this.uppy.removePreProcessor(this._prepareUpload),this.uppy.removePostProcessor(this._afterUpload),this.uppy.off("error",this._handleError),this.opts.importFromUploadURLs&&this.uppy.off("upload-success",this._onFileUploadURLAvailable)},e.prototype.getAssembly=function(t){return this.getPluginState().assemblies[t]},e.prototype.getAssemblyFiles=function(t){return this.uppy.getFiles().filter(function(e){return e&&e.transloadit&&e.transloadit.assembly===t})},e}(Z.Plugin)).COMPANION=Fp,_p.UPPY_SERVER=Fp,_p.COMPANION_PATTERN=/\.transloadit\.com$/;var Tp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ap=D.h,Up=function(t){function e(n){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Tp(e))&&"function"!=typeof e?t:e}(this,t.call(this,n));return o.handleKeyPress=o.handleKeyPress.bind(o),o.handleClick=o.handleClick.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Tp(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentDidMount=function(){var t=this;this.input.value="",setTimeout(function(){t.input&&t.input.focus({preventScroll:!0})},150)},e.prototype.handleKeyPress=function(t){13===t.keyCode&&this.props.addFile(this.input.value)},e.prototype.handleClick=function(){this.props.addFile(this.input.value)},e.prototype.render=function(){var t=this;return Ap("div",{class:"uppy-Url"},Ap("input",{class:"uppy-c-textInput uppy-Url-input",type:"text","aria-label":this.props.i18n("enterUrlToImport"),placeholder:this.props.i18n("enterUrlToImport"),onkeyup:this.handleKeyPress,ref:function(e){t.input=e}}),Ap("button",{class:"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Url-importButton",type:"button",onclick:this.handleClick},this.props.i18n("import")))},e}(D.Component),xp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rp=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Dp=Z.Plugin,jp=D.h,Bp=m.RequestClient,Ip=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":xp(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));r.id=r.opts.id||"Url",r.title=r.opts.title||"Link",r.type="acquirer",r.icon=function(){return jp("svg",{"aria-hidden":"true",width:"23",height:"23",viewBox:"0 0 23 23",xmlns:"http://www.w3.org/2000/svg"},jp("path",{d:"M20.485 11.236l-2.748 2.737c-.184.182-.367.365-.642.547-1.007.73-2.107 1.095-3.298 1.095-1.65 0-3.298-.73-4.398-2.19-.275-.365-.183-1.003.183-1.277.367-.273 1.008-.182 1.283.183 1.191 1.642 3.482 1.915 5.13.73a.714.714 0 0 0 .367-.365l2.75-2.737c1.373-1.46 1.373-3.74-.093-5.108a3.72 3.72 0 0 0-5.13 0L12.33 6.4a.888.888 0 0 1-1.283 0 .88.88 0 0 1 0-1.277l1.558-1.55a5.38 5.38 0 0 1 7.605 0c2.29 2.006 2.382 5.564.274 7.662zm-8.979 6.294L9.95 19.081a3.72 3.72 0 0 1-5.13 0c-1.467-1.368-1.467-3.74-.093-5.108l2.75-2.737.366-.365c.824-.547 1.74-.82 2.748-.73 1.008.183 1.833.639 2.382 1.46.275.365.917.456 1.283.182.367-.273.458-.912.183-1.277-.916-1.186-2.199-1.915-3.573-2.098-1.374-.273-2.84.091-4.031 1.004l-.55.547-2.749 2.737c-2.107 2.189-2.015 5.655.092 7.753C4.727 21.453 6.101 22 7.475 22c1.374 0 2.749-.547 3.848-1.55l1.558-1.551a.88.88 0 0 0 0-1.278c-.367-.364-1.008-.456-1.375-.09z",fill:"#FF814F","fill-rule":"nonzero"}))};var i={strings:{import:"Import",enterUrlToImport:"Enter URL to import a file",failedToFetch:"Companion failed to fetch this URL, please make sure it\u2019s correct",enterCorrectUrl:"Incorrect URL: Please make sure you are entering a direct link to a file"}},s={locale:i};if(r.opts=Rp({},s,o),r.translator=new G([i,r.uppy.locale,r.opts.locale]),r.i18n=r.translator.translate.bind(r.translator),r.i18nArray=r.translator.translateArray.bind(r.translator),r.hostname=r.opts.serverUrl,!r.hostname)throw new Error("Companion hostname is required, please consult https://uppy.io/docs/companion");return r.getMeta=r.getMeta.bind(r),r.addFile=r.addFile.bind(r),r.handleDrop=r.handleDrop.bind(r),r.handleDragOver=r.handleDragOver.bind(r),r.handleDragLeave=r.handleDragLeave.bind(r),r.handlePaste=r.handlePaste.bind(r),r.client=new Bp(n,{serverUrl:r.opts.serverUrl,serverHeaders:r.opts.serverHeaders}),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":xp(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.getFileNameFromUrl=function(t){return t.substring(t.lastIndexOf("/")+1)},e.prototype.checkIfCorrectURL=function(t){if(!t)return!1;var e=t.match(/^([a-z0-9]+):\/\//)[1];return"http"===e||"https"===e},e.prototype.addProtocolToURL=function(t){return/^[a-z0-9]+:\/\//.test(t)?t:"http://"+t},e.prototype.getMeta=function(t){var e=this;return this.client.post("url/meta",{url:t}).then(function(t){if(t.error)throw e.uppy.log("[URL] Error:"),e.uppy.log(t.error),new Error("Failed to fetch the file");return t})},e.prototype.addFile=function(t){var e=this;return t=this.addProtocolToURL(t),this.checkIfCorrectURL(t)?this.getMeta(t).then(function(n){return{source:e.id,name:e.getFileNameFromUrl(t),type:n.type,data:{size:n.size},isRemote:!0,body:{url:t},remote:{serverUrl:e.opts.serverUrl,url:e.hostname+"/url/get",body:{fileId:t,url:t},providerOptions:e.client.opts}}}).then(function(t){e.uppy.log("[Url] Adding remote file");try{e.uppy.addFile(t)}catch(t){}}).then(function(){}).catch(function(t){e.uppy.log(t),e.uppy.info({message:e.i18n("failedToFetch"),details:t},"error",4e3)}):(this.uppy.log("[URL] Incorrect URL entered: "+t),void this.uppy.info(this.i18n("enterCorrectUrl"),"error",4e3))},e.prototype.handleDrop=function(t){var e=this;t.preventDefault(),t.dataTransfer.items&&Mn(t.dataTransfer.items).forEach(function(t){"string"===t.kind&&"text/uri-list"===t.type&&t.getAsString(function(t){e.uppy.log("[URL] Adding file from dropped url: "+t),e.addFile(t)})})},e.prototype.handleDragOver=function(t){t.preventDefault(),this.el.classList.add("drag")},e.prototype.handleDragLeave=function(t){t.preventDefault(),this.el.classList.remove("drag")},e.prototype.handlePaste=function(t){var e=this;if(t.clipboardData.items){var n=Mn(t.clipboardData.items);n.filter(function(t){return"file"===t.kind}).length>0||n.forEach(function(t){"string"===t.kind&&"text/plain"===t.type&&t.getAsString(function(t){e.uppy.log("[URL] Adding file from pasted url: "+t),e.addFile(t)})})}},e.prototype.render=function(t){return jp(Up,{i18n:this.i18n,addFile:this.addFile})},e.prototype.onMount=function(){this.el&&(this.el.addEventListener("drop",this.handleDrop),this.el.addEventListener("dragover",this.handleDragOver),this.el.addEventListener("dragleave",this.handleDragLeave),this.el.addEventListener("paste",this.handlePaste))},e.prototype.install=function(){var t=this.opts.target;t&&this.mount(t,this)},e.prototype.uninstall=function(){this.el&&(this.el.removeEventListener("drop",this.handleDrop),this.el.removeEventListener("dragover",this.handleDragOver),this.el.removeEventListener("dragleave",this.handleDragLeave),this.el.removeEventListener("paste",this.handlePaste)),this.unmount()},e}(Dp),Mp={"video/ogg":"ogv","audio/ogg":"ogg","video/webm":"webm","audio/webm":"webm","video/x-matroska":"mkv","video/mp4":"mp4","audio/mp3":"mp3"},Lp=D.h,Np=function(t){return Lp("svg",{"aria-hidden":"true",fill:"#0097DC",width:"66",height:"55",viewBox:"0 0 66 55",xmlns:"http://www.w3.org/2000/svg"},Lp("path",{d:"M57.3 8.433c4.59 0 8.1 3.51 8.1 8.1v29.7c0 4.59-3.51 8.1-8.1 8.1H8.7c-4.59 0-8.1-3.51-8.1-8.1v-29.7c0-4.59 3.51-8.1 8.1-8.1h9.45l4.59-7.02c.54-.54 1.35-1.08 2.16-1.08h16.2c.81 0 1.62.54 2.16 1.08l4.59 7.02h9.45zM33 14.64c-8.62 0-15.393 6.773-15.393 15.393 0 8.62 6.773 15.393 15.393 15.393 8.62 0 15.393-6.773 15.393-15.393 0-8.62-6.773-15.393-15.393-15.393zM33 40c-5.648 0-9.966-4.319-9.966-9.967 0-5.647 4.318-9.966 9.966-9.966s9.966 4.319 9.966 9.966C42.966 35.681 38.648 40 33 40z","fill-rule":"evenodd"}))},zp=D.h,qp=D.h,Hp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wp=D.h;function Xp(t,e){return-1!==t.indexOf(e)}var Vp=function(t){function e(){return function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Hp(e))&&"function"!=typeof e?t:e}(this,t.apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Hp(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.componentDidMount=function(){this.props.onFocus(),this.btnContainer.firstChild.focus()},e.prototype.componentWillUnmount=function(){this.props.onStop()},e.prototype.render=function(){var t,e,n,o=this,r=this.props.supportsRecording&&(Xp(this.props.modes,"video-only")||Xp(this.props.modes,"audio-only")||Xp(this.props.modes,"video-audio")),i=Xp(this.props.modes,"picture");return Wp("div",{class:"uppy uppy-Webcam-container"},Wp("div",{class:"uppy-Webcam-videoContainer"},Wp("video",{class:"uppy-Webcam-video  "+(this.props.mirror?"uppy-Webcam-video--mirrored":""),autoplay:!0,muted:!0,playsinline:!0,srcObject:this.props.src||""})),Wp("div",{class:"uppy-Webcam-buttonContainer",ref:function(t){o.btnContainer=t}},i?(t=this.props,e=t.onSnapshot,n=t.i18n,qp("button",{class:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--picture",type:"button",title:n("takePicture"),"aria-label":n("takePicture"),onclick:e},Np())):null," ",r?function(t){var e=t.recording,n=t.onStartRecording,o=t.onStopRecording,r=t.i18n;return console.log("is recording",e),e?zp("button",{class:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--video",type:"button",title:r("stopRecording"),"aria-label":r("stopRecording"),onclick:o},zp("svg",{"aria-hidden":"true",class:"UppyIcon",width:"100",height:"100",viewBox:"0 0 100 100"},zp("rect",{x:"15",y:"15",width:"70",height:"70"}))):zp("button",{class:"uppy-u-reset uppy-c-btn uppy-Webcam-button uppy-Webcam-button--video",type:"button",title:r("startRecording"),"aria-label":r("startRecording"),onclick:n},zp("svg",{"aria-hidden":"true",class:"UppyIcon",width:"100",height:"100",viewBox:"0 0 100 100"},zp("circle",{cx:"50",cy:"50",r:"40"})))}(this.props):null))},e}(D.Component),Gp=D.h,$p=function(t){return Gp("div",{class:"uppy-Webcam-permissons"},Gp("div",{class:"uppy-Webcam-permissonsIcon"},t.icon()),Gp("h1",{class:"uppy-Webcam-title"},t.i18n("allowAccessTitle")),Gp("p",null,t.i18n("allowAccessDescription")))},Kp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Yp="function"==typeof Symbol&&"symbol"===Kp(Symbol.iterator)?function(t){return void 0===t?"undefined":Kp(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":Kp(t)},Jp=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},Qp=D.h,Zp=function(t){function e(n,o){!function(t,n){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this);var r=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":Kp(e))&&"function"!=typeof e?t:e}(this,t.call(this,n,o));r.mediaDevices=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia)return navigator.mediaDevices;var t=navigator.mozGetUserMedia||navigator.webkitGetUserMedia;return t?{getUserMedia:function(e){return new Promise(function(n,o){t.call(navigator,e,n,o)})}}:null}(),r.supportsUserMedia=!!r.mediaDevices,r.protocol=location.protocol.match(/https/i)?"https":"http",r.id=r.opts.id||"Webcam",r.title=r.opts.title||"Camera",r.type="acquirer",r.icon=Np;var i={strings:{smile:"Smile!",takePicture:"Take a picture",startRecording:"Begin video recording",stopRecording:"Stop video recording",allowAccessTitle:"Please allow access to your camera",allowAccessDescription:"In order to take pictures or record video with your camera, please allow camera access for this site."}},s={onBeforeSnapshot:function(){return Promise.resolve()},countdown:!1,locale:i,modes:["video-audio","video-only","audio-only","picture"],mirror:!0,facingMode:"user"};return r.opts=Jp({},s,o),r.translator=new G([i,r.uppy.locale,r.opts.locale]),r.i18n=r.translator.translate.bind(r.translator),r.i18nArray=r.translator.translateArray.bind(r.translator),r.install=r.install.bind(r),r.setPluginState=r.setPluginState.bind(r),r.render=r.render.bind(r),r.start=r.start.bind(r),r.stop=r.stop.bind(r),r.takeSnapshot=r.takeSnapshot.bind(r),r.startRecording=r.startRecording.bind(r),r.stopRecording=r.stopRecording.bind(r),r.oneTwoThreeSmile=r.oneTwoThreeSmile.bind(r),r.focus=r.focus.bind(r),r.webcamActive=!1,r.opts.countdown&&(r.opts.onBeforeSnapshot=r.oneTwoThreeSmile),r}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":Kp(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e.prototype.isSupported=function(){return!!this.mediaDevices},e.prototype.getConstraints=function(){return{audio:-1!==this.opts.modes.indexOf("video-audio")||-1!==this.opts.modes.indexOf("audio-only"),video:!(-1===this.opts.modes.indexOf("video-audio")&&-1===this.opts.modes.indexOf("video-only")&&-1===this.opts.modes.indexOf("picture"))&&{facingMode:this.opts.facingMode}}},e.prototype.start=function(){var t=this;if(!this.isSupported())return Promise.reject(new Error("Webcam access not supported"));this.webcamActive=!0;var e=this.getConstraints();return this.mediaDevices.getUserMedia(e).then(function(e){t.stream=e,t.setPluginState({cameraReady:!0})}).catch(function(e){t.setPluginState({cameraError:e})})},e.prototype.startRecording=function(){var t=this;this.recorder=new MediaRecorder(this.stream),this.recordingChunks=[],this.recorder.addEventListener("dataavailable",function(e){t.recordingChunks.push(e.data)}),this.recorder.start(),this.setPluginState({isRecording:!0})},e.prototype.stopRecording=function(){var t=this;return new Promise(function(e,n){t.recorder.addEventListener("stop",function(){e()}),t.recorder.stop()}).then(function(){return t.setPluginState({isRecording:!1}),t.getVideo()}).then(function(e){try{t.uppy.addFile(e)}catch(t){}}).then(function(){t.recordingChunks=null,t.recorder=null},function(e){throw t.recordingChunks=null,t.recorder=null,e})},e.prototype.stop=function(){this.stream.getAudioTracks().forEach(function(t){t.stop()}),this.stream.getVideoTracks().forEach(function(t){t.stop()}),this.webcamActive=!1,this.stream=null},e.prototype.getVideoElement=function(){return this.el.querySelector(".uppy-Webcam-video")},e.prototype.oneTwoThreeSmile=function(){var t=this;return new Promise(function(e,n){var o=t.opts.countdown,r=setInterval(function(){if(!t.webcamActive)return clearInterval(r),t.captureInProgress=!1,n(new Error("Webcam is not active"));o>0?(t.uppy.info(o+"...","warning",800),o--):(clearInterval(r),t.uppy.info(t.i18n("smile"),"success",1500),setTimeout(function(){return e()},1500))},1e3)})},e.prototype.takeSnapshot=function(){var t=this;this.captureInProgress||(this.captureInProgress=!0,this.opts.onBeforeSnapshot().catch(function(e){var n="object"===(void 0===e?"undefined":Yp(e))?e.message:e;return t.uppy.info(n,"error",5e3),Promise.reject(new Error("onBeforeSnapshot: "+n))}).then(function(){return t.getImage()}).then(function(e){t.captureInProgress=!1;try{t.uppy.addFile(e)}catch(t){}},function(e){throw t.captureInProgress=!1,e}))},e.prototype.getImage=function(){var t=this,e=this.getVideoElement();if(!e)return Promise.reject(new Error("No video element found, likely due to the Webcam tab being closed."));var n="webcam-"+Date.now()+".jpg",o=e.videoWidth,r=e.videoHeight,i=document.createElement("canvas");return i.width=o,i.height=r,i.getContext("2d").drawImage(e,0,0),function(t,e,n){return t.toBlob?new Promise(function(o){t.toBlob(o,e,n)}):Promise.resolve().then(function(){return An(t.toDataURL(e,n),{})})}(i,"image/jpeg").then(function(e){return{source:t.id,name:n,data:new Blob([e],{type:"image/jpeg"}),type:"image/jpeg"}})},e.prototype.getVideo=function(){var t=this.recordingChunks[0].type,e=function(t){return t=t.replace(/;.*$/,""),Mp[t]||null}(t);if(!e)return Promise.reject(new Error('Could not retrieve recording: Unsupported media type "'+t+'"'));var n="webcam-"+Date.now()+"."+e,o=new Blob(this.recordingChunks,{type:t}),r={source:this.id,name:n,data:new Blob([o],{type:t}),type:t};return Promise.resolve(r)},e.prototype.focus=function(){var t=this;this.opts.countdown||setTimeout(function(){t.uppy.info(t.i18n("smile"),"success",1500)},1e3)},e.prototype.render=function(t){this.webcamActive||this.start();var e=this.getPluginState();return e.cameraReady?Qp(Vp,Jp({},e,{onSnapshot:this.takeSnapshot,onStartRecording:this.startRecording,onStopRecording:this.stopRecording,onFocus:this.focus,onStop:this.stop,i18n:this.i18n,modes:this.opts.modes,supportsRecording:"function"==typeof MediaRecorder&&!!MediaRecorder.prototype&&"function"==typeof MediaRecorder.prototype.start,recording:e.isRecording,mirror:this.opts.mirror,src:this.stream})):Qp($p,{icon:Np,i18n:this.i18n})},e.prototype.install=function(){this.setPluginState({cameraReady:!1});var t=this.opts.target;t&&this.mount(t,this)},e.prototype.uninstall=function(){this.stream&&this.stop(),this.unmount()},e}(Z.Plugin),tc={};return tc.Core=Z,tc.server=m,tc.views={ProviderView:Fo},tc.DefaultStore=X,tc.ReduxStore=fs,tc.Dashboard=Xn,tc.DragDrop=Yn,tc.FileInput=Bo,tc.Informer=sn,tc.ProgressBar=Br,tc.StatusBar=Tn,tc.ReactUppy=cs,tc.Dropbox=Uo,tc.GoogleDrive=Fr,tc.Instagram=Ur,tc.Url=Ip,tc.Webcam=Zp,tc.AwsS3=Bt,tc.AwsS3Multipart=gt,tc.Transloadit=_p,tc.Tus=Sp,tc.XHRUpload=Et,tc.Form=Jo,tc.GoldenRetriever=br,tc.ReduxDevTools=ys,tc.ThumbnailGenerator=jn,tc});
//# sourceMappingURL=uppy.min.js.map